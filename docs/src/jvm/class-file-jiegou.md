---
title: è¯¦è§£Javaçš„ç±»æ–‡ä»¶ç»“æ„ï¼ˆ.classæ–‡ä»¶çš„ç»“æ„ï¼‰
shortTitle: Javaç±»æ–‡ä»¶ç»“æ„
category:
  - Javaæ ¸å¿ƒ
tag:
  - Javaè™šæ‹Ÿæœº
description: æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†Javaç±»æ–‡ä»¶ç»“æ„ï¼Œå­¦ä¹ æœ¬æ–‡å†…å®¹ï¼Œæ‚¨å°†æŒæ¡Javaç±»æ–‡ä»¶çš„åŸºæœ¬æ¦‚å¿µã€ç±»æ–‡ä»¶çš„ç»“æ„ã€ç±»æ–‡ä»¶çš„å†…å®¹ç»“æ„ã€ç±»æ–‡ä»¶çš„å¸¸é‡æ± ã€ç±»æ–‡ä»¶çš„è®¿é—®æ ‡è®°ã€ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•å’Œæ¥å£ç´¢å¼•ã€å­—æ®µè¡¨ã€æ–¹æ³•è¡¨ã€å±æ€§è¡¨ã€å±æ€§è¡¨çš„ç»“æ„ã€å±æ€§è¡¨çš„ç±»å‹ã€å±æ€§è¡¨çš„ä½¿ç”¨åœºæ™¯ã€å±æ€§è¡¨çš„ä½¿ç”¨æ–¹æ³•ã€å±æ€§è¡¨çš„ä½¿ç”¨ç¤ºä¾‹ã€å±æ€§è¡¨çš„ä½¿ç”¨æ³¨æ„äº‹é¡¹ï¼Œä¸ºæ‚¨çš„Javaç¼–ç¨‹ä¹‹æ—…æ‰“ä¸‹åšå®åŸºç¡€ã€‚
head:
  - - meta
    - name: keywords
      content: Java,JavaSE,æ•™ç¨‹,äºŒå“¥çš„Javaè¿›é˜¶ä¹‹è·¯,jvm,Javaè™šæ‹Ÿæœº,class
---

# ç¬¬å››èŠ‚ï¼šJavaç±»æ–‡ä»¶ç»“æ„

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯äºŒå“¥å‘€ï¼Œä»Šå¤©æˆ‘æ‹¿äº†ä¸€æŠŠå°åˆ€ï¼Œå‡†å¤‡å¸¦å¤§å®¶è§£å‰–ä¸€ä¸‹ Java çš„ç±»æ–‡ä»¶ç»“æ„ï¼Œä¹Ÿå°±æ˜¯ .class æ–‡ä»¶çš„å†…å®¹ç»“æ„ï¼Œè™½ç„¶å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸²è¿ç»­çš„äºŒè¿›åˆ¶ï¼Œç”± 0 å’Œ 1 ç»„æˆï¼Œä½†æˆ‘ä»¬ä»ç„¶å¯ä»¥å€ŸåŠ©ä¸€äº›å·¥å…·æ¥çœ‹æ¸…æ¥šå®ƒçš„çœŸé¢ç›®ã€‚

>ç±»æ–‡ä»¶ç»“æ„=.classæ–‡ä»¶çš„ç»“æ„=Classæ–‡ä»¶ç»“æ„ï¼Œè¿™ä¸‰ä¸ªè¯´æ³•éƒ½æ˜¯ä¸€ä¸ªæ„æ€ï¼Œ.classæ˜¯ä»æ–‡ä»¶åç¼€åçš„è§’åº¦æ¥è¯´çš„ï¼ŒClassæ˜¯ä»Javaç±»çš„è§’åº¦æ¥è¯´çš„ï¼Œç±»æ–‡ä»¶ç»“æ„å°±æ˜¯ Class çš„ä¸­æ–‡è¯‘åã€‚

---è¿™éƒ¨åˆ†å†…å®¹å‰é¢å…¶å®å·²ç»è®²è¿‡ï¼Œä½†ä¸ºäº†ä¿æŒè¿™ç¯‡å†…å®¹çš„å®Œæ•´æ€§ï¼Œå°±æš‚æ—¶ä¿ç•™äº†ä¸‹æ¥ï¼Œå·²ç»æŒæ¡çš„åŒå­¦å¯ä»¥ç•¥è¿‡ start----

è®¡ç®—æœºçš„ä¸–ç•Œé‡Œæµä¼ ç€è¿™ä¹ˆä¸€å¥è¯ï¼Œâ€œ**è®¡ç®—æœºç§‘å­¦é¢†åŸŸçš„ä»»ä½•é—®é¢˜éƒ½å¯ä»¥é€šè¿‡å¢åŠ ä¸€ä¸ªä¸­é—´å±‚æ¥è§£å†³**â€ã€‚å¯¹äº Java æ¥è¯´ï¼Œ[JVM](https://javabetter.cn/jvm/what-is-jvm.html) å°±æ˜¯è¿™ä¹ˆä¸€ä¸ªäº§ç‰©ï¼Œâ€œWrite once, Run anywhereâ€ä¹‹æ‰€ä»¥èƒ½å®ç°ï¼Œé å¾—å°±æ˜¯ JVMï¼Œå®ƒèƒ½åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸‹è¿è¡ŒåŒä¸€ä»½æºä»£ç ç¼–è¯‘åçš„ class æ–‡ä»¶ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-dfd7ce0d-1da2-4547-b2d7-57e0350f5911.png)

Java æ˜¯è·¨å¹³å°çš„ï¼ŒJVM ä½œä¸ºä¸­é—´å±‚ï¼Œè‡ªç„¶è¦é’ˆå¯¹ä¸åŒçš„æ“ä½œç³»ç»Ÿæä¾›ä¸åŒçš„å®ç°ã€‚æ‹¿ JDK 11 æ¥è¯´ï¼Œå®ƒçš„å®ç°å°±æœ‰ä¸Šå›¾ä¸­æåˆ°çš„è¿™ä¹ˆå¤šç§ï¼ˆç›®å‰æœ€æ–°ç‰ˆæœ¬å·²ç»æ˜¯ [JDK 21](https://www.oracle.com/java/technologies/downloads/) äº†ï¼‰ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-b1386f9e-c69b-44b0-a8d0-69ffbe9ed31f.png)

é€šè¿‡ä¸åŒæ“ä½œç³»ç»Ÿçš„ JVMï¼Œæˆ‘ä»¬çš„æºä»£ç å°±å¯ä»¥ä¸ç”¨æ ¹æ®ä¸åŒçš„æ“ä½œç³»ç»Ÿç¼–è¯‘æˆä¸åŒçš„äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶äº†ï¼Œè·¨å¹³å°çš„ç›®æ ‡ä¹Ÿå°±å®ç°äº†ã€‚

**é‚£è¿™ä¸ª class æ–‡ä»¶åˆ°åº•æ˜¯ä»€ä¹ˆç©æ„å‘¢ï¼Ÿå®ƒæ˜¯æ€ä¹ˆè¢« JVM è¯†åˆ«çš„å‘¢ï¼Ÿ**

æˆ‘ä»¬ç”¨ IDEA ç¼–å†™ä¸€æ®µ[ç®€å•çš„ Java ä»£ç ](https://javabetter.cn/overview/hello-world.html)ï¼Œæ–‡ä»¶åä¸º Hello.javaã€‚

```java
package com.itwanger.jvm;
class Hello {
    public static void main(String[] args) {
        System.out.println("Hello!");
    }
}
```

ç‚¹å‡»ç¼–è¯‘æŒ‰é’®åï¼ˆä¹Ÿä¸ç”¨ä¸»åŠ¨ç‚¹ï¼ŒIDEA ä¼šè‡ªåŠ¨ç¼–è¯‘ï¼‰ï¼ŒIDEA ä¼šå¸®æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªåä¸º Hello.class çš„æ–‡ä»¶ï¼Œåœ¨ `target/classes` çš„å¯¹åº”åŒ…ç›®å½•ä¸‹ã€‚ç›´æ¥åŒå‡»æ‰“å¼€åé•¿ä¸‹é¢è¿™æ ·å­ï¼š

```java
//
// Source code recreated from a .class file by IntelliJ IDEA
// (powered by Fernflower decompiler)
//

package com.itwanger.jvm;

class Hello {
    Hello() {
    }

    public static void main(String[] args) {
        System.out.println("Hello!");
    }
}
```

çœ‹èµ·æ¥å’Œæºä»£ç å¾ˆåƒï¼Œåªæ˜¯å¤šäº†ä¸€ä¸ªç©ºçš„[æ„é€ æ–¹æ³•](https://javabetter.cn/oo/construct.html)ï¼Œå¯¹å§ï¼Ÿå®ƒæ˜¯ class æ–‡ä»¶è¢« IDEA è‡ªå¸¦çš„åç¼–è¯‘å·¥å…· Fernflower åç¼–è¯‘åçš„æ ·å­ã€‚é‚£çœŸå®çš„ class æ–‡ä»¶é•¿ä»€ä¹ˆæ ·å­å‘¢ï¼Ÿ

å¯ä»¥åœ¨ç»ˆç«¯ä¸­é€šè¿‡ `xxd Hello.class` å‘½ä»¤æ¥æŸ¥çœ‹ï¼ˆå‰é¢æˆ‘ä»¬å·²ç»è®²è¿‡äº†ï¼Œå¤§å®¶å¯ä»¥æˆ³[è¿™ä¸ªé“¾æ¥](https://javabetter.cn/jvm/class-load.html)å›çœ‹ï¼‰ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-cb4afe63-6a8e-4ae1-a822-d4163c814daa.png)

è¿™å°±æ˜¯ class æ–‡ä»¶çš„åå…­è¿›åˆ¶å½¢å¼ã€‚

---è¿™éƒ¨åˆ†å†…å®¹å‰é¢å…¶å®å·²ç»è®²è¿‡ï¼Œä½†ä¸ºäº†ä¿æŒè¿™ç¯‡å†…å®¹çš„å®Œæ•´æ€§ï¼Œå°±æš‚æ—¶ä¿ç•™äº†ä¸‹æ¥ï¼Œå·²ç»æŒæ¡çš„åŒå­¦å¯ä»¥ç•¥è¿‡ end----

ç±»æ–‡ä»¶çš„å†…å®¹é€šå¸¸å¯ä»¥åˆ†ä¸ºä¸‹é¢è¿™å‡ éƒ¨åˆ†ï¼Œè§ä¸‹å›¾ã€‚

![](https://cdn.tobebetterjavaer.com/stutymore/class-file-jiegou-20231030194547.png)



## 01ã€é­”æ•°

å›çœ‹ class æ–‡ä»¶çš„åå…­è¿›åˆ¶å½¢å¼æˆªå›¾ã€‚

ç¬¬ä¸€è¡Œä¸­æœ‰ä¸€ä¸²ç‰¹æ®Šçš„å­—ç¬¦ `cafebabe`ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªé­”æ•°ï¼Œæ˜¯ JVM è¯†åˆ« class æ–‡ä»¶çš„æ ‡å¿—ï¼Œ[JVM ä¼šåœ¨éªŒè¯é˜¶æ®µ](https://javabetter.cn/jvm/class-load.html)æ£€æŸ¥ class æ–‡ä»¶æ˜¯å¦ä»¥è¯¥é­”æ•°å¼€å¤´ï¼Œå¦‚æœä¸æ˜¯åˆ™ä¼šæŠ›å‡º `ClassFormatError`ã€‚

é­”æ•° `cafebabe` çš„ä¸­æ–‡æ„æ€æ˜¾è€Œæ˜“è§ï¼Œå’–å•¡å®è´ï¼Œå†åŠ ä¸Š Java çš„å›¾æ ‡æœ¬æ¥å°±æ˜¯ä¸€ä¸ªçƒ­æ°”è…¾è…¾çš„å’–å•¡ï¼Œå¯è§ Java ä¸å’–å•¡çš„æ¸Šæºæœ‰å¤šæ·±ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/overview/two-02.png)

## 02ã€ç‰ˆæœ¬å·

ç´§è·Ÿç€é­”æ•°åé¢çš„å››ä¸ªå­—èŠ‚ `0000 0037` åˆ†åˆ«è¡¨ç¤ºå‰¯ç‰ˆæœ¬å·å’Œä¸»ç‰ˆæœ¬å·ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸»ç‰ˆæœ¬å·ä¸º 55ï¼ˆ0x37 çš„åè¿›åˆ¶ï¼‰ï¼Œä¹Ÿå°±æ˜¯ Java 11 å¯¹åº”çš„ç‰ˆæœ¬å·ï¼Œå‰¯ç‰ˆæœ¬å·ä¸º 0ã€‚

ä¸Šä¸€ä¸ª LTS ç‰ˆæœ¬æ˜¯ Java 8ï¼Œå¯¹åº”çš„ä¸»ç‰ˆæœ¬å·ä¸º 52ï¼Œä¹Ÿå°±æ˜¯è¯´ Java 9 æ˜¯ 53ï¼ŒJava 10 æ˜¯ 54ï¼Œåªä¸è¿‡ Java 9 å’Œ Java 10 éƒ½æ˜¯è¿‡æ¸¡ç‰ˆæœ¬ï¼Œä¸‹ä¸€ä¸ª LTS ç‰ˆæœ¬æ˜¯ Java 17ï¼Œé¢„è®¡ 2021 å¹´ 9 æœˆä»½æ¨å‡ºï¼ˆä»è¿™é‡Œå¤§å®¶å¯ä»¥æ¨æ–­å‡ºè¿™ç¯‡å†…å®¹çš„åˆç¨¿æ—¶é—´ï¼Œå“ˆå“ˆå“ˆï¼‰ã€‚ 

é‚£ç°åœ¨æ˜¯ 2023å¹´12æœˆ14æ—¥ï¼ŒJava 21 å·²ç»å‘å¸ƒäº†ã€‚é€šè¿‡ä¸Šé¢çš„æ–¹æ³•ï¼Œå¤§å®¶å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹ Java 21 å¯¹åº”çš„ç‰ˆæœ¬å·æ˜¯å¤šå°‘ï¼Œè¿™ä¸ªå°ä½œä¸šå°±ç•™ç»™å¤§å®¶äº†ï¼ŒåŠ¨åŠ¨æ‰‹ï¼Œä½ ä¼šå‘ç°ä¸ä¸€æ ·çš„ä¸–ç•Œã€‚

## 03ã€å¸¸é‡æ± 

ç´§è·Ÿåœ¨ç‰ˆæœ¬å·ä¹‹åçš„æ˜¯å¸¸é‡æ± ï¼Œå®ƒåŒ…å«äº†ç±»ã€æ¥å£ã€å­—æ®µå’Œæ–¹æ³•çš„ç¬¦å·å¼•ç”¨ï¼Œä»¥åŠå­—ç¬¦ä¸²å­—é¢é‡å’Œæ•°å€¼å¸¸é‡ã€‚è¿™äº›ä¿¡æ¯åœ¨ç¼–è¯‘æ—¶è¢«åˆ›å»ºï¼Œå¹¶åœ¨è¿è¡Œæ—¶è¢«Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰ä½¿ç”¨ã€‚

ç›¸å½“äºä¸€ä¸ªèµ„æºä»“åº“ï¼Œä¸»è¦å­˜æ”¾é‡å¤§ç±»å‹å¸¸é‡ï¼š

- å­—é¢é‡ï¼ˆLiteralsï¼‰ï¼šå­—é¢é‡æ˜¯ä¸å˜çš„æ•°æ®ï¼Œä¸»è¦åŒ…æ‹¬æ•°å€¼ï¼ˆå¦‚æ•´æ•°ã€æµ®ç‚¹æ•°ï¼‰å’Œå­—ç¬¦ä¸²å­—é¢é‡ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ•´æ•°100æˆ–ä¸€ä¸ªå­—ç¬¦ä¸²"Hello World"ï¼Œåœ¨æºä»£ç ä¸­ç›´æ¥èµ‹å€¼ï¼Œç¼–è¯‘åå­˜å‚¨åœ¨å¸¸é‡æ± ä¸­ã€‚
- ç¬¦å·å¼•ç”¨ï¼ˆSymbolic Referencesï¼‰ï¼šç¬¦å·å¼•ç”¨æ˜¯å¯¹ç±»ã€æ¥å£ã€å­—æ®µã€æ–¹æ³•ç­‰çš„å¼•ç”¨ï¼Œå®ƒä»¬ä¸æ˜¯ç”±å­—é¢é‡å€¼ç»™å‡ºçš„ï¼Œè€Œæ˜¯é€šè¿‡ç¬¦å·åç§°ï¼ˆå¦‚ç±»åã€æ–¹æ³•åï¼‰å’Œå…¶ä»–é¢å¤–ä¿¡æ¯ï¼ˆå¦‚ç±»å‹ã€ç­¾åï¼‰æ¥è¡¨ç¤ºã€‚è¿™äº›å¼•ç”¨åœ¨ç±»æ–‡ä»¶ä¸­ä»¥ä¸€ç§æŠ½è±¡çš„æ–¹å¼å­˜åœ¨ï¼Œå®ƒä»¬åœ¨ç±»åŠ è½½æ—¶è¢«è™šæ‹Ÿæœºè§£æä¸ºå…·ä½“çš„å†…å­˜åœ°å€ã€‚

ï¼ˆè¿™éƒ¨åˆ†å†…å®¹æˆ‘ä»¬å‰é¢è®²è¿‡ï¼Œ[æˆ³é“¾æ¥](https://javabetter.cn/jvm/class-load.html#_4-resolution-%E8%A7%A3%E6%9E%90)å›é¡¾ä¸€ä¸‹ï¼‰

å¥½ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡å®é™…çš„ä»£ç ç¤ºä¾‹æ¥çœ‹ä¸€ä¸‹å¸¸é‡æ± åˆ°åº•æ˜¯ä»€ä¹ˆã€‚

Java å®šä¹‰äº† booleanã€byteã€shortã€char å’Œ int ç­‰[åŸºæœ¬æ•°æ®ç±»å‹](https://javabetter.cn/basic-grammar/basic-data-type.html)ï¼Œå®ƒä»¬åœ¨å¸¸é‡æ± ä¸­éƒ½ä¼šè¢«å½“åš int æ¥å¤„ç†ã€‚æˆ‘ä»¬æ¥é€šè¿‡ä¸€æ®µç®€å•çš„ Java ä»£ç äº†è§£ä¸‹ã€‚

```java
public class ConstantTest {
    public final boolean bool = true;
    public final char aChar = 'a';
    public final byte b = 66;
    public final short s = 67;
    public final int i = 68;
}
```

å¸ƒå°”å€¼ true çš„åå…­è¿›åˆ¶æ˜¯ 0x01ã€å­—ç¬¦ a çš„åå…­è¿›åˆ¶æ˜¯ 0x61ï¼Œå­—èŠ‚ 66 çš„åå…­è¿›åˆ¶æ˜¯ 0x42ï¼ŒçŸ­æ•´å‹ 67 çš„åå…­è¿›åˆ¶æ˜¯ 0x43ï¼Œæ•´å‹ 68 çš„åå…­è¿›åˆ¶æ˜¯ 0x44ã€‚æ‰€ä»¥ç¼–è¯‘ç”Ÿæˆçš„æ•´å‹å¸¸é‡åœ¨ class æ–‡ä»¶ä¸­çš„ä½ç½®å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-bbe4c673-c3a5-4952-901d-35446f91a3af.png)

ç¬¬ä¸€ä¸ªå­—èŠ‚ 0x03 è¡¨ç¤ºå¸¸é‡çš„ç±»å‹ä¸º CONSTANT_Integer_infoï¼Œæ˜¯ JVM å®šä¹‰çš„ 14 ç§å¸¸é‡ç±»å‹ä¹‹ä¸€ï¼Œå¯¹åº”çš„è¿˜æœ‰ CONSTANT_Float_infoã€CONSTANT_Long_infoã€CONSTANT_Double_info ç­‰ï¼Œå®ƒä»¬å¯¹åº”çš„æ ‡è¯†åˆ†åˆ«æ˜¯ 0x04ã€0x05ã€0x06ã€‚

æˆ‘ç”¨è¡¨æ ¼æ¥ç®€å•è¡¨ç¤ºä¸‹ï¼š

| å¸¸é‡ç±»å‹ | æ ‡è¯†ç¬¦ | æè¿°ç¬¦ |
| :--- | :--- | :--- |
| CONSTANT_Integer_info | 0x03 | int ç±»å‹å­—é¢é‡ |
| CONSTANT_Float_info | 0x04 | float ç±»å‹å­—é¢é‡ |
| CONSTANT_Long_info | 0x05 | long ç±»å‹å­—é¢é‡ |
| CONSTANT_Double_info | 0x06 | double ç±»å‹å­—é¢é‡ |


å¯¹äº int å’Œ float æ¥è¯´ï¼Œå®ƒä»¬å  4 ä¸ªå­—èŠ‚ï¼›å¯¹äº long å’Œ double æ¥è¯´ï¼Œå®ƒä»¬å  8 ä¸ªå­—èŠ‚ã€‚æ¥ä¸ª long å‹çš„æœ€å¤§å€¼è§‚å¯Ÿä¸‹ã€‚

```java
public class ConstantTest {
    public final long ong = Long.MAX_VALUE;
}
```

æ¥çœ‹ä¸€ä¸‹å®ƒåœ¨ class æ–‡ä»¶ä¸­çš„ä½ç½®ã€‚05 å¼€å¤´ï¼Œ7f ff ff ff ff ff ff ff ç»“å°¾ï¼Œæœç„¶å  8 ä¸ªå­—èŠ‚ï¼Œä»¥å‰çŸ¥é“ long å‹ä¼šå  8 ä¸ªå­—èŠ‚ï¼Œä½†æ²¡æœ‰ç›´è§‚çš„æ„Ÿå—ï¼Œç°åœ¨æœ‰äº†ï¼ˆğŸ˜ï¼‰ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-2c876f52-1cc1-4076-807a-d85a1cb80e75.png)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€æ®µä»£ç ã€‚

```java
class Hello {
    public final String s = "hello";
}
```

â€œhelloâ€æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒçš„åå…­è¿›åˆ¶ä¸º `68 65 6c 6c 6f`ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å®ƒåœ¨ class æ–‡ä»¶ä¸­çš„ä½ç½®ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-801ed589-658c-407e-ac64-81fd525d7324.png)

å‰é¢è¿˜æœ‰ 3 ä¸ªå­—èŠ‚ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚ 0x01 æ˜¯æ ‡è¯†ï¼Œæ ‡è¯†ç±»å‹ä¸º CONSTANT_Uft8_infoï¼Œç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ª 0x00 0x05 ç”¨æ¥è¡¨ç¤ºç¬¬ä¸‰éƒ¨åˆ†å­—èŠ‚æ•°ç»„çš„é•¿åº¦ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-ae4f38c9-68fe-40ad-91c6-3e7fd360de05.png)

ä¸ CONSTANT_Uft8_info ç±»å‹å¯¹åº”çš„ï¼Œè¿˜æœ‰ä¸€ä¸ª CONSTANT_String_infoï¼Œç”¨æ¥è¡¨ç¤ºå­—ç¬¦ä¸²å¯¹è±¡çš„å¼•ç”¨ï¼ˆä¹‹å‰ä»£ç ä¸­çš„ sï¼‰ï¼Œæ ‡è¯†æ˜¯ 0x08ã€‚å‰è€…å­˜å‚¨äº†å­—ç¬¦ä¸²çœŸæ­£çš„å€¼ï¼Œåè€…å¹¶ä¸åŒ…å«å­—ç¬¦ä¸²çš„å†…å®¹ï¼Œä»…ä»…åŒ…å«äº†ä¸€ä¸ªæŒ‡å‘å¸¸é‡æ± ä¸­ CONSTANT_Uft8_info çš„ç´¢å¼•ã€‚

è¿™å’Œæˆ‘ä»¬å‰é¢è®²çš„å¯¹è±¡å’Œå¼•ç”¨å°±å…³è”èµ·æ¥äº†ï¼Œæœ‰æ²¡æœ‰ï¼Ÿï¼ˆğŸ˜ï¼‰

- [Javaåˆ°åº•æ˜¯å€¼ä¼ é€’è¿˜æ˜¯å¼•ç”¨ä¼ é€’ï¼Ÿ](https://javabetter.cn/basic-extra-meal/pass-by-value.html)

æ¥çœ‹ä¸€ä¸‹å®ƒåœ¨ class æ–‡ä»¶ä¸­çš„ä½ç½®ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-4e093bef-d592-4be7-847e-0ef5900c5fa4.png)

CONSTANT_String_info é€šè¿‡ç´¢å¼• 19 æ¥æ‰¾åˆ° CONSTANT_Uft8_infoï¼Œè§ä¸‹å›¾ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-85af064d-5dc6-4187-b4f3-3501ccfc99b3.png)

é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ CONSTANT_Class_infoï¼Œç”¨æ¥è¡¨ç¤ºç±»å’Œæ¥å£ï¼Œå’Œ CONSTANT_String_info ç±»ä¼¼ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯æ ‡è¯†ï¼Œå€¼ä¸º 0x07ï¼Œåé¢ä¸¤ä¸ªå­—èŠ‚æ˜¯å¸¸é‡æ± ç´¢å¼•ï¼ŒæŒ‡å‘ CONSTANT_Utf8_infoâ€”â€”å­—ç¬¦ä¸²å­˜å‚¨çš„æ˜¯ç±»æˆ–è€…æ¥å£çš„å…¨è·¯å¾„é™å®šåã€‚

æ‹¿ Hello.java ç±»æ¥è¯´ï¼Œå®ƒçš„å…¨è·¯å¾„é™å®šåä¸º `com/itwanger/jvm/Hello`ï¼Œå¯¹åº”çš„åå…­è¿›åˆ¶ä¸ºâ€œ636f6d2f697477616e6765722f6a766d2f48656c6c6fâ€ï¼Œæ˜¯ä¸€ä¸² CONSTANT_Uft8_infoï¼ŒæŒ‡å‘å®ƒçš„ CONSTANT_Class_info åœ¨ class æ–‡ä»¶ä¸­çš„ä»€ä¹ˆä½ç½®å‘¢ï¼Ÿ

å…ˆä¸ç€æ€¥ï¼Œè¿™é‡Œç»™å¤§å®¶ä»‹ç»ä¸€æ¬¾å¯è§†åŒ–å­—èŠ‚ç çš„å·¥å…· [jclasslib bytecode viewer](https://javabetter.cn/jvm/how-run-java-code.html)ï¼ˆå‰é¢ä¹Ÿæ›¾è®²è¿‡ï¼‰ï¼Œå¯ä»¥ç›´æ¥åœ¨ IDEA çš„æ’ä»¶å¸‚åœºå®‰è£…ã€‚å®‰è£…å®Œæˆåï¼Œé€‰ä¸­ class æ–‡ä»¶ï¼Œç„¶ååœ¨ View èœå•é‡Œæ‰¾åˆ° Show Bytecode With Jclasslib å­èœå•ï¼Œå°±å¯ä»¥æŸ¥çœ‹ class æ–‡ä»¶çš„å…³é”®ä¿¡æ¯äº†ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-ac6cc8cf-ed25-4bbb-8685-d473ecf15a60.png)

ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå¸¸é‡æ± çš„æ€»å¤§å°ä¸º 23ï¼Œç´¢å¼•ä¸º 04 çš„ CONSTANT_Class_info æŒ‡å‘çš„æ˜¯æ˜¯ç´¢å¼•ä¸º 21 çš„ CONSTANT_Uft8_infoï¼Œå€¼ä¸º `com/itwanger/jvm/Hello`ã€‚21 çš„åå…­è¿›åˆ¶ä¸º 0x15ï¼Œæœ‰äº†è¿™ä¸ªä¿¡æ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰¾åˆ° CONSTANT_Class_info åœ¨ class æ–‡ä»¶ä¸­çš„ä½ç½®äº†ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-74816960-b8f7-42f3-9001-c05ebd25f58d.png)

0x07 æ˜¯ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ŒCONSTANT_Class_info çš„æ ‡è¯†ç¬¦ï¼Œç„¶åæ˜¯ä¸¤ä¸ªå­—èŠ‚ï¼Œæ ‡è¯†ç´¢å¼•ã€‚

è¿˜æœ‰ CONSTANT_NameAndType_infoï¼Œç”¨æ¥æ ‡è¯†å­—æ®µæˆ–æ–¹æ³•ï¼Œæ ‡è¯†ç¬¦ä¸º 12ï¼Œå¯¹åº”çš„åå…­è¿›åˆ¶æ˜¯ 0x0cã€‚åé¢è¿˜æœ‰ 4 ä¸ªå­—èŠ‚ï¼Œå‰ä¸¤ä¸ªæ˜¯å­—æ®µæˆ–è€…æ–¹æ³•çš„ç´¢å¼•ï¼Œåä¸¤ä¸ªæ˜¯å­—æ®µæˆ–æ–¹æ³•çš„æè¿°ç¬¦ï¼Œä¹Ÿå°±æ˜¯å­—æ®µæˆ–è€…æ–¹æ³•çš„ç±»å‹ã€‚

æ¥çœ‹ä¸‹é¢è¿™æ®µä»£ç ã€‚

```java
class Hello {
    public void testMethod(int id, String name) {
    }
}
```

ç”¨ jclasslib å¯ä»¥çœ‹åˆ° CONSTANT_NameAndType_info åŒ…å«çš„ç´¢å¼•æœ‰ä¸¤ä¸ªã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-70cd8902-136c-42a4-ab57-d6baf202e462.png)

ä¸€ä¸ªæ˜¯ 4ï¼Œä¸€ä¸ªæ˜¯ 5ï¼Œå¯ä»¥é€šè¿‡ä¸‹å›¾æ¥è¡¨ç¤º CONSTANT_NameAndType_info çš„æ„æˆã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-5ac7d4c4-b905-462c-90f7-58b46fc5dda1.png)

å¯¹åº” class æ–‡ä»¶ä¸­çš„ä½ç½®å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-eba9e047-d6fb-43e7-8c27-3683a076ccdd.png)

æ¥ä¸‹æ¥æ˜¯ CONSTANT_Fieldref_info ã€CONSTANT_Methodref_info å’Œ CONSTANT_InterfaceMethodref_infoï¼Œå®ƒä»¬ä¸‰ä¸ªçš„ç»“æ„æ¯”è¾ƒç±»ä¼¼ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„ä¼ªä»£ç æ¥è¡¨ç¤ºã€‚

```
CONSTANT_*ref_info {
  u1 tag;
  u2 class_index;
  u2 name_and_type_index;
}
```

å­¦è¿‡ [C è¯­è¨€](https://javabetter.cn/xuexiluxian/c.html)çš„ç¬¦å·è¡¨ï¼ˆSymbol Tableï¼‰çš„è¯ï¼Œå¯¹è¿™æ®µä¼ªä»£ç å¹¶ä¸ä¼šé™Œç”Ÿã€‚

- tag ä¸ºæ ‡è¯†ç¬¦ï¼ŒFieldref çš„ä¸º 9ï¼Œä¹Ÿå°±æ˜¯åå…­è¿›åˆ¶çš„ 0x09ï¼›Methodref çš„ä¸º 10ï¼Œä¹Ÿå°±æ˜¯åå…­è¿›åˆ¶çš„ 0x0aï¼›InterfaceMethodref çš„ä¸º 11ï¼Œ ä¹Ÿå°±æ˜¯åå…­è¿›åˆ¶çš„ 0x0bã€‚
- class_index ä¸º CONSTANT_Class_info çš„å¸¸é‡æ± ç´¢å¼•ï¼Œè¡¨ç¤ºå­—æ®µ | æ–¹æ³• | æ¥å£æ–¹æ³•æ‰€åœ¨çš„ç±»ä¿¡æ¯ã€‚
- name_and_type_index ä¸º CONSTANT_NameAndType_info çš„å¸¸é‡æ± ç´¢å¼•ï¼Œæ‹¿ Fieldref æ¥è¯´ï¼Œè¡¨ç¤ºå­—æ®µåå’Œå­—æ®µç±»å‹ï¼›æ‹¿ Methodref æ¥è¯´ï¼Œè¡¨ç¤ºæ–¹æ³•åã€æ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹ï¼›æ‹¿ InterfaceMethodref æ¥è¯´ï¼Œè¡¨ç¤ºæ¥å£æ–¹æ³•åã€æ¥å£æ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹ã€‚

è¿˜æœ‰ CONSTANT_MethodHandle_info ã€CONSTANT_MethodType_info å’Œ CONSTANT_InvokeDynamic_infoï¼Œæˆ‘è¿™é‡Œç”¨ä¸€ä¸ªè¡¨æ ¼æ¥è¡¨ç¤ºä¸‹ï¼š

| å¸¸é‡ç±»å‹ | æ ‡è¯†ç¬¦ | æè¿°ç¬¦ |
| :--- | :--- | :--- |
| CONSTANT_MethodHandle_info | 0x0f | æ–¹æ³•å¥æŸ„ |
| CONSTANT_MethodType_info | 0x10 | æ–¹æ³•ç±»å‹ |
| CONSTANT_InvokeDynamic_info | 0x12 | åŠ¨æ€è°ƒç”¨ç‚¹ |
| CONSTANT_Fieldref_info | 0x09 | å­—æ®µ |
| CONSTANT_Methodref_info | 0x0a | æ™®é€šæ–¹æ³• |
| CONSTANT_InterfaceMethodref_info | 0x0b | æ¥å£æ–¹æ³• |
| CONSTANT_Class_info | 0x07 | ç±»æˆ–æ¥å£çš„å…¨é™å®šå |
| CONSTANT_String_info | 0x08 | å­—ç¬¦ä¸²å­—é¢é‡ |
| CONSTANT_Uft8_info | 0x01 | å­—ç¬¦ä¸² |

å•Šï¼Œclass æ–‡ä»¶ä¸­æœ€å¤æ‚çš„å¸¸é‡æ± éƒ¨åˆ†å°±ç®—æ˜¯è§£å‰–å®Œäº†ï¼ŒçœŸä¸å®¹æ˜“ï¼

## 04ã€è®¿é—®æ ‡è®°

ç´§è·Ÿç€å¸¸é‡æ± ä¹‹åçš„åŒºåŸŸå°±æ˜¯è®¿é—®æ ‡è®°ï¼ˆAccess flagsï¼‰ï¼Œè¿™ä¸ªæ ‡è®°ç”¨äºè¯†åˆ«ç±»æˆ–æ¥å£çš„è®¿é—®ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´ï¼š

- åˆ°åº•æ˜¯ [class ç±»](https://javabetter.cn/oo/object-class.html) è¿˜æ˜¯ [interface æ¥å£](https://javabetter.cn/oo/interface.html)ï¼Ÿ
- æ˜¯ [public](https://javabetter.cn/oo/access-control.html) å—ï¼Ÿ
- æ˜¯ [abstract æŠ½è±¡ç±»](https://javabetter.cn/oo/abstract.html)å—ï¼Ÿ
- æ˜¯ [final ç±»](https://javabetter.cn/oo/final.html)å—ï¼Ÿ
- ç­‰ç­‰ã€‚
  
æ€»å…±æœ‰ 16 ä¸ªæ ‡è®°ä½å¯ä¾›ä½¿ç”¨ï¼Œä½†å¸¸ç”¨çš„åªæœ‰å…¶ä¸­ 7 ä¸ªï¼Œè§ä¸‹å›¾ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-1f5d3154-9a28-4cfa-935e-43d7e023036e.png)

è¿™é‡Œç”¨ä¸€ä¸ªè¡¨æ ¼æ¥è¡¨ç¤ºä¸‹ã€‚

| æ ‡è®°ä½ | æ ‡è¯†ç¬¦ | æè¿° |
| :--- | :--- | :--- |
| 0x0001 | ACC_PUBLIC | public ç±»å‹ |
| 0x0010 | ACC_FINAL | final ç±»å‹ |
| 0x0020 | ACC_SUPER | è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œä½¿ç”¨ invokespecial æŒ‡ä»¤ |
| 0x0200 | ACC_INTERFACE | æ¥å£ç±»å‹ |
| 0x0400 | ACC_ABSTRACT | æŠ½è±¡ç±»ç±»å‹ |
| 0x1000 | ACC_SYNTHETIC | æ ‡è®°ä¸ºç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„ç±» |
| 0x2000 | ACC_ANNOTATION | æ ‡è®°ä¸ºæ³¨è§£ç±» |
| 0x4000 | ACC_ENUM | æ ‡è®°ä¸ºæšä¸¾ç±» |
| 0x8000 | ACC_MODULE | æ ‡è®°ä¸ºæ¨¡å—ç±» |

æ¥çœ‹ä¸€ä¸ªç®€å•çš„æšä¸¾ä»£ç ã€‚

```java
public enum Color {
    RED,GREEN,BLUE;
}
```

é€šè¿‡ jclasslib å¯ä»¥çœ‹åˆ°è®¿é—®æ ‡è®°çš„ä¿¡æ¯æœ‰ `0x4031 [public final enum]`ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-d4873db5-1a9d-4e05-9765-59a71b083fe5.png)

å¯¹åº” class æ–‡ä»¶ä¸­çš„ä½ç½®å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-774e8289-582b-4762-9dce-b0590ee5ad3f.png)

## 05ã€ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•å’Œæ¥å£ç´¢å¼•

è¿™ä¸‰éƒ¨åˆ†ç”¨æ¥ç¡®å®šç±»çš„ç»§æ‰¿å…³ç³»ï¼Œthis_class ä¸ºå½“å‰ç±»çš„ç´¢å¼•ï¼Œsuper_class ä¸ºçˆ¶ç±»çš„ç´¢å¼•ï¼Œinterfaces ä¸ºæ¥å£ã€‚

æ¥çœ‹ä¸‹é¢è¿™æ®µç®€å•çš„ä»£ç ï¼Œæ²¡æœ‰æ¥å£ï¼Œé»˜è®¤ç»§æ‰¿ Object ç±»ã€‚

```java
class Hello {
    public static void main(String[] args) {
        
    }
}
```

é€šè¿‡ jclasslib å¯ä»¥çœ‹åˆ°ç±»çš„ç»§æ‰¿å…³ç³»ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-77c4ecff-6d36-405d-93da-ee06431bf312.png)

- this_class æŒ‡å‘å¸¸é‡æ± ä¸­ç´¢å¼•ä¸º 2 çš„ CONSTANT_Class_infoã€‚
- super_class æŒ‡å‘å¸¸é‡æ± ä¸­ç´¢å¼•ä¸º 3 çš„ CONSTANT_Class_infoã€‚
- ç”±äºæ²¡æœ‰æ¥å£ï¼Œæ‰€ä»¥ interfaces çš„ä¿¡æ¯ä¸ºç©ºã€‚

å¯¹åº” class æ–‡ä»¶ä¸­çš„ä½ç½®å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-6d5d9189-12a2-45d3-b811-92deede2f78d.png)

## 06ã€å­—æ®µè¡¨

ä¸€ä¸ªç±»ä¸­å®šä¹‰çš„å­—æ®µä¼šè¢«å­˜å‚¨åœ¨å­—æ®µè¡¨ï¼ˆfieldsï¼‰ä¸­ï¼ŒåŒ…æ‹¬[é™æ€çš„å’Œéé™æ€çš„](https://javabetter.cn/oo/static.html)ã€‚

æ¥çœ‹è¿™æ ·ä¸€æ®µä»£ç ã€‚

```java
public class FieldsTest {
    private String name;
}
```

å­—æ®µåªæœ‰ä¸€ä¸ªï¼Œä¿®é¥°ç¬¦ä¸º privateï¼Œç±»å‹ä¸º Stringï¼Œå­—æ®µåä¸º nameã€‚å¯ä»¥ç”¨ä¸‹é¢çš„ä¼ªä»£ç æ¥è¡¨ç¤º field çš„ç»“æ„ã€‚

```
field_info {
  u2 access_flag;
  u2 name_index;
  u2 description_index;
}
```

- access_flag ä¸ºå­—æ®µçš„è®¿é—®æ ‡è®°ï¼Œæ¯”å¦‚è¯´æ˜¯ä¸æ˜¯ public | private | protectedï¼Œæ˜¯ä¸æ˜¯ staticï¼Œæ˜¯ä¸æ˜¯ final ç­‰ã€‚
- name_index ä¸ºå­—æ®µåçš„ç´¢å¼•ï¼ŒæŒ‡å‘å¸¸é‡æ± ä¸­çš„ CONSTANT_Utf8_infoï¼Œ æ¯”å¦‚è¯´ä¸Šä¾‹ä¸­çš„å€¼å°±ä¸º nameã€‚
- description_index ä¸ºå­—æ®µçš„æè¿°ç±»å‹ç´¢å¼•ï¼Œä¹ŸæŒ‡å‘å¸¸é‡æ± ä¸­çš„ CONSTANT_Utf8_infoï¼Œé’ˆå¯¹ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œä¼šæœ‰ä¸åŒè§„åˆ™çš„æè¿°ä¿¡æ¯ã€‚

1ï¼‰å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹æ¥è¯´ï¼Œä½¿ç”¨ä¸€ä¸ªå­—ç¬¦æ¥è¡¨ç¤ºï¼Œæ¯”å¦‚è¯´ I å¯¹åº”çš„æ˜¯ intï¼ŒB å¯¹åº”çš„æ˜¯ byteã€‚

2ï¼‰å¯¹äºå¼•ç”¨æ•°æ®ç±»å‹æ¥è¯´ï¼Œä½¿ç”¨ `L***;` çš„æ–¹å¼æ¥è¡¨ç¤ºï¼Œ`L` å¼€å¤´ï¼Œ`;` ç»“æŸï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ç±»å‹ä¸º `Ljava/lang/String;`ã€‚

3ï¼‰å¯¹äºæ•°ç»„æ¥è¯´ï¼Œä¼šç”¨ä¸€ä¸ªå‰ç½®çš„ `[` æ¥è¡¨ç¤ºï¼Œæ¯”å¦‚è¯´å­—ç¬¦ä¸²æ•°ç»„ä¸º `[Ljava/lang/String;`ã€‚

å¯¹åº”åˆ° class æ–‡ä»¶ä¸­çš„ä½ç½®å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-5a40ed62-4ff2-4101-b2d5-15760032f563.png)

çœ‹åˆ°è¿™é‡Œç›¸ä¿¡ä½ å°±èƒ½æ˜ç™½ç»å¸¸åœ¨ javap å‘½ä»¤ä¸­çœ‹åˆ°çš„ä¸€äº›å¥‡æ€ªçš„å­—ç¬¦çš„æ„æ€äº†ã€‚

## 07ã€æ–¹æ³•è¡¨

æ–¹æ³•è¡¨å’Œå­—æ®µè¡¨ç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯ç”¨æ¥å­˜å‚¨æ–¹æ³•çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–¹æ³•åï¼Œæ–¹æ³•çš„å‚æ•°ï¼Œæ–¹æ³•çš„ç­¾åã€‚ 

å°±æ‹¿ main æ–¹æ³•æ¥è¯´å§ã€‚

```java
public class MethodsTest {
    public static void main(String[] args) {
        
    }
}
```

å…ˆç”¨ jclasslib çœ‹ä¸€ä¸‹å¤§æ¦‚çš„ä¿¡æ¯ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-cbe6d025-84a5-4fea-821b-a4234f47c6cd.png)

- è®¿é—®æ ‡è®°æ˜¯ public static çš„ã€‚
- æ–¹æ³•åä¸º mainã€‚
- æ–¹æ³•çš„å‚æ•°ä¸ºå­—ç¬¦ä¸²æ•°ç»„ï¼›è¿”å›ç±»å‹ä¸º Voidã€‚

å¯¹åº”åˆ° class æ–‡ä»¶ä¸­çš„ä½ç½®å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-f3932093-46f3-4ef0-8598-bbd70515a9bd.png)

## 08ã€å±æ€§è¡¨

å±æ€§è¡¨æ˜¯ class æ–‡ä»¶ä¸­çš„æœ€åä¸€éƒ¨åˆ†ï¼Œé€šå¸¸å‡ºç°åœ¨å­—æ®µå’Œæ–¹æ³•ä¸­ã€‚

æ¥çœ‹è¿™æ ·ä¸€æ®µä»£ç ã€‚

```java
public class AttributeTest {
    public static final int DEFAULT_SIZE = 128;
}
```

åªæœ‰ä¸€ä¸ªå¸¸é‡ DEFAULT_SIZEï¼Œå®ƒå±äºå­—æ®µä¸­çš„ä¸€ç§ï¼Œå°±æ˜¯åŠ äº† [final çš„é™æ€å˜é‡](https://javabetter.cn/oo/final.html)ã€‚å…ˆé€šè¿‡ jclasslib çœ‹ä¸€ä¸‹å®ƒå½“ä¸­ä¸€ä¸ªå¾ˆé‡è¦çš„å±æ€§â€”â€”ConstantValueï¼Œç”¨æ¥è¡¨ç¤ºé™æ€å˜é‡çš„åˆå§‹å€¼ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-dee995d6-e285-4a31-b11f-e93c3599cd8e.png)


- Attribute name index æŒ‡å‘å¸¸é‡æ± ä¸­å€¼ä¸ºâ€œConstantValueâ€çš„å¸¸é‡ã€‚
- Attribute length çš„å€¼ä¸ºå›ºå®šçš„ 2ï¼Œå› ä¸ºç´¢å¼•åªå ä¸¤ä¸ªå­—èŠ‚çš„å¤§å°ã€‚
- Constant value index æŒ‡å‘å¸¸é‡æ± ä¸­å…·ä½“çš„å¸¸é‡ï¼Œå¦‚æœå¸¸é‡ç±»å‹ä¸º intï¼ŒæŒ‡å‘çš„å°±æ˜¯ CONSTANT_Integer_infoã€‚

æˆ‘ç”»äº†ä¸€å‰¯å›¾ï¼Œå¯ä»¥å®Œæ•´çš„è¡¨ç¤ºå­—æ®µçš„ç»“æ„ï¼ŒåŒ…å«å±æ€§è¡¨åœ¨å†…ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-53f73e24-f060-45d2-8e29-34263c31847b.png)

å¯¹åº”åˆ° class æ–‡ä»¶ä¸­çš„ä½ç½®å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-423341a7-3aeb-4ac9-95e8-a1e7f7847255.png)

æ¥çœ‹ä¸‹é¢è¿™æ®µä»£ç ã€‚

```java
public class MethodCode {
    public static void main(String[] args) {
        foo();
    }

    private static void foo() {
    }
}
```

main æ–¹æ³•ä¸­è°ƒç”¨äº† foo æ–¹æ³•ã€‚é€šè¿‡ jclasslib çœ‹ä¸€ä¸‹å®ƒå½“ä¸­ä¸€ä¸ªå¾ˆé‡è¦çš„å±æ€§â€”â€”Codeï¼Œ æ–¹æ³•çš„å…³é”®ä¿¡æ¯éƒ½å­˜å‚¨åœ¨é‡Œé¢ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-e76339a8-0aab-418b-9722-4b3c8591693c.png)


- Attribute name index æŒ‡å‘å¸¸é‡æ± ä¸­å€¼ä¸ºâ€œCodeâ€çš„å¸¸é‡ã€‚
- Attribute length ä¸ºå±æ€§å€¼çš„é•¿åº¦å¤§å°ã€‚
- bytecode å­˜å‚¨çœŸæ­£çš„å­—èŠ‚ç æŒ‡ä»¤ã€‚
- exception table è¡¨ç¤ºæ–¹æ³•å†…éƒ¨çš„å¼‚å¸¸ä¿¡æ¯ã€‚
- maximum stack size è¡¨ç¤ºæ“ä½œæ•°æ ˆçš„æœ€å¤§æ·±åº¦ï¼Œæ–¹æ³•æ‰§è¡Œçš„ä»»æ„æœŸé—´æ“ä½œæ•°æ ˆæ·±åº¦éƒ½ä¸ä¼šè¶…è¿‡è¿™ä¸ªå€¼ã€‚
- maximum local variable è¡¨ç¤ºä¸´æ—¶å˜é‡è¡¨çš„å¤§å°ï¼Œæ³¨æ„ï¼Œå¹¶ä¸ç­‰äºæ–¹æ³•ä¸­æ‰€æœ‰ä¸´æ—¶å˜é‡çš„æ•°é‡ä¹‹å’Œï¼Œå½“ä¸€ä¸ªä½œç”¨åŸŸç»“æŸï¼Œå†…éƒ¨çš„ä¸´æ—¶å˜é‡å ç”¨çš„ä½ç½®å°±ä¼šè¢«æ›¿æ¢æ‰ã€‚
- code length è¡¨ç¤ºå­—èŠ‚ç æŒ‡ä»¤çš„é•¿åº¦ã€‚

å¯¹åº” class æ–‡ä»¶ä¸­çš„ä½ç½®å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/jvm/class-file-jiegou-b5853549-b17b-48eb-8eb3-a393fb5d655f.png)

## 09ã€QA

è¯„è®ºåŒºæœ‰è¯»è€…é—®åˆ°ï¼šâ€œæ€ä¹ˆé€šè¿‡ç´¢å¼•å€¼ï¼Œå®šä½åˆ°åœ¨class æ–‡ä»¶ä¸­çš„ä½ç½®ï¼Œè¿™ä¸ªæ˜¯å’‹ç®—çš„ï¼Ÿâ€

åœ¨Javaç±»æ–‡ä»¶ä¸­ï¼Œå¸¸é‡æ± æ˜¯ä¸€ä¸ªç´¢å¼•è¡¨ï¼Œå®ƒä»ç´¢å¼•å€¼1å¼€å§‹è®¡æ•°ï¼Œæ¯ä¸ªæ¡ç›®éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ç´¢å¼•ã€‚

- å¸¸é‡æ± è®¡æ•°å™¨ï¼šåœ¨å¸¸é‡æ± ä¹‹å‰ï¼Œç±»æ–‡ä»¶æœ‰ä¸€ä¸ª16ä½çš„å¸¸é‡æ± è®¡æ•°å™¨ï¼Œè¡¨ç¤ºå¸¸é‡æ± ä¸­æœ‰å¤šå°‘é¡¹ã€‚å®ƒçš„å€¼æ¯”å®é™…å¸¸é‡æ•°å¤§1ï¼ˆå› ä¸ºç´¢å¼•ä»1å¼€å§‹ï¼‰ã€‚
- å¸¸é‡æ± æ¡ç›®ï¼šæ¯ä¸ªå¸¸é‡æ± æ¡ç›®çš„å¼€å§‹æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼ˆ1ä¸ªå­—èŠ‚ï¼‰ï¼Œè¡¨æ˜äº†å¸¸é‡çš„ç±»å‹ï¼ˆå¦‚Classã€Fieldrefã€Methodrefç­‰ï¼‰ã€‚æ ¹æ®è¿™ä¸ªç±»å‹ï¼Œåé¢è·Ÿç€çš„æ•°æ®ç»“æ„ä¹Ÿä¸åŒã€‚

å®šä½è¿‡ç¨‹å¤§è‡´å¦‚ä¸‹ï¼š

- è¯»å–å¸¸é‡æ± è®¡æ•°å™¨ï¼šé¦–å…ˆï¼Œä»ç±»æ–‡ä»¶çš„å¼€å¤´è¯»å–å¸¸é‡æ± è®¡æ•°å™¨çš„å€¼ï¼Œç¡®å®šå¸¸é‡æ± ä¸­æœ‰å¤šå°‘æ¡ç›®ã€‚
- éå†å¸¸é‡æ± ï¼šä»å¸¸é‡æ± çš„ç¬¬ä¸€é¡¹å¼€å§‹éå†ã€‚ç”±äºä¸åŒç±»å‹çš„å¸¸é‡é•¿åº¦ä¸åŒï¼Œéœ€è¦æ ¹æ®æ¯ä¸ªå¸¸é‡çš„ç±»å‹æ¥ç¡®å®šå®ƒçš„é•¿åº¦ã€‚
- æ ¹æ®ç´¢å¼•å®šä½ï¼šç»§ç»­éå†ï¼Œç›´åˆ°åˆ°è¾¾æ‰€éœ€çš„ç´¢å¼•å€¼ã€‚æ¯æ¬¡éå†æ—¶ï¼Œæ ¹æ®æ¡ç›®ç±»å‹è¯»å–ç›¸åº”é•¿åº¦çš„æ•°æ®ï¼Œç›´åˆ°è¾¾åˆ°ç›®æ ‡ç´¢å¼•ã€‚

å¯ä»¥æŠ½è±¡æˆä¸€ä¸ªæ•°ç»„å’Œä¸€ä¸ª for å¾ªç¯ï¼Œå°±èƒ½æ˜ç™½äº†ã€‚

```java
int[] constantPool = new int[constantPoolCount];
for (int i = 1; i < constantPoolCount; i++) {
    int tag = constantPool[i];
    switch (tag) {
        case CONSTANT_Integer_info:
            i += 4;
            break;
        case CONSTANT_Float_info:
            i += 4;
            break;
        case CONSTANT_Long_info:
            i += 8;
            break;
        case CONSTANT_Double_info:
            i += 8;
            break;
        case CONSTANT_Utf8_info:
            int length = constantPool[i + 1];
            i += length + 1;
            break;
        case CONSTANT_String_info:
            i += 2;
            break;
        case CONSTANT_Class_info:
            i += 2;
            break;
        case CONSTANT_Fieldref_info:
            i += 4;
            break;
        case CONSTANT_Methodref_info:
            i += 4;
            break;
        case CONSTANT_InterfaceMethodref_info:
            i += 4;
            break;
        case CONSTANT_NameAndType_info:
            i += 4;
            break;
        case CONSTANT_MethodHandle_info:
            i += 3;
            break;
        case CONSTANT_MethodType_info:
            i += 2;
            break;
        case CONSTANT_InvokeDynamic_info:
            i += 4;
            break;
        default:
            throw new RuntimeException("Unknown tag: " + tag);
    }
}
```

## 10ã€å°ç»“

åˆ°æ­¤ä¸ºæ­¢ï¼Œclass æ–‡ä»¶çš„å†…éƒ¨ç®—æ˜¯å‰–æå¾—å·®ä¸å¤šäº†ï¼Œå¸Œæœ›èƒ½å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©ã€‚ç¬¬ä¸€æ¬¡æ‹¿åˆ€ï¼Œæ‰‹æœ‰ç‚¹é¢¤ï¼Œå¦‚æœå“ªé‡Œæœ‰ä¸è¶³çš„åœ°æ–¹ï¼Œæ¬¢è¿å¤§å®¶åœ¨è¯„è®ºåŒºæ¯«ä¸ç•™æƒ…åœ°æŒ‡å‡ºæ¥ï¼

- class æ–‡ä»¶æ˜¯ä¸€ä¸²è¿ç»­çš„äºŒè¿›åˆ¶ï¼Œç”± 0 å’Œ 1 ç»„æˆï¼Œä½†æˆ‘ä»¬ä»ç„¶å¯ä»¥å€ŸåŠ©ä¸€äº›å·¥å…·æ¥çœ‹æ¸…æ¥šå®ƒçš„çœŸé¢ç›®ã€‚
- class æ–‡ä»¶çš„å†…å®¹é€šå¸¸å¯ä»¥åˆ†ä¸ºä¸‹é¢è¿™å‡ éƒ¨åˆ†ï¼Œé­”æ•°ã€ç‰ˆæœ¬å·ã€å¸¸é‡æ± ã€è®¿é—®æ ‡è®°ã€ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•ã€æ¥å£ç´¢å¼•ã€å­—æ®µè¡¨ã€æ–¹æ³•è¡¨ã€å±æ€§è¡¨ã€‚
- å¸¸é‡æ± åŒ…å«äº†ç±»ã€æ¥å£ã€å­—æ®µå’Œæ–¹æ³•çš„ç¬¦å·å¼•ç”¨ï¼Œä»¥åŠå­—ç¬¦ä¸²å­—é¢é‡å’Œæ•°å€¼å¸¸é‡ã€‚
- è®¿é—®æ ‡è®°ç”¨äºè¯†åˆ«ç±»æˆ–æ¥å£çš„è®¿é—®ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´æ˜¯ä¸æ˜¯ public | private | protectedï¼Œæ˜¯ä¸æ˜¯ staticï¼Œæ˜¯ä¸æ˜¯ final ç­‰ã€‚
- ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•å’Œæ¥å£ç´¢å¼•ç”¨æ¥ç¡®å®šç±»çš„ç»§æ‰¿å…³ç³»ã€‚
- å­—æ®µè¡¨ç”¨æ¥å­˜å‚¨å­—æ®µçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å­—æ®µåï¼Œå­—æ®µçš„å‚æ•°ï¼Œå­—æ®µçš„ç­¾åã€‚
- æ–¹æ³•è¡¨ç”¨æ¥å­˜å‚¨æ–¹æ³•çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–¹æ³•åï¼Œæ–¹æ³•çš„å‚æ•°ï¼Œæ–¹æ³•çš„ç­¾åã€‚
- å±æ€§è¡¨ç”¨æ¥å­˜å‚¨å±æ€§çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å­—æ®µçš„åˆå§‹å€¼ï¼Œæ–¹æ³•çš„å­—èŠ‚ç æŒ‡ä»¤ç­‰ã€‚

ç›¸ä¿¡å¤§å®¶çœ‹å®Œè¿™ç¯‡å†…å®¹åº”è¯¥èƒ½å¯¹ class æ–‡ä»¶æœ‰ä¸€ä¸ªæ¯”è¾ƒæ¸…æ™°çš„è®¤è¯†äº†ã€‚

----

GitHub ä¸Šæ ‡æ˜Ÿ 10000+ çš„å¼€æºçŸ¥è¯†åº“ã€Š[äºŒå“¥çš„ Java è¿›é˜¶ä¹‹è·¯](https://github.com/itwanger/toBeBetterJavaer)ã€‹ç¬¬ä¸€ç‰ˆ PDF ç»ˆäºæ¥äº†ï¼åŒ…æ‹¬JavaåŸºç¡€è¯­æ³•ã€æ•°ç»„&å­—ç¬¦ä¸²ã€OOPã€é›†åˆæ¡†æ¶ã€Java IOã€å¼‚å¸¸å¤„ç†ã€Java æ–°ç‰¹æ€§ã€ç½‘ç»œç¼–ç¨‹ã€NIOã€å¹¶å‘ç¼–ç¨‹ã€JVMç­‰ç­‰ï¼Œå…±è®¡ 32 ä¸‡ä½™å­—ï¼Œ500+å¼ æ‰‹ç»˜å›¾ï¼Œå¯ä»¥è¯´æ˜¯é€šä¿—æ˜“æ‡‚ã€é£è¶£å¹½é»˜â€¦â€¦è¯¦æƒ…æˆ³ï¼š[å¤ªèµäº†ï¼ŒGitHub ä¸Šæ ‡æ˜Ÿ 10000+ çš„ Java æ•™ç¨‹](https://javabetter.cn/overview/)


å¾®ä¿¡æœ **æ²‰é»˜ç‹äºŒ** æˆ–æ‰«æä¸‹æ–¹äºŒç»´ç å…³æ³¨äºŒå“¥çš„åŸåˆ›å…¬ä¼—å·æ²‰é»˜ç‹äºŒï¼Œå›å¤ **222** å³å¯å…è´¹é¢†å–ã€‚

![](https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/gongzhonghao.png)
