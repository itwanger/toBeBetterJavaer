<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.46" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://tobebetterjavaer.com/sidebar/sanfene/redis.html"><meta property="og:site_name" content="Java ç¨‹åºå‘˜è¿›é˜¶ä¹‹è·¯"><meta property="og:title" content="é¢æ¸£é€†è¢­ï¼ˆRedisï¼‰å¿…çœ‹ğŸ‘"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-05-09T06:49:16.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="Redis"><meta property="article:modified_time" content="2022-05-09T06:49:16.000Z"><script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?5230ac143650bf5eb3c14f3fb9b1d3ec";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
      </script><link rel="stylesheet" href="//at.alicdn.com/t/font_3180624_7cy10l7jqqh.css"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icon/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-192.png" type="image/png" sizes="192x192"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/assets/icon/apple-icon-152.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/assets/icon/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>é¢æ¸£é€†è¢­ï¼ˆRedisï¼‰å¿…çœ‹ğŸ‘ | Java ç¨‹åºå‘˜è¿›é˜¶ä¹‹è·¯</title><meta name="description" content="ä¸€ä»½é€šä¿—æ˜“æ‡‚ã€é£è¶£å¹½é»˜çš„Javaå­¦ä¹ æŒ‡å—ï¼Œå†…å®¹æ¶µç›–JavaåŸºç¡€ã€Javaå¹¶å‘ç¼–ç¨‹ã€Javaè™šæ‹Ÿæœºã€Javaä¼ä¸šçº§å¼€å‘ã€Javaé¢è¯•ç­‰æ ¸å¿ƒçŸ¥è¯†ç‚¹ã€‚å­¦Javaï¼Œå°±è®¤å‡†Javaç¨‹åºå‘˜è¿›é˜¶ä¹‹è·¯">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.aa7884a9.css">
    <link rel="modulepreload" href="/assets/app.df242bb6.js"><link rel="modulepreload" href="/assets/redis.html.6fd1634a.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/assets/redis.html.b039ba47.js"><link rel="prefetch" href="/assets/index.html.59c102ba.js"><link rel="prefetch" href="/assets/home.html.a6a7aec9.js"><link rel="prefetch" href="/assets/bzhan-10wan.html.98f8ba37.js"><link rel="prefetch" href="/assets/csdn-1000wan.html.438218cb.js"><link rel="prefetch" href="/assets/index.html.a4bb5c6e.js"><link rel="prefetch" href="/assets/zhihu-1000wan.html.4bf2b6f4.js"><link rel="prefetch" href="/assets/array.html.77525f56.js"><link rel="prefetch" href="/assets/print.html.6fe8360d.js"><link rel="prefetch" href="/assets/basic-data-type.html.6be3e7e2.js"><link rel="prefetch" href="/assets/flow-control.html.f6c60ead.js"><link rel="prefetch" href="/assets/javadoc.html.b34e8efb.js"><link rel="prefetch" href="/assets/operator.html.9431d9fc.js"><link rel="prefetch" href="/assets/java-basic-34.html.70be78f8.js"><link rel="prefetch" href="/assets/java-basic.html.52bd7f06.js"><link rel="prefetch" href="/assets/java-thread.html.4a99fb0e.js"><link rel="prefetch" href="/assets/jvm.html.1b4e3107.js"><link rel="prefetch" href="/assets/beijing.html.5436f34b.js"><link rel="prefetch" href="/assets/chengdu.html.09b27f2f.js"><link rel="prefetch" href="/assets/guangzhou.html.ce1033cd.js"><link rel="prefetch" href="/assets/hangzhou.html.9719a0ea.js"><link rel="prefetch" href="/assets/nanjing.html.0381e4b6.js"><link rel="prefetch" href="/assets/qingdao.html.026cf757.js"><link rel="prefetch" href="/assets/shenzhen.html.037e48a5.js"><link rel="prefetch" href="/assets/suzhou.html.1f658a4a.js"><link rel="prefetch" href="/assets/xian.html.4a14941e.js"><link rel="prefetch" href="/assets/zhengzhou.html.43c30f38.js"><link rel="prefetch" href="/assets/48-keywords.html.e76832ee.js"><link rel="prefetch" href="/assets/Overriding.html.14f830f8.js"><link rel="prefetch" href="/assets/annotation.html.14064668.js"><link rel="prefetch" href="/assets/box.html.54cc70a2.js"><link rel="prefetch" href="/assets/class-object.html.c43412d3.js"><link rel="prefetch" href="/assets/comparable-omparator.html.397dc2ff.js"><link rel="prefetch" href="/assets/deep-copy.html.b367f078.js"><link rel="prefetch" href="/assets/enum.html.21e74b14.js"><link rel="prefetch" href="/assets/equals-hashcode.html.cd3210fa.js"><link rel="prefetch" href="/assets/fanshe.html.13ada7e7.js"><link rel="prefetch" href="/assets/generic.html.7ec41e80.js"><link rel="prefetch" href="/assets/hashcode.html.24290486.js"><link rel="prefetch" href="/assets/immutable.html.ed5b1443.js"><link rel="prefetch" href="/assets/instanceof-jvm.html.845ed78f.js"><link rel="prefetch" href="/assets/int-cache.html.0d30900e.js"><link rel="prefetch" href="/assets/java-naming.html.de2604a0.js"><link rel="prefetch" href="/assets/java-unicode.html.9e4e93b1.js"><link rel="prefetch" href="/assets/jdk-while-for-wuxian-xunhuan.html.e352d875.js"><link rel="prefetch" href="/assets/jdk9-char-byte-string.html.e81be44e.js"><link rel="prefetch" href="/assets/override-overload.html.f7d74176.js"><link rel="prefetch" href="/assets/pass-by-value.html.e26c3cdc.js"><link rel="prefetch" href="/assets/true-generic.html.ce09d792.js"><link rel="prefetch" href="/assets/varables.html.6a80fc0e.js"><link rel="prefetch" href="/assets/arraylist.html.0dcdca73.js"><link rel="prefetch" href="/assets/fail-fast.html.4b8a884f.js"><link rel="prefetch" href="/assets/gailan.html.87d77185.js"><link rel="prefetch" href="/assets/hashmap-interview.html.307a5634.js"><link rel="prefetch" href="/assets/hashmap.html.ab523029.js"><link rel="prefetch" href="/assets/iterator-iterable.html.967b5cf7.js"><link rel="prefetch" href="/assets/linkedlist.html.8ede144e.js"><link rel="prefetch" href="/assets/list-war-2.html.b8fa44fb.js"><link rel="prefetch" href="/assets/arrays.html.7944f961.js"><link rel="prefetch" href="/assets/collections.html.2e6479a3.js"><link rel="prefetch" href="/assets/guava.html.e73aaedd.js"><link rel="prefetch" href="/assets/hutool.html.06e72427.js"><link rel="prefetch" href="/assets/os.html.5e6a959a.js"><link rel="prefetch" href="/assets/wangluo.html.b41cb57f.js"><link rel="prefetch" href="/assets/bat-shuati.html.adba9635.js"><link rel="prefetch" href="/assets/history.html.f2970c79.js"><link rel="prefetch" href="/assets/java.html.c5bee727.js"><link rel="prefetch" href="/assets/jianli.html.75854f37.js"><link rel="prefetch" href="/assets/learn-jianyi.html.1b72d4e2.js"><link rel="prefetch" href="/assets/nicearticle.html.b56e678a.js"><link rel="prefetch" href="/assets/pdf.html.a28195f1.js"><link rel="prefetch" href="/assets/progit.html.3b6ba984.js"><link rel="prefetch" href="/assets/yuanyifeng-c-language.html.1d18c5bc.js"><link rel="prefetch" href="/assets/rumen.html.9cc17590.js"><link rel="prefetch" href="/assets/gailan.html.fee068f9.js"><link rel="prefetch" href="/assets/npe.html.a94a2b73.js"><link rel="prefetch" href="/assets/shijian.html.0924a1ec.js"><link rel="prefetch" href="/assets/try-with-resouces.html.8dcef913.js"><link rel="prefetch" href="/assets/git-qiyuan.html.a341e213.js"><link rel="prefetch" href="/assets/progit.html.a119468c.js"><link rel="prefetch" href="/assets/Chocolatey-Homebrew.html.ad256880.js"><link rel="prefetch" href="/assets/DBeaver.html.75fbe8f6.js"><link rel="prefetch" href="/assets/chiner.html.13c55607.js"><link rel="prefetch" href="/assets/choco.html.f8923e81.js"><link rel="prefetch" href="/assets/fastjson.html.f97ae6fd.js"><link rel="prefetch" href="/assets/forest.html.79a7cfed.js"><link rel="prefetch" href="/assets/gson.html.e79a454d.js"><link rel="prefetch" href="/assets/jackson.html.ded110ad.js"><link rel="prefetch" href="/assets/junit.html.2436284c.js"><link rel="prefetch" href="/assets/knife4j.html.fe2f8e7d.js"><link rel="prefetch" href="/assets/log4j.html.14af993a.js"><link rel="prefetch" href="/assets/log4j2.html.9b5a6f13.js"><link rel="prefetch" href="/assets/logback.html.a9628274.js"><link rel="prefetch" href="/assets/others.html.ed8fcf05.js"><link rel="prefetch" href="/assets/slf4j.html.2fd3dca6.js"><link rel="prefetch" href="/assets/tabby.html.9fb65d66.js"><link rel="prefetch" href="/assets/warp.html.4380b228.js"><link rel="prefetch" href="/assets/4-debug-skill.html.9bd076fc.js"><link rel="prefetch" href="/assets/BIONIOAIO.html.ea89d11f.js"><link rel="prefetch" href="/assets/shangtou.html.dd79a90f.js"><link rel="prefetch" href="/assets/Lambda.html.997b367a.js"><link rel="prefetch" href="/assets/optional.html.23c0a140.js"><link rel="prefetch" href="/assets/stream.html.214aab27.js"><link rel="prefetch" href="/assets/asm.html.0e0abd8b.js"><link rel="prefetch" href="/assets/bytecode.html.ba8f00b6.js"><link rel="prefetch" href="/assets/class-file-jiegou.html.3dff0326.js"><link rel="prefetch" href="/assets/class-load.html.6a788fca.js"><link rel="prefetch" href="/assets/compile-jdk.html.531caac0.js"><link rel="prefetch" href="/assets/cpu-percent-100.html.f6bd745b.js"><link rel="prefetch" href="/assets/gc.html.cec6db87.js"><link rel="prefetch" href="/assets/how-jvm-run-zijiema-zhiling.html.400c699c.js"><link rel="prefetch" href="/assets/how-run-java-code.html.1867de4d.js"><link rel="prefetch" href="/assets/hsdb.html.e06d55d6.js"><link rel="prefetch" href="/assets/jit.html.a14bdfce.js"><link rel="prefetch" href="/assets/meituan-9-gc.html.f5a5b89a.js"><link rel="prefetch" href="/assets/neicun-jiegou.html.f0fca3bb.js"><link rel="prefetch" href="/assets/oom.html.23228526.js"><link rel="prefetch" href="/assets/problem-tools.html.fab08888.js"><link rel="prefetch" href="/assets/tujie-gc.html.ca2dffab.js"><link rel="prefetch" href="/assets/what-happen-when-javac.html.ab4282c1.js"><link rel="prefetch" href="/assets/what-is-jvm.html.5131a239.js"><link rel="prefetch" href="/assets/whereis-the-object.html.c695df3e.js"><link rel="prefetch" href="/assets/zijiema-zhiling.html.34c655bc.js"><link rel="prefetch" href="/assets/zongjie.html.c9e5e3c3.js"><link rel="prefetch" href="/assets/auto-generator.html.edd07e0d.js"><link rel="prefetch" href="/assets/index.html.fd879420.js"><link rel="prefetch" href="/assets/yuneban-wangyiyunyinyue.html.275a589e.js"><link rel="prefetch" href="/assets/waibao-1geyue.html.fbddc89c.js"><link rel="prefetch" href="/assets/yanjiusuo-20wan.html.76b660c5.js"><link rel="prefetch" href="/assets/maven.html.f0c8e738.js"><link rel="prefetch" href="/assets/redis12question.html.58f0e7e0.js"><link rel="prefetch" href="/assets/shanganaliyun.html.04eee07a.js"><link rel="prefetch" href="/assets/api-wangguan.html.c2b18262.js"><link rel="prefetch" href="/assets/rumen.html.28382740.js"><link rel="prefetch" href="/assets/100-budiushi.html.c3040dbf.js"><link rel="prefetch" href="/assets/rabbitmq-rumen.html.1f0066c6.js"><link rel="prefetch" href="/assets/deletedb-binlog-weiguanjishu.html.605b28a5.js"><link rel="prefetch" href="/assets/redis-shuju-yizhixing.html.0d2d7824.js"><link rel="prefetch" href="/assets/40-interview.html.2cb0fe6c.js"><link rel="prefetch" href="/assets/nginx.html.c9dd536d.js"><link rel="prefetch" href="/assets/BOKEYUANruhegaoxiaodixuexijishu.html.54dd2a4d.js"><link rel="prefetch" href="/assets/ZHIHUjavaxuexidaoshemechengduokeyizhaodiyifengongzuo.html.e4fead09.js"><link rel="prefetch" href="/assets/bokeyuan-jianxijavazhongdifangwenquanxiankongzhi.html.bc8753e4.js"><link rel="prefetch" href="/assets/bokeyuan-ruhegaoxiaodixuexijishu.html.e9d4ca36.js"><link rel="prefetch" href="/assets/haibukuaiyongmybatisplusshoubashoujiaoni.html.4769ffdb.js"><link rel="prefetch" href="/assets/javaxuexidaoshemechengduokeyizhaodiyifengongzuo.html.3289a228.js"><link rel="prefetch" href="/assets/jiagoushizenyanghuizhijitongjiagoulantu.html.980a677a.js"><link rel="prefetch" href="/assets/jielehenduosihuodiganchu.html.0ffa8f43.js"><link rel="prefetch" href="/assets/jishuzongjianbeikaichuliao.html.1b7e52c1.js"><link rel="prefetch" href="/assets/weixin-liaoliaoxianliu.html.624e17ae.js"><link rel="prefetch" href="/assets/weixin-xinllgjszjszzpojozsyjbsjlxyhjfyll.html.8f640dc9.js"><link rel="prefetch" href="/assets/weixin-zuixinbujiabandigongsimingdan.html.bf87a7d5.js"><link rel="prefetch" href="/assets/abstract.html.3094fdb5.js"><link rel="prefetch" href="/assets/code-init.html.70ef628a.js"><link rel="prefetch" href="/assets/construct.html.5ae3e6eb.js"><link rel="prefetch" href="/assets/final.html.c83d9074.js"><link rel="prefetch" href="/assets/inner-class.html.f2dd62ed.js"><link rel="prefetch" href="/assets/instanceof.html.d3be3510.js"><link rel="prefetch" href="/assets/interface.html.7833e904.js"><link rel="prefetch" href="/assets/method.html.4d951864.js"><link rel="prefetch" href="/assets/object-class.html.85420110.js"><link rel="prefetch" href="/assets/static.html.1a009c06.js"><link rel="prefetch" href="/assets/this-super.html.65fa5da3.js"><link rel="prefetch" href="/assets/var.html.7a0cfd0f.js"><link rel="prefetch" href="/assets/hello-world.html.d0d5adf0.js"><link rel="prefetch" href="/assets/what-is-java.html.b724e432.js"><link rel="prefetch" href="/assets/redis-springboot.html.5e59844d.js"><link rel="prefetch" href="/assets/rumen.html.e13dbda5.js"><link rel="prefetch" href="/assets/xuebeng-chuantou-jichuan.html.26ef04a3.js"><link rel="prefetch" href="/assets/image-yasuo.html.8853b749.js"><link rel="prefetch" href="/assets/log4j2.html.b3fd06a7.js"><link rel="prefetch" href="/assets/computer-base.html.f469b424.js"><link rel="prefetch" href="/assets/Filter-Interceptor-Listener.html.d4211e38.js"><link rel="prefetch" href="/assets/aop-log.html.390b071a.js"><link rel="prefetch" href="/assets/cors.html.b8f51585.js"><link rel="prefetch" href="/assets/initializr.html.ae05e8c2.js"><link rel="prefetch" href="/assets/ioc.html.1c4cca00.js"><link rel="prefetch" href="/assets/jpa.html.c4109873.js"><link rel="prefetch" href="/assets/jwt.html.b4f208bb.js"><link rel="prefetch" href="/assets/logback.html.65200f68.js"><link rel="prefetch" href="/assets/macos-codingmore-run.html.b03e8070.js"><link rel="prefetch" href="/assets/mysql-druid.html.bf232591.js"><link rel="prefetch" href="/assets/oss.html.977b34d5.js"><link rel="prefetch" href="/assets/springtask.html.406633ab.js"><link rel="prefetch" href="/assets/swagger.html.03ed15b7.js"><link rel="prefetch" href="/assets/thymeleaf.html.1a24ed99.js"><link rel="prefetch" href="/assets/tomcat.html.73ec3645.js"><link rel="prefetch" href="/assets/transaction.html.c6ea47a0.js"><link rel="prefetch" href="/assets/constant-pool.html.c79f5c21.js"><link rel="prefetch" href="/assets/equals.html.2fb94b25.js"><link rel="prefetch" href="/assets/immutable.html.36fadfba.js"><link rel="prefetch" href="/assets/intern.html.3d87fa6f.js"><link rel="prefetch" href="/assets/join.html.bb336f49.js"><link rel="prefetch" href="/assets/split.html.0ff2ce60.js"><link rel="prefetch" href="/assets/tobebetterjavaer-beian.html.3820089c.js"><link rel="prefetch" href="/assets/tobebetterjavaer-wangzhan-shangxian.html.a80895d2.js"><link rel="prefetch" href="/assets/tupian-zhuanlian.html.7ab13c07.js"><link rel="prefetch" href="/assets/BlockingQueue.html.9ccd9ba0.js"><link rel="prefetch" href="/assets/ConcurrentHashMap.html.e7f83c81.js"><link rel="prefetch" href="/assets/ConcurrentLinkedQueue.html.da4bfec1.js"><link rel="prefetch" href="/assets/CopyOnWriteArrayList.html.b8e564c2.js"><link rel="prefetch" href="/assets/CountDownLatch.html.f036fab2.js"><link rel="prefetch" href="/assets/LockSupport.html.c7d00cfa.js"><link rel="prefetch" href="/assets/ReentrantReadWriteLock.html.d1bd972f.js"><link rel="prefetch" href="/assets/ScheduledThreadPoolExecutor.html.8d668046.js"><link rel="prefetch" href="/assets/ThreadLocal.html.f9a6fed8.js"><link rel="prefetch" href="/assets/ali-executors.html.988adc8e.js"><link rel="prefetch" href="/assets/aqs.html.d6a8f5b4.js"><link rel="prefetch" href="/assets/atomic.html.93391f09.js"><link rel="prefetch" href="/assets/cas.html.4534d702.js"><link rel="prefetch" href="/assets/condition.html.a41bdc76.js"><link rel="prefetch" href="/assets/fork-join.html.f967d485.js"><link rel="prefetch" href="/assets/jmm.html.7be72db5.js"><link rel="prefetch" href="/assets/lock.html.5385ecc8.js"><link rel="prefetch" href="/assets/map.html.ae80f8e6.js"><link rel="prefetch" href="/assets/pool.html.1918e02b.js"><link rel="prefetch" href="/assets/reentrantLock.html.002f84e4.js"><link rel="prefetch" href="/assets/shengchanzhe-xiaofeizhe.html.0915b865.js"><link rel="prefetch" href="/assets/synchronized.html.6094d556.js"><link rel="prefetch" href="/assets/thread-bring-some-problem.html.c8ae3e7a.js"><link rel="prefetch" href="/assets/thread-group-and-thread-priority.html.873709ce.js"><link rel="prefetch" href="/assets/thread-state-and-method.html.70b8e2e8.js"><link rel="prefetch" href="/assets/volatile.html.26279f7f.js"><link rel="prefetch" href="/assets/wangzhe-thread.html.dda72253.js"><link rel="prefetch" href="/assets/why-need-thread.html.507a940d.js"><link rel="prefetch" href="/assets/aliyun-shuaiguo-gongchengshi.html.e4346151.js"><link rel="prefetch" href="/assets/chadiansanhuo.html.e9cc0b99.js"><link rel="prefetch" href="/assets/chengxuyuannv-chonghui-java.html.b9de6702.js"><link rel="prefetch" href="/assets/daxue-nuli-jisuanji.html.2b1074e1.js"><link rel="prefetch" href="/assets/fumutuanju.html.577491d1.js"><link rel="prefetch" href="/assets/electron-information-engineering.html.b3d4a3e7.js"><link rel="prefetch" href="/assets/read-csapp.html.23c82cf4.js"><link rel="prefetch" href="/assets/algorithm.html.17f14372.js"><link rel="prefetch" href="/assets/c.html.2adcc0b8.js"><link rel="prefetch" href="/assets/ccc.html.ec50d3a7.js"><link rel="prefetch" href="/assets/go.html.7279e529.js"><link rel="prefetch" href="/assets/lanqiaobei.html.3580fcbe.js"><link rel="prefetch" href="/assets/os.html.6a42c2f5.js"><link rel="prefetch" href="/assets/python.html.36401656.js"><link rel="prefetch" href="/assets/qianduan.html.1884f6af.js"><link rel="prefetch" href="/assets/index.html.fe9dcc15.js"><link rel="prefetch" href="/assets/java-mianshi-zhinan.html.f1a349c4.js"><link rel="prefetch" href="/assets/index.html.af7b50d7.js"><link rel="prefetch" href="/assets/jibenjieshao.html.b8a08842.js"><link rel="prefetch" href="/assets/mysql.html.99fca397.js"><link rel="prefetch" href="/assets/collection.html.42c40509.js"><link rel="prefetch" href="/assets/javase.html.b3add115.js"><link rel="prefetch" href="/assets/javathread.html.1bcda474.js"><link rel="prefetch" href="/assets/jvm.html.dd68f45e.js"><link rel="prefetch" href="/assets/mybatis.html.750369f6.js"><link rel="prefetch" href="/assets/nixi.html.689e1ee6.js"><link rel="prefetch" href="/assets/spring.html.75b19ea2.js"><link rel="prefetch" href="/assets/jvm.html.76aa5cf0.js"><link rel="prefetch" href="/assets/thread.html.3c6bc9ba.js"><link rel="prefetch" href="/assets/yitiaolong.html.1d8d7fb6.js"><link rel="prefetch" href="/assets/404.html.e75684b7.js"><link rel="prefetch" href="/assets/index.html.7b7d58d0.js"><link rel="prefetch" href="/assets/home.html.e526c20e.js"><link rel="prefetch" href="/assets/bzhan-10wan.html.c484aa13.js"><link rel="prefetch" href="/assets/csdn-1000wan.html.ac3cac01.js"><link rel="prefetch" href="/assets/index.html.54f03448.js"><link rel="prefetch" href="/assets/zhihu-1000wan.html.10d5ce1e.js"><link rel="prefetch" href="/assets/array.html.4f99ffa5.js"><link rel="prefetch" href="/assets/print.html.cd0d2810.js"><link rel="prefetch" href="/assets/basic-data-type.html.65b117b1.js"><link rel="prefetch" href="/assets/flow-control.html.2aef32b6.js"><link rel="prefetch" href="/assets/javadoc.html.21ea06af.js"><link rel="prefetch" href="/assets/operator.html.107bf827.js"><link rel="prefetch" href="/assets/java-basic-34.html.77f3912e.js"><link rel="prefetch" href="/assets/java-basic.html.0de24961.js"><link rel="prefetch" href="/assets/java-thread.html.721c756a.js"><link rel="prefetch" href="/assets/jvm.html.846ad3e0.js"><link rel="prefetch" href="/assets/beijing.html.b14b773f.js"><link rel="prefetch" href="/assets/chengdu.html.9815247c.js"><link rel="prefetch" href="/assets/guangzhou.html.76ccb2ab.js"><link rel="prefetch" href="/assets/hangzhou.html.f24367f8.js"><link rel="prefetch" href="/assets/nanjing.html.95ebf87d.js"><link rel="prefetch" href="/assets/qingdao.html.c83b94a5.js"><link rel="prefetch" href="/assets/shenzhen.html.79fc0329.js"><link rel="prefetch" href="/assets/suzhou.html.5bd017f5.js"><link rel="prefetch" href="/assets/xian.html.9720ddef.js"><link rel="prefetch" href="/assets/zhengzhou.html.3a5a4340.js"><link rel="prefetch" href="/assets/48-keywords.html.a78f27df.js"><link rel="prefetch" href="/assets/Overriding.html.76028677.js"><link rel="prefetch" href="/assets/annotation.html.7842ae54.js"><link rel="prefetch" href="/assets/box.html.4971a6d7.js"><link rel="prefetch" href="/assets/class-object.html.14621c36.js"><link rel="prefetch" href="/assets/comparable-omparator.html.6981ef25.js"><link rel="prefetch" href="/assets/deep-copy.html.fd83f430.js"><link rel="prefetch" href="/assets/enum.html.4e6c5b67.js"><link rel="prefetch" href="/assets/equals-hashcode.html.390b8a88.js"><link rel="prefetch" href="/assets/fanshe.html.efeff003.js"><link rel="prefetch" href="/assets/generic.html.e68ecfe2.js"><link rel="prefetch" href="/assets/hashcode.html.3d4ddd56.js"><link rel="prefetch" href="/assets/immutable.html.f55b754a.js"><link rel="prefetch" href="/assets/instanceof-jvm.html.70e1d6f5.js"><link rel="prefetch" href="/assets/int-cache.html.c0553623.js"><link rel="prefetch" href="/assets/java-naming.html.ce668a70.js"><link rel="prefetch" href="/assets/java-unicode.html.b8b31704.js"><link rel="prefetch" href="/assets/jdk-while-for-wuxian-xunhuan.html.8be23660.js"><link rel="prefetch" href="/assets/jdk9-char-byte-string.html.22eda4a9.js"><link rel="prefetch" href="/assets/override-overload.html.338f834e.js"><link rel="prefetch" href="/assets/pass-by-value.html.fa7af41e.js"><link rel="prefetch" href="/assets/true-generic.html.a3e3f389.js"><link rel="prefetch" href="/assets/varables.html.edd32a53.js"><link rel="prefetch" href="/assets/arraylist.html.dffb9b14.js"><link rel="prefetch" href="/assets/fail-fast.html.3e087997.js"><link rel="prefetch" href="/assets/gailan.html.2d4ff774.js"><link rel="prefetch" href="/assets/hashmap-interview.html.67af44fd.js"><link rel="prefetch" href="/assets/hashmap.html.bef4e6ca.js"><link rel="prefetch" href="/assets/iterator-iterable.html.5cce753c.js"><link rel="prefetch" href="/assets/linkedlist.html.e52baee4.js"><link rel="prefetch" href="/assets/list-war-2.html.1f36b848.js"><link rel="prefetch" href="/assets/arrays.html.17a6a15d.js"><link rel="prefetch" href="/assets/collections.html.16ec007a.js"><link rel="prefetch" href="/assets/guava.html.41ffcaea.js"><link rel="prefetch" href="/assets/hutool.html.e4132b04.js"><link rel="prefetch" href="/assets/os.html.45f78d9b.js"><link rel="prefetch" href="/assets/wangluo.html.42a0af04.js"><link rel="prefetch" href="/assets/bat-shuati.html.369c7899.js"><link rel="prefetch" href="/assets/history.html.2ab6c413.js"><link rel="prefetch" href="/assets/java.html.aa6204ac.js"><link rel="prefetch" href="/assets/jianli.html.740d37ac.js"><link rel="prefetch" href="/assets/learn-jianyi.html.966d7017.js"><link rel="prefetch" href="/assets/nicearticle.html.dacd70f8.js"><link rel="prefetch" href="/assets/pdf.html.aa110ec1.js"><link rel="prefetch" href="/assets/progit.html.1b487241.js"><link rel="prefetch" href="/assets/yuanyifeng-c-language.html.fef0fb9f.js"><link rel="prefetch" href="/assets/rumen.html.9b83b55c.js"><link rel="prefetch" href="/assets/gailan.html.6fb6c22a.js"><link rel="prefetch" href="/assets/npe.html.963fe453.js"><link rel="prefetch" href="/assets/shijian.html.a603a2cc.js"><link rel="prefetch" href="/assets/try-with-resouces.html.d5d53b16.js"><link rel="prefetch" href="/assets/git-qiyuan.html.05fab4d1.js"><link rel="prefetch" href="/assets/progit.html.7a3ded24.js"><link rel="prefetch" href="/assets/Chocolatey-Homebrew.html.a15ffb7d.js"><link rel="prefetch" href="/assets/DBeaver.html.3f466980.js"><link rel="prefetch" href="/assets/chiner.html.8373f1bc.js"><link rel="prefetch" href="/assets/choco.html.bc165f4c.js"><link rel="prefetch" href="/assets/fastjson.html.2915a920.js"><link rel="prefetch" href="/assets/forest.html.20b2f837.js"><link rel="prefetch" href="/assets/gson.html.19af31a3.js"><link rel="prefetch" href="/assets/jackson.html.129709a1.js"><link rel="prefetch" href="/assets/junit.html.895af345.js"><link rel="prefetch" href="/assets/knife4j.html.af2d5656.js"><link rel="prefetch" href="/assets/log4j.html.4a8bdefe.js"><link rel="prefetch" href="/assets/log4j2.html.796cfc97.js"><link rel="prefetch" href="/assets/logback.html.16fb2fee.js"><link rel="prefetch" href="/assets/others.html.543a893c.js"><link rel="prefetch" href="/assets/slf4j.html.8848846a.js"><link rel="prefetch" href="/assets/tabby.html.055f4657.js"><link rel="prefetch" href="/assets/warp.html.d59eef2b.js"><link rel="prefetch" href="/assets/4-debug-skill.html.9e5adc74.js"><link rel="prefetch" href="/assets/BIONIOAIO.html.1ec1443a.js"><link rel="prefetch" href="/assets/shangtou.html.453da032.js"><link rel="prefetch" href="/assets/Lambda.html.ef139f75.js"><link rel="prefetch" href="/assets/optional.html.f1fd7866.js"><link rel="prefetch" href="/assets/stream.html.49c88b8d.js"><link rel="prefetch" href="/assets/asm.html.b2ec3973.js"><link rel="prefetch" href="/assets/bytecode.html.0458870f.js"><link rel="prefetch" href="/assets/class-file-jiegou.html.c2975d5a.js"><link rel="prefetch" href="/assets/class-load.html.bff5c6e4.js"><link rel="prefetch" href="/assets/compile-jdk.html.71345380.js"><link rel="prefetch" href="/assets/cpu-percent-100.html.11988873.js"><link rel="prefetch" href="/assets/gc.html.85b56c2f.js"><link rel="prefetch" href="/assets/how-jvm-run-zijiema-zhiling.html.df3aae8d.js"><link rel="prefetch" href="/assets/how-run-java-code.html.c5447e81.js"><link rel="prefetch" href="/assets/hsdb.html.58cc6862.js"><link rel="prefetch" href="/assets/jit.html.c33bb3e7.js"><link rel="prefetch" href="/assets/meituan-9-gc.html.416f1b2c.js"><link rel="prefetch" href="/assets/neicun-jiegou.html.01618b42.js"><link rel="prefetch" href="/assets/oom.html.b6e43044.js"><link rel="prefetch" href="/assets/problem-tools.html.d71b4603.js"><link rel="prefetch" href="/assets/tujie-gc.html.c9dd92e5.js"><link rel="prefetch" href="/assets/what-happen-when-javac.html.3c45e099.js"><link rel="prefetch" href="/assets/what-is-jvm.html.8e820d05.js"><link rel="prefetch" href="/assets/whereis-the-object.html.e04761a1.js"><link rel="prefetch" href="/assets/zijiema-zhiling.html.a0239f74.js"><link rel="prefetch" href="/assets/zongjie.html.4c721d5c.js"><link rel="prefetch" href="/assets/auto-generator.html.b3b251dd.js"><link rel="prefetch" href="/assets/index.html.aa130762.js"><link rel="prefetch" href="/assets/yuneban-wangyiyunyinyue.html.863ca813.js"><link rel="prefetch" href="/assets/waibao-1geyue.html.8c1e8091.js"><link rel="prefetch" href="/assets/yanjiusuo-20wan.html.66f5eb31.js"><link rel="prefetch" href="/assets/maven.html.601899e6.js"><link rel="prefetch" href="/assets/redis12question.html.c2ff527a.js"><link rel="prefetch" href="/assets/shanganaliyun.html.a8185041.js"><link rel="prefetch" href="/assets/api-wangguan.html.65280273.js"><link rel="prefetch" href="/assets/rumen.html.f51406bb.js"><link rel="prefetch" href="/assets/100-budiushi.html.68123c7f.js"><link rel="prefetch" href="/assets/rabbitmq-rumen.html.e2f85e6a.js"><link rel="prefetch" href="/assets/deletedb-binlog-weiguanjishu.html.006c6b67.js"><link rel="prefetch" href="/assets/redis-shuju-yizhixing.html.73a55990.js"><link rel="prefetch" href="/assets/40-interview.html.25a750aa.js"><link rel="prefetch" href="/assets/nginx.html.77d02aa0.js"><link rel="prefetch" href="/assets/BOKEYUANruhegaoxiaodixuexijishu.html.5d3c8ea1.js"><link rel="prefetch" href="/assets/ZHIHUjavaxuexidaoshemechengduokeyizhaodiyifengongzuo.html.fe0e97a8.js"><link rel="prefetch" href="/assets/bokeyuan-jianxijavazhongdifangwenquanxiankongzhi.html.aa189846.js"><link rel="prefetch" href="/assets/bokeyuan-ruhegaoxiaodixuexijishu.html.5e113029.js"><link rel="prefetch" href="/assets/haibukuaiyongmybatisplusshoubashoujiaoni.html.66e763d8.js"><link rel="prefetch" href="/assets/javaxuexidaoshemechengduokeyizhaodiyifengongzuo.html.ab0dca9d.js"><link rel="prefetch" href="/assets/jiagoushizenyanghuizhijitongjiagoulantu.html.01341aa6.js"><link rel="prefetch" href="/assets/jielehenduosihuodiganchu.html.c164cfce.js"><link rel="prefetch" href="/assets/jishuzongjianbeikaichuliao.html.b6321ccc.js"><link rel="prefetch" href="/assets/weixin-liaoliaoxianliu.html.27586d61.js"><link rel="prefetch" href="/assets/weixin-xinllgjszjszzpojozsyjbsjlxyhjfyll.html.fe69fb0a.js"><link rel="prefetch" href="/assets/weixin-zuixinbujiabandigongsimingdan.html.7c085244.js"><link rel="prefetch" href="/assets/abstract.html.c6059669.js"><link rel="prefetch" href="/assets/code-init.html.8036d74b.js"><link rel="prefetch" href="/assets/construct.html.3d408c28.js"><link rel="prefetch" href="/assets/final.html.171e441f.js"><link rel="prefetch" href="/assets/inner-class.html.859edb19.js"><link rel="prefetch" href="/assets/instanceof.html.8ba53d74.js"><link rel="prefetch" href="/assets/interface.html.c733a6ac.js"><link rel="prefetch" href="/assets/method.html.b595bbaa.js"><link rel="prefetch" href="/assets/object-class.html.4799d5bf.js"><link rel="prefetch" href="/assets/static.html.c6be07b6.js"><link rel="prefetch" href="/assets/this-super.html.56641063.js"><link rel="prefetch" href="/assets/var.html.789ab955.js"><link rel="prefetch" href="/assets/hello-world.html.219ce7e7.js"><link rel="prefetch" href="/assets/what-is-java.html.2a93b165.js"><link rel="prefetch" href="/assets/redis-springboot.html.567215a5.js"><link rel="prefetch" href="/assets/rumen.html.c37e0b1c.js"><link rel="prefetch" href="/assets/xuebeng-chuantou-jichuan.html.76b91f0e.js"><link rel="prefetch" href="/assets/image-yasuo.html.433d3dd3.js"><link rel="prefetch" href="/assets/log4j2.html.1724df41.js"><link rel="prefetch" href="/assets/computer-base.html.eca798cc.js"><link rel="prefetch" href="/assets/Filter-Interceptor-Listener.html.0867f3ae.js"><link rel="prefetch" href="/assets/aop-log.html.58182ae4.js"><link rel="prefetch" href="/assets/cors.html.d20e612d.js"><link rel="prefetch" href="/assets/initializr.html.0275e250.js"><link rel="prefetch" href="/assets/ioc.html.e7e093ea.js"><link rel="prefetch" href="/assets/jpa.html.6941e837.js"><link rel="prefetch" href="/assets/jwt.html.ed8c7468.js"><link rel="prefetch" href="/assets/logback.html.ff1d078b.js"><link rel="prefetch" href="/assets/macos-codingmore-run.html.dd69fef9.js"><link rel="prefetch" href="/assets/mysql-druid.html.54169bb6.js"><link rel="prefetch" href="/assets/oss.html.0e10a8e7.js"><link rel="prefetch" href="/assets/springtask.html.a44de9f0.js"><link rel="prefetch" href="/assets/swagger.html.c936fb04.js"><link rel="prefetch" href="/assets/thymeleaf.html.0c178402.js"><link rel="prefetch" href="/assets/tomcat.html.43cc36e8.js"><link rel="prefetch" href="/assets/transaction.html.40b93699.js"><link rel="prefetch" href="/assets/constant-pool.html.a416a446.js"><link rel="prefetch" href="/assets/equals.html.3bfbe84b.js"><link rel="prefetch" href="/assets/immutable.html.3badd863.js"><link rel="prefetch" href="/assets/intern.html.837845af.js"><link rel="prefetch" href="/assets/join.html.aad68fb5.js"><link rel="prefetch" href="/assets/split.html.658044b9.js"><link rel="prefetch" href="/assets/tobebetterjavaer-beian.html.1e07db11.js"><link rel="prefetch" href="/assets/tobebetterjavaer-wangzhan-shangxian.html.d16c48da.js"><link rel="prefetch" href="/assets/tupian-zhuanlian.html.9e79d82d.js"><link rel="prefetch" href="/assets/BlockingQueue.html.64ecf5ff.js"><link rel="prefetch" href="/assets/ConcurrentHashMap.html.e34a92c6.js"><link rel="prefetch" href="/assets/ConcurrentLinkedQueue.html.5d33097d.js"><link rel="prefetch" href="/assets/CopyOnWriteArrayList.html.3b53d588.js"><link rel="prefetch" href="/assets/CountDownLatch.html.1beda295.js"><link rel="prefetch" href="/assets/LockSupport.html.b0aa5f08.js"><link rel="prefetch" href="/assets/ReentrantReadWriteLock.html.52f9da6f.js"><link rel="prefetch" href="/assets/ScheduledThreadPoolExecutor.html.5f8d291f.js"><link rel="prefetch" href="/assets/ThreadLocal.html.e793bcdd.js"><link rel="prefetch" href="/assets/ali-executors.html.b339b6b9.js"><link rel="prefetch" href="/assets/aqs.html.af099d67.js"><link rel="prefetch" href="/assets/atomic.html.8aeb73f4.js"><link rel="prefetch" href="/assets/cas.html.3e45f2bb.js"><link rel="prefetch" href="/assets/condition.html.38256068.js"><link rel="prefetch" href="/assets/fork-join.html.a8bb42e0.js"><link rel="prefetch" href="/assets/jmm.html.41d07a34.js"><link rel="prefetch" href="/assets/lock.html.e6fdaf8d.js"><link rel="prefetch" href="/assets/map.html.d9195965.js"><link rel="prefetch" href="/assets/pool.html.f29c6469.js"><link rel="prefetch" href="/assets/reentrantLock.html.41b364ea.js"><link rel="prefetch" href="/assets/shengchanzhe-xiaofeizhe.html.564a6033.js"><link rel="prefetch" href="/assets/synchronized.html.879d59c3.js"><link rel="prefetch" href="/assets/thread-bring-some-problem.html.1e74a594.js"><link rel="prefetch" href="/assets/thread-group-and-thread-priority.html.51e2a7d6.js"><link rel="prefetch" href="/assets/thread-state-and-method.html.8bed1a07.js"><link rel="prefetch" href="/assets/volatile.html.521af5a9.js"><link rel="prefetch" href="/assets/wangzhe-thread.html.f69c3d8b.js"><link rel="prefetch" href="/assets/why-need-thread.html.340f87fb.js"><link rel="prefetch" href="/assets/aliyun-shuaiguo-gongchengshi.html.51d0809a.js"><link rel="prefetch" href="/assets/chadiansanhuo.html.4b30898d.js"><link rel="prefetch" href="/assets/chengxuyuannv-chonghui-java.html.6b588a31.js"><link rel="prefetch" href="/assets/daxue-nuli-jisuanji.html.d0d85a1f.js"><link rel="prefetch" href="/assets/fumutuanju.html.f4569795.js"><link rel="prefetch" href="/assets/electron-information-engineering.html.3a6d602d.js"><link rel="prefetch" href="/assets/read-csapp.html.b18968d8.js"><link rel="prefetch" href="/assets/algorithm.html.e5037d53.js"><link rel="prefetch" href="/assets/c.html.54fd84e3.js"><link rel="prefetch" href="/assets/ccc.html.80d0e3de.js"><link rel="prefetch" href="/assets/go.html.ced3c556.js"><link rel="prefetch" href="/assets/lanqiaobei.html.cc45b130.js"><link rel="prefetch" href="/assets/os.html.479bab29.js"><link rel="prefetch" href="/assets/python.html.841e442b.js"><link rel="prefetch" href="/assets/qianduan.html.10268940.js"><link rel="prefetch" href="/assets/index.html.7d92bfba.js"><link rel="prefetch" href="/assets/java-mianshi-zhinan.html.2a7ca0a8.js"><link rel="prefetch" href="/assets/index.html.a5729cfa.js"><link rel="prefetch" href="/assets/jibenjieshao.html.a254e918.js"><link rel="prefetch" href="/assets/mysql.html.378ec8fc.js"><link rel="prefetch" href="/assets/collection.html.e8c4206d.js"><link rel="prefetch" href="/assets/javase.html.a9b9ab83.js"><link rel="prefetch" href="/assets/javathread.html.054857de.js"><link rel="prefetch" href="/assets/jvm.html.3840860f.js"><link rel="prefetch" href="/assets/mybatis.html.e8fe38bf.js"><link rel="prefetch" href="/assets/nixi.html.01b9562e.js"><link rel="prefetch" href="/assets/spring.html.87214b1e.js"><link rel="prefetch" href="/assets/jvm.html.389cf5b2.js"><link rel="prefetch" href="/assets/thread.html.b51bbb69.js"><link rel="prefetch" href="/assets/yitiaolong.html.9d638d03.js"><link rel="prefetch" href="/assets/404.html.19bff199.js"><link rel="prefetch" href="/assets/404.ba378284.js"><link rel="prefetch" href="/assets/Layout.05028864.js"><link rel="prefetch" href="/assets/Slide.dbc0e8c0.js"><link rel="prefetch" href="/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/assets/photoswipe.esm.92018b73.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/" class="brand"><img class="logo" src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/logo-02.png" alt="Java ç¨‹åºå‘˜è¿›é˜¶ä¹‹è·¯"><!----><span class="site-name hide-in-pad">Java ç¨‹åºå‘˜è¿›é˜¶ä¹‹è·¯</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/home.html" class="nav-link" aria-label="è¿›é˜¶ä¹‹è·¯"><span class="icon iconfont icon-lujing" style=""></span>è¿›é˜¶ä¹‹è·¯<!----></a></div><div class="nav-item hide-in-mobile"><a href="/zhishixingqiu/java-mianshi-zhinan.html" class="nav-link" aria-label="æ˜Ÿçƒä¸“æ "><span class="icon iconfont icon-Artboard" style=""></span>æ˜Ÿçƒä¸“æ <!----></a></div><div class="nav-item hide-in-mobile"><a href="/xuexiluxian/" class="nav-link" aria-label="å­¦ä¹ è·¯çº¿"><span class="icon iconfont icon-luxian" style=""></span>å­¦ä¹ è·¯çº¿<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://space.bilibili.com/513340480" rel="noopener noreferrer" target="_blank" aria-label="Bç«™è§†é¢‘" class="nav-link"><span class="icon iconfont icon-bzhan" style=""></span>Bç«™è§†é¢‘<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="çè—èµ„æº"><span class="title"><span class="icon iconfont icon-youzhi" style=""></span>çè—èµ„æº</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/download/java.html" class="nav-link" aria-label="Javaç”µå­ä¹¦ä¸‹è½½"><span class="icon iconfont icon-java" style=""></span>Javaç”µå­ä¹¦ä¸‹è½½<!----></a></li><li class="dropdown-item"><a href="/download/pdf.html" class="nav-link" aria-label="PDFå¹²è´§ç¬”è®°ä¸‹è½½"><span class="icon iconfont icon-pdf" style=""></span>PDFå¹²è´§ç¬”è®°ä¸‹è½½<!----></a></li><li class="dropdown-item"><a href="/download/learn-jianyi.html" class="nav-link" aria-label="å­¦ä¹ å»ºè®®"><span class="icon iconfont icon-xuexijianyi" style=""></span>å­¦ä¹ å»ºè®®<!----></a></li><li class="dropdown-item"><a href="/sidebar/sanfene/nixi.html" class="nav-link" aria-label="é¢æ¸£é€†è¢­"><span class="icon iconfont icon-zhunbei" style=""></span>é¢æ¸£é€†è¢­<!----></a></li><li class="dropdown-item"><a href="/download/nicearticle.html" class="nav-link" aria-label="ä¼˜è´¨æ–‡ç« "><span class="icon iconfont icon-youzhi" style=""></span>ä¼˜è´¨æ–‡ç« <!----></a></li><li class="dropdown-item"><a href="/download/history.html" class="nav-link" aria-label="ç½‘ç»œæ—¥å¿—"><span class="icon iconfont icon-rizhi" style=""></span>ç½‘ç»œæ—¥å¿—<!----></a></li><li class="dropdown-item"><a href="https://docsify.tobebetterjavaer.com/" rel="noopener noreferrer" target="_blank" aria-label="å›åˆ°è¿‡å»" class="nav-link"><span class="icon iconfont icon-fanhuijiuban" style=""></span>å›åˆ°è¿‡å»<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></button></div></div></nav><!----></div><div class="navbar-right"><!----><div class="nav-item"><!----></div><div class="nav-item"><a class="repo-link" href="https://github.com/itwanger/toBeBetterJavaer" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><div id="docsearch-container"></div><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/sidebar/sanfene/javase.html" class="nav-link sidebar-link sidebar-page" aria-label="Java åŸºç¡€"><!---->Java åŸºç¡€<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/sidebar/sanfene/collection.html" class="nav-link sidebar-link sidebar-page" aria-label="Java é›†åˆæ¡†æ¶"><!---->Java é›†åˆæ¡†æ¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/sidebar/sanfene/javathread.html" class="nav-link sidebar-link sidebar-page" aria-label="Java å¹¶å‘ç¼–ç¨‹"><!---->Java å¹¶å‘ç¼–ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/sidebar/sanfene/jvm.html" class="nav-link sidebar-link sidebar-page" aria-label="Java è™šæ‹Ÿæœº"><!---->Java è™šæ‹Ÿæœº<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/sidebar/sanfene/spring.html" class="nav-link sidebar-link sidebar-page" aria-label="Spring"><!---->Spring<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/sidebar/sanfene/redis.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Redis"><!---->Redis<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#åŸºç¡€" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŸºç¡€"><!---->åŸºç¡€<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_1-è¯´è¯´ä»€ä¹ˆæ˜¯redis" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.è¯´è¯´ä»€ä¹ˆæ˜¯Redis?"><!---->1.è¯´è¯´ä»€ä¹ˆæ˜¯Redis?<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_2-rediså¯ä»¥ç”¨æ¥å¹²ä»€ä¹ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.Rediså¯ä»¥ç”¨æ¥å¹²ä»€ä¹ˆï¼Ÿ"><!---->2.Rediså¯ä»¥ç”¨æ¥å¹²ä»€ä¹ˆï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_3-redis-æœ‰å“ªäº›æ•°æ®ç»“æ„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.Redis æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Ÿ"><!---->3.Redis æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_4-redisä¸ºä»€ä¹ˆå¿«å‘¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.Redisä¸ºä»€ä¹ˆå¿«å‘¢ï¼Ÿ"><!---->4.Redisä¸ºä»€ä¹ˆå¿«å‘¢ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_5-èƒ½è¯´ä¸€ä¸‹i-oå¤šè·¯å¤ç”¨å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.èƒ½è¯´ä¸€ä¸‹I/Oå¤šè·¯å¤ç”¨å—ï¼Ÿ"><!---->5.èƒ½è¯´ä¸€ä¸‹I/Oå¤šè·¯å¤ç”¨å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_6-redisä¸ºä»€ä¹ˆæ—©æœŸé€‰æ‹©å•çº¿ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6. Redisä¸ºä»€ä¹ˆæ—©æœŸé€‰æ‹©å•çº¿ç¨‹ï¼Ÿ"><!---->6. Redisä¸ºä»€ä¹ˆæ—©æœŸé€‰æ‹©å•çº¿ç¨‹ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_7-redis6-0ä½¿ç”¨å¤šçº¿ç¨‹æ˜¯æ€ä¹ˆå›äº‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.Redis6.0ä½¿ç”¨å¤šçº¿ç¨‹æ˜¯æ€ä¹ˆå›äº‹?"><!---->7.Redis6.0ä½¿ç”¨å¤šçº¿ç¨‹æ˜¯æ€ä¹ˆå›äº‹?<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#æŒä¹…åŒ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æŒä¹…åŒ–"><!---->æŒä¹…åŒ–<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_8-redisæŒä¹…åŒ–æ–¹å¼æœ‰å“ªäº›-æœ‰ä»€ä¹ˆåŒºåˆ«" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.RedisæŒä¹…åŒ–â½…å¼æœ‰å“ªäº›ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><!---->8.RedisæŒä¹…åŒ–â½…å¼æœ‰å“ªäº›ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_9-rdb-å’Œ-aof-å„è‡ªæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="9.RDB å’Œ AOF å„è‡ªæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ"><!---->9.RDB å’Œ AOF å„è‡ªæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_10-rdbå’Œaofå¦‚ä½•é€‰æ‹©" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.RDBå’ŒAOFå¦‚ä½•é€‰æ‹©ï¼Ÿ"><!---->10.RDBå’ŒAOFå¦‚ä½•é€‰æ‹©ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_11-redisçš„æ•°æ®æ¢å¤" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="11.Redisçš„æ•°æ®æ¢å¤ï¼Ÿ"><!---->11.Redisçš„æ•°æ®æ¢å¤ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_12-redis-4-0-çš„æ··åˆæŒä¹…åŒ–äº†è§£å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="12.Redis 4.0 çš„æ··åˆæŒä¹…åŒ–äº†è§£å—ï¼Ÿ"><!---->12.Redis 4.0 çš„æ··åˆæŒä¹…åŒ–äº†è§£å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#é«˜å¯ç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é«˜å¯ç”¨"><!---->é«˜å¯ç”¨<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_13-ä¸»ä»å¤åˆ¶äº†è§£å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="13.ä¸»ä»å¤åˆ¶äº†è§£å—ï¼Ÿ"><!---->13.ä¸»ä»å¤åˆ¶äº†è§£å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_14-redisä¸»ä»æœ‰å‡ ç§å¸¸è§çš„æ‹“æ‰‘ç»“æ„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="14.Redisä¸»ä»æœ‰å‡ ç§å¸¸è§çš„æ‹“æ‰‘ç»“æ„ï¼Ÿ"><!---->14.Redisä¸»ä»æœ‰å‡ ç§å¸¸è§çš„æ‹“æ‰‘ç»“æ„ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_15-redisçš„ä¸»ä»å¤åˆ¶åŸç†äº†è§£å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="15.Redisçš„ä¸»ä»å¤åˆ¶åŸç†äº†è§£å—ï¼Ÿ"><!---->15.Redisçš„ä¸»ä»å¤åˆ¶åŸç†äº†è§£å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_16-è¯´è¯´ä¸»ä»æ•°æ®åŒæ­¥çš„æ–¹å¼" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="16.è¯´è¯´ä¸»ä»æ•°æ®åŒæ­¥çš„æ–¹å¼ï¼Ÿ"><!---->16.è¯´è¯´ä¸»ä»æ•°æ®åŒæ­¥çš„æ–¹å¼ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_17-ä¸»ä»å¤åˆ¶å­˜åœ¨å“ªäº›é—®é¢˜å‘¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="17.ä¸»ä»å¤åˆ¶å­˜åœ¨å“ªäº›é—®é¢˜å‘¢ï¼Ÿ"><!---->17.ä¸»ä»å¤åˆ¶å­˜åœ¨å“ªäº›é—®é¢˜å‘¢ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_18-redis-sentinel-å“¨å…µ-äº†è§£å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="18.Redis Sentinelï¼ˆå“¨å…µï¼‰äº†è§£å—ï¼Ÿ"><!---->18.Redis Sentinelï¼ˆå“¨å…µï¼‰äº†è§£å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_19-redis-sentinel-å“¨å…µ-å®ç°åŸç†çŸ¥é“å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="19.Redis Sentinelï¼ˆå“¨å…µï¼‰å®ç°åŸç†çŸ¥é“å—ï¼Ÿ"><!---->19.Redis Sentinelï¼ˆå“¨å…µï¼‰å®ç°åŸç†çŸ¥é“å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_20-é¢†å¯¼è€…sentinelèŠ‚ç‚¹é€‰ä¸¾äº†è§£å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="20.é¢†å¯¼è€…SentinelèŠ‚ç‚¹é€‰ä¸¾äº†è§£å—ï¼Ÿ"><!---->20.é¢†å¯¼è€…SentinelèŠ‚ç‚¹é€‰ä¸¾äº†è§£å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_21-æ–°çš„ä¸»èŠ‚ç‚¹æ˜¯æ€æ ·è¢«æŒ‘é€‰å‡ºæ¥çš„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="21.æ–°çš„ä¸»èŠ‚ç‚¹æ˜¯æ€æ ·è¢«æŒ‘é€‰å‡ºæ¥çš„ï¼Ÿ"><!---->21.æ–°çš„ä¸»èŠ‚ç‚¹æ˜¯æ€æ ·è¢«æŒ‘é€‰å‡ºæ¥çš„ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_22-redis-é›†ç¾¤äº†è§£å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="22.Redis é›†ç¾¤äº†è§£å—ï¼Ÿ"><!---->22.Redis é›†ç¾¤äº†è§£å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_23-é›†ç¾¤ä¸­æ•°æ®å¦‚ä½•åˆ†åŒº" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="23.é›†ç¾¤ä¸­æ•°æ®å¦‚ä½•åˆ†åŒºï¼Ÿ"><!---->23.é›†ç¾¤ä¸­æ•°æ®å¦‚ä½•åˆ†åŒºï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_24-èƒ½è¯´è¯´redisé›†ç¾¤çš„åŸç†å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="24.èƒ½è¯´è¯´Redisé›†ç¾¤çš„åŸç†å—ï¼Ÿ"><!---->24.èƒ½è¯´è¯´Redisé›†ç¾¤çš„åŸç†å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_25-è¯´è¯´é›†ç¾¤çš„ä¼¸ç¼©" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="25.è¯´è¯´é›†ç¾¤çš„ä¼¸ç¼©ï¼Ÿ"><!---->25.è¯´è¯´é›†ç¾¤çš„ä¼¸ç¼©ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#ç¼“å­˜è®¾è®¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç¼“å­˜è®¾è®¡"><!---->ç¼“å­˜è®¾è®¡<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_26-ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="26.ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©ï¼Ÿ"><!---->26.ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_27-èƒ½è¯´è¯´å¸ƒéš†è¿‡æ»¤å™¨å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="27.èƒ½è¯´è¯´å¸ƒéš†è¿‡æ»¤å™¨å—ï¼Ÿ"><!---->27.èƒ½è¯´è¯´å¸ƒéš†è¿‡æ»¤å™¨å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_28-å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®çš„ä¸€è‡´æ€§" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="28.å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®çš„â¼€è‡´æ€§ï¼Ÿ"><!---->28.å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®çš„â¼€è‡´æ€§ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_29-å¦‚ä½•ä¿è¯æœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜çš„ä¸€è‡´" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="29.å¦‚ä½•ä¿è¯æœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜çš„ä¸€è‡´ï¼Ÿ"><!---->29.å¦‚ä½•ä¿è¯æœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜çš„ä¸€è‡´ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_30-æ€ä¹ˆå¤„ç†çƒ­key" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="30.æ€ä¹ˆå¤„ç†çƒ­keyï¼Ÿ"><!---->30.æ€ä¹ˆå¤„ç†çƒ­keyï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_31-ç¼“å­˜é¢„çƒ­æ€ä¹ˆåšå‘¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="31.ç¼“å­˜é¢„çƒ­æ€ä¹ˆåšå‘¢ï¼Ÿ"><!---->31.ç¼“å­˜é¢„çƒ­æ€ä¹ˆåšå‘¢ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_32-çƒ­ç‚¹keyé‡å»º-é—®é¢˜-è§£å†³" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="32.çƒ­ç‚¹keyé‡å»ºï¼Ÿé—®é¢˜ï¼Ÿè§£å†³ï¼Ÿ"><!---->32.çƒ­ç‚¹keyé‡å»ºï¼Ÿé—®é¢˜ï¼Ÿè§£å†³ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_33-æ— åº•æ´é—®é¢˜å—-å¦‚ä½•è§£å†³" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="33.æ— åº•æ´é—®é¢˜å—ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ"><!---->33.æ— åº•æ´é—®é¢˜å—ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#redisè¿ç»´" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Redisè¿ç»´"><!---->Redisè¿ç»´<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_34-redisæŠ¥å†…å­˜ä¸è¶³æ€ä¹ˆå¤„ç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="34.RedisæŠ¥å†…å­˜ä¸è¶³æ€ä¹ˆå¤„ç†ï¼Ÿ"><!---->34.RedisæŠ¥å†…å­˜ä¸è¶³æ€ä¹ˆå¤„ç†ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_35-redisçš„è¿‡æœŸæ•°æ®å›æ”¶ç­–ç•¥æœ‰å“ªäº›" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="35.Redisçš„è¿‡æœŸæ•°æ®å›æ”¶ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ"><!---->35.Redisçš„è¿‡æœŸæ•°æ®å›æ”¶ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_36-redisæœ‰å“ªäº›å†…å­˜æº¢å‡ºæ§åˆ¶-å†…å­˜æ·˜æ±°ç­–ç•¥" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="36.Redisæœ‰å“ªäº›å†…å­˜æº¢å‡ºæ§åˆ¶/å†…å­˜æ·˜æ±°ç­–ç•¥ï¼Ÿ"><!---->36.Redisæœ‰å“ªäº›å†…å­˜æº¢å‡ºæ§åˆ¶/å†…å­˜æ·˜æ±°ç­–ç•¥ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_37-redisé˜»å¡-æ€ä¹ˆè§£å†³" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="37.Redisé˜»å¡ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ"><!---->37.Redisé˜»å¡ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_38-å¤§keyé—®é¢˜äº†è§£å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="38.å¤§keyé—®é¢˜äº†è§£å—ï¼Ÿ"><!---->38.å¤§keyé—®é¢˜äº†è§£å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_39-rediså¸¸è§æ€§èƒ½é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="39.Rediså¸¸è§æ€§èƒ½é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Ÿ"><!---->39.Rediså¸¸è§æ€§èƒ½é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#redisåº”ç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Redisåº”ç”¨"><!---->Redisåº”ç”¨<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_40-ä½¿ç”¨redis-å¦‚ä½•å®ç°å¼‚æ­¥é˜Ÿåˆ—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="40.ä½¿ç”¨Redis å¦‚ä½•å®ç°å¼‚æ­¥é˜Ÿåˆ—ï¼Ÿ"><!---->40.ä½¿ç”¨Redis å¦‚ä½•å®ç°å¼‚æ­¥é˜Ÿåˆ—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_41-redis-å¦‚ä½•å®ç°å»¶æ—¶é˜Ÿåˆ—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="41.Redis å¦‚ä½•å®ç°å»¶æ—¶é˜Ÿåˆ—?"><!---->41.Redis å¦‚ä½•å®ç°å»¶æ—¶é˜Ÿåˆ—?<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_42-redis-æ”¯æŒäº‹åŠ¡å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="42.Redis æ”¯æŒäº‹åŠ¡å—ï¼Ÿ"><!---->42.Redis æ”¯æŒäº‹åŠ¡å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_43-rediså’Œluaè„šæœ¬çš„ä½¿ç”¨äº†è§£å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="43.Rediså’ŒLuaè„šæœ¬çš„ä½¿ç”¨äº†è§£å—ï¼Ÿ"><!---->43.Rediså’ŒLuaè„šæœ¬çš„ä½¿ç”¨äº†è§£å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_44-redisçš„ç®¡é“äº†è§£å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="44.Redisçš„ç®¡é“äº†è§£å—ï¼Ÿ"><!---->44.Redisçš„ç®¡é“äº†è§£å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_45-rediså®ç°åˆ†å¸ƒå¼é”äº†è§£å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="45.Rediså®ç°åˆ†å¸ƒå¼é”äº†è§£å—ï¼Ÿ"><!---->45.Rediså®ç°åˆ†å¸ƒå¼é”äº†è§£å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#åº•å±‚ç»“æ„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åº•å±‚ç»“æ„"><!---->åº•å±‚ç»“æ„<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_46-è¯´è¯´redisåº•å±‚æ•°æ®ç»“æ„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="46.è¯´è¯´Redisåº•å±‚æ•°æ®ç»“æ„ï¼Ÿ"><!---->46.è¯´è¯´Redisåº•å±‚æ•°æ®ç»“æ„ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_47-redis-çš„-sds-å’Œ-c-ä¸­å­—ç¬¦ä¸²ç›¸æ¯”æœ‰ä»€ä¹ˆä¼˜åŠ¿" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="47.Redis çš„ SDS å’Œ C ä¸­å­—ç¬¦ä¸²ç›¸æ¯”æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ"><!---->47.Redis çš„ SDS å’Œ C ä¸­å­—ç¬¦ä¸²ç›¸æ¯”æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_48-å­—å…¸æ˜¯å¦‚ä½•å®ç°çš„-rehash-äº†è§£å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="48.å­—å…¸æ˜¯å¦‚ä½•å®ç°çš„ï¼ŸRehash äº†è§£å—ï¼Ÿ"><!---->48.å­—å…¸æ˜¯å¦‚ä½•å®ç°çš„ï¼ŸRehash äº†è§£å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_49-è·³è·ƒè¡¨æ˜¯å¦‚ä½•å®ç°çš„-åŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="49.è·³è·ƒè¡¨æ˜¯å¦‚ä½•å®ç°çš„ï¼ŸåŸç†ï¼Ÿ"><!---->49.è·³è·ƒè¡¨æ˜¯å¦‚ä½•å®ç°çš„ï¼ŸåŸç†ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_50-å‹ç¼©åˆ—è¡¨äº†è§£å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="50.å‹ç¼©åˆ—è¡¨äº†è§£å—ï¼Ÿ"><!---->50.å‹ç¼©åˆ—è¡¨äº†è§£å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_51-å¿«é€Ÿåˆ—è¡¨-quicklist-äº†è§£å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="51.å¿«é€Ÿåˆ—è¡¨ quicklist äº†è§£å—ï¼Ÿ"><!---->51.å¿«é€Ÿåˆ—è¡¨ quicklist äº†è§£å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#å…¶ä»–é—®é¢˜" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å…¶ä»–é—®é¢˜"><!---->å…¶ä»–é—®é¢˜<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/sidebar/sanfene/redis.html#_52-å‡å¦‚redisé‡Œé¢æœ‰1äº¿ä¸ªkey-å…¶ä¸­æœ‰10wä¸ªkeyæ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„-å¦‚ä½•å°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="52.å‡å¦‚Redisé‡Œé¢æœ‰1äº¿ä¸ªkeyï¼Œå…¶ä¸­æœ‰10wä¸ªkeyæ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„ï¼Œå¦‚ä½•å°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥ï¼Ÿ"><!---->52.å‡å¦‚Redisé‡Œé¢æœ‰1äº¿ä¸ªkeyï¼Œå…¶ä¸­æœ‰10wä¸ªkeyæ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„ï¼Œå¦‚ä½•å°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/sidebar/sanfene/mybatis.html" class="nav-link sidebar-link sidebar-page" aria-label="MyBatis"><!---->MyBatis<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->é¢æ¸£é€†è¢­ï¼ˆRedisï¼‰å¿…çœ‹ğŸ‘</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://tobebetterjavaer.com" target="_blank" rel="noopener noreferrer">æ²‰é»˜ç‹äºŒ</a></span><span property="author" content="æ²‰é»˜ç‹äºŒ"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022å¹´5æœˆ9æ—¥</span><meta property="datePublished" content="2022-05-09T06:49:16.000Z"></span><span class="category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><ul class="categories-wrapper"><li class="category category3" role>é¢æ¸£é€†è¢­</li><meta property="articleSection" content="é¢æ¸£é€†è¢­"></ul></span><span aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><ul class="tags-wrapper"><li class="tag tag3" role>Redis</li></ul><meta property="keywords" content="Redis"></span><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 71 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT71M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#åŸºç¡€" class="router-link-active router-link-exact-active toc-link level2">åŸºç¡€</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_1-è¯´è¯´ä»€ä¹ˆæ˜¯redis" class="router-link-active router-link-exact-active toc-link level3">1.è¯´è¯´ä»€ä¹ˆæ˜¯Redis?</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_2-rediså¯ä»¥ç”¨æ¥å¹²ä»€ä¹ˆ" class="router-link-active router-link-exact-active toc-link level3">2.Rediså¯ä»¥ç”¨æ¥å¹²ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_3-redis-æœ‰å“ªäº›æ•°æ®ç»“æ„" class="router-link-active router-link-exact-active toc-link level3">3.Redis æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_4-redisä¸ºä»€ä¹ˆå¿«å‘¢" class="router-link-active router-link-exact-active toc-link level3">4.Redisä¸ºä»€ä¹ˆå¿«å‘¢ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_5-èƒ½è¯´ä¸€ä¸‹i-oå¤šè·¯å¤ç”¨å—" class="router-link-active router-link-exact-active toc-link level3">5.èƒ½è¯´ä¸€ä¸‹I/Oå¤šè·¯å¤ç”¨å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_6-redisä¸ºä»€ä¹ˆæ—©æœŸé€‰æ‹©å•çº¿ç¨‹" class="router-link-active router-link-exact-active toc-link level3">6. Redisä¸ºä»€ä¹ˆæ—©æœŸé€‰æ‹©å•çº¿ç¨‹ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_7-redis6-0ä½¿ç”¨å¤šçº¿ç¨‹æ˜¯æ€ä¹ˆå›äº‹" class="router-link-active router-link-exact-active toc-link level3">7.Redis6.0ä½¿ç”¨å¤šçº¿ç¨‹æ˜¯æ€ä¹ˆå›äº‹?</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#æŒä¹…åŒ–" class="router-link-active router-link-exact-active toc-link level2">æŒä¹…åŒ–</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_8-redisæŒä¹…åŒ–æ–¹å¼æœ‰å“ªäº›-æœ‰ä»€ä¹ˆåŒºåˆ«" class="router-link-active router-link-exact-active toc-link level3">8.RedisæŒä¹…åŒ–â½…å¼æœ‰å“ªäº›ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_9-rdb-å’Œ-aof-å„è‡ªæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹" class="router-link-active router-link-exact-active toc-link level3">9.RDB å’Œ AOF å„è‡ªæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_10-rdbå’Œaofå¦‚ä½•é€‰æ‹©" class="router-link-active router-link-exact-active toc-link level3">10.RDBå’ŒAOFå¦‚ä½•é€‰æ‹©ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_11-redisçš„æ•°æ®æ¢å¤" class="router-link-active router-link-exact-active toc-link level3">11.Redisçš„æ•°æ®æ¢å¤ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_12-redis-4-0-çš„æ··åˆæŒä¹…åŒ–äº†è§£å—" class="router-link-active router-link-exact-active toc-link level3">12.Redis 4.0 çš„æ··åˆæŒä¹…åŒ–äº†è§£å—ï¼Ÿ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#é«˜å¯ç”¨" class="router-link-active router-link-exact-active toc-link level2">é«˜å¯ç”¨</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_13-ä¸»ä»å¤åˆ¶äº†è§£å—" class="router-link-active router-link-exact-active toc-link level3">13.ä¸»ä»å¤åˆ¶äº†è§£å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_14-redisä¸»ä»æœ‰å‡ ç§å¸¸è§çš„æ‹“æ‰‘ç»“æ„" class="router-link-active router-link-exact-active toc-link level3">14.Redisä¸»ä»æœ‰å‡ ç§å¸¸è§çš„æ‹“æ‰‘ç»“æ„ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_15-redisçš„ä¸»ä»å¤åˆ¶åŸç†äº†è§£å—" class="router-link-active router-link-exact-active toc-link level3">15.Redisçš„ä¸»ä»å¤åˆ¶åŸç†äº†è§£å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_16-è¯´è¯´ä¸»ä»æ•°æ®åŒæ­¥çš„æ–¹å¼" class="router-link-active router-link-exact-active toc-link level3">16.è¯´è¯´ä¸»ä»æ•°æ®åŒæ­¥çš„æ–¹å¼ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_17-ä¸»ä»å¤åˆ¶å­˜åœ¨å“ªäº›é—®é¢˜å‘¢" class="router-link-active router-link-exact-active toc-link level3">17.ä¸»ä»å¤åˆ¶å­˜åœ¨å“ªäº›é—®é¢˜å‘¢ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_18-redis-sentinel-å“¨å…µ-äº†è§£å—" class="router-link-active router-link-exact-active toc-link level3">18.Redis Sentinelï¼ˆå“¨å…µï¼‰äº†è§£å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_19-redis-sentinel-å“¨å…µ-å®ç°åŸç†çŸ¥é“å—" class="router-link-active router-link-exact-active toc-link level3">19.Redis Sentinelï¼ˆå“¨å…µï¼‰å®ç°åŸç†çŸ¥é“å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_20-é¢†å¯¼è€…sentinelèŠ‚ç‚¹é€‰ä¸¾äº†è§£å—" class="router-link-active router-link-exact-active toc-link level3">20.é¢†å¯¼è€…SentinelèŠ‚ç‚¹é€‰ä¸¾äº†è§£å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_21-æ–°çš„ä¸»èŠ‚ç‚¹æ˜¯æ€æ ·è¢«æŒ‘é€‰å‡ºæ¥çš„" class="router-link-active router-link-exact-active toc-link level3">21.æ–°çš„ä¸»èŠ‚ç‚¹æ˜¯æ€æ ·è¢«æŒ‘é€‰å‡ºæ¥çš„ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_22-redis-é›†ç¾¤äº†è§£å—" class="router-link-active router-link-exact-active toc-link level3">22.Redis é›†ç¾¤äº†è§£å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_23-é›†ç¾¤ä¸­æ•°æ®å¦‚ä½•åˆ†åŒº" class="router-link-active router-link-exact-active toc-link level3">23.é›†ç¾¤ä¸­æ•°æ®å¦‚ä½•åˆ†åŒºï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_24-èƒ½è¯´è¯´redisé›†ç¾¤çš„åŸç†å—" class="router-link-active router-link-exact-active toc-link level3">24.èƒ½è¯´è¯´Redisé›†ç¾¤çš„åŸç†å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_25-è¯´è¯´é›†ç¾¤çš„ä¼¸ç¼©" class="router-link-active router-link-exact-active toc-link level3">25.è¯´è¯´é›†ç¾¤çš„ä¼¸ç¼©ï¼Ÿ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#ç¼“å­˜è®¾è®¡" class="router-link-active router-link-exact-active toc-link level2">ç¼“å­˜è®¾è®¡</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_26-ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©" class="router-link-active router-link-exact-active toc-link level3">26.ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_27-èƒ½è¯´è¯´å¸ƒéš†è¿‡æ»¤å™¨å—" class="router-link-active router-link-exact-active toc-link level3">27.èƒ½è¯´è¯´å¸ƒéš†è¿‡æ»¤å™¨å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_28-å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®çš„ä¸€è‡´æ€§" class="router-link-active router-link-exact-active toc-link level3">28.å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®çš„â¼€è‡´æ€§ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_29-å¦‚ä½•ä¿è¯æœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜çš„ä¸€è‡´" class="router-link-active router-link-exact-active toc-link level3">29.å¦‚ä½•ä¿è¯æœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜çš„ä¸€è‡´ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_30-æ€ä¹ˆå¤„ç†çƒ­key" class="router-link-active router-link-exact-active toc-link level3">30.æ€ä¹ˆå¤„ç†çƒ­keyï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_31-ç¼“å­˜é¢„çƒ­æ€ä¹ˆåšå‘¢" class="router-link-active router-link-exact-active toc-link level3">31.ç¼“å­˜é¢„çƒ­æ€ä¹ˆåšå‘¢ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_32-çƒ­ç‚¹keyé‡å»º-é—®é¢˜-è§£å†³" class="router-link-active router-link-exact-active toc-link level3">32.çƒ­ç‚¹keyé‡å»ºï¼Ÿé—®é¢˜ï¼Ÿè§£å†³ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_33-æ— åº•æ´é—®é¢˜å—-å¦‚ä½•è§£å†³" class="router-link-active router-link-exact-active toc-link level3">33.æ— åº•æ´é—®é¢˜å—ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#redisè¿ç»´" class="router-link-active router-link-exact-active toc-link level2">Redisè¿ç»´</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_34-redisæŠ¥å†…å­˜ä¸è¶³æ€ä¹ˆå¤„ç†" class="router-link-active router-link-exact-active toc-link level3">34.RedisæŠ¥å†…å­˜ä¸è¶³æ€ä¹ˆå¤„ç†ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_35-redisçš„è¿‡æœŸæ•°æ®å›æ”¶ç­–ç•¥æœ‰å“ªäº›" class="router-link-active router-link-exact-active toc-link level3">35.Redisçš„è¿‡æœŸæ•°æ®å›æ”¶ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_36-redisæœ‰å“ªäº›å†…å­˜æº¢å‡ºæ§åˆ¶-å†…å­˜æ·˜æ±°ç­–ç•¥" class="router-link-active router-link-exact-active toc-link level3">36.Redisæœ‰å“ªäº›å†…å­˜æº¢å‡ºæ§åˆ¶/å†…å­˜æ·˜æ±°ç­–ç•¥ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_37-redisé˜»å¡-æ€ä¹ˆè§£å†³" class="router-link-active router-link-exact-active toc-link level3">37.Redisé˜»å¡ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_38-å¤§keyé—®é¢˜äº†è§£å—" class="router-link-active router-link-exact-active toc-link level3">38.å¤§keyé—®é¢˜äº†è§£å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_39-rediså¸¸è§æ€§èƒ½é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ" class="router-link-active router-link-exact-active toc-link level3">39.Rediså¸¸è§æ€§èƒ½é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Ÿ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#redisåº”ç”¨" class="router-link-active router-link-exact-active toc-link level2">Redisåº”ç”¨</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_40-ä½¿ç”¨redis-å¦‚ä½•å®ç°å¼‚æ­¥é˜Ÿåˆ—" class="router-link-active router-link-exact-active toc-link level3">40.ä½¿ç”¨Redis å¦‚ä½•å®ç°å¼‚æ­¥é˜Ÿåˆ—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_41-redis-å¦‚ä½•å®ç°å»¶æ—¶é˜Ÿåˆ—" class="router-link-active router-link-exact-active toc-link level3">41.Redis å¦‚ä½•å®ç°å»¶æ—¶é˜Ÿåˆ—?</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_42-redis-æ”¯æŒäº‹åŠ¡å—" class="router-link-active router-link-exact-active toc-link level3">42.Redis æ”¯æŒäº‹åŠ¡å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_43-rediså’Œluaè„šæœ¬çš„ä½¿ç”¨äº†è§£å—" class="router-link-active router-link-exact-active toc-link level3">43.Rediså’ŒLuaè„šæœ¬çš„ä½¿ç”¨äº†è§£å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_44-redisçš„ç®¡é“äº†è§£å—" class="router-link-active router-link-exact-active toc-link level3">44.Redisçš„ç®¡é“äº†è§£å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_45-rediså®ç°åˆ†å¸ƒå¼é”äº†è§£å—" class="router-link-active router-link-exact-active toc-link level3">45.Rediså®ç°åˆ†å¸ƒå¼é”äº†è§£å—ï¼Ÿ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#åº•å±‚ç»“æ„" class="router-link-active router-link-exact-active toc-link level2">åº•å±‚ç»“æ„</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_46-è¯´è¯´redisåº•å±‚æ•°æ®ç»“æ„" class="router-link-active router-link-exact-active toc-link level3">46.è¯´è¯´Redisåº•å±‚æ•°æ®ç»“æ„ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_47-redis-çš„-sds-å’Œ-c-ä¸­å­—ç¬¦ä¸²ç›¸æ¯”æœ‰ä»€ä¹ˆä¼˜åŠ¿" class="router-link-active router-link-exact-active toc-link level3">47.Redis çš„ SDS å’Œ C ä¸­å­—ç¬¦ä¸²ç›¸æ¯”æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_48-å­—å…¸æ˜¯å¦‚ä½•å®ç°çš„-rehash-äº†è§£å—" class="router-link-active router-link-exact-active toc-link level3">48.å­—å…¸æ˜¯å¦‚ä½•å®ç°çš„ï¼ŸRehash äº†è§£å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_49-è·³è·ƒè¡¨æ˜¯å¦‚ä½•å®ç°çš„-åŸç†" class="router-link-active router-link-exact-active toc-link level3">49.è·³è·ƒè¡¨æ˜¯å¦‚ä½•å®ç°çš„ï¼ŸåŸç†ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_50-å‹ç¼©åˆ—è¡¨äº†è§£å—" class="router-link-active router-link-exact-active toc-link level3">50.å‹ç¼©åˆ—è¡¨äº†è§£å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_51-å¿«é€Ÿåˆ—è¡¨-quicklist-äº†è§£å—" class="router-link-active router-link-exact-active toc-link level3">51.å¿«é€Ÿåˆ—è¡¨ quicklist äº†è§£å—ï¼Ÿ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#å…¶ä»–é—®é¢˜" class="router-link-active router-link-exact-active toc-link level2">å…¶ä»–é—®é¢˜</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/sidebar/sanfene/redis.html#_52-å‡å¦‚redisé‡Œé¢æœ‰1äº¿ä¸ªkey-å…¶ä¸­æœ‰10wä¸ªkeyæ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„-å¦‚ä½•å°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥" class="router-link-active router-link-exact-active toc-link level3">52.å‡å¦‚Redisé‡Œé¢æœ‰1äº¿ä¸ªkeyï¼Œå…¶ä¸­æœ‰10wä¸ªkeyæ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„ï¼Œå¦‚ä½•å°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥ï¼Ÿ</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="é¢æ¸£é€†è¢­-redis-å¿…çœ‹" tabindex="-1"><a class="header-anchor" href="#é¢æ¸£é€†è¢­-redis-å¿…çœ‹" aria-hidden="true">#</a> é¢æ¸£é€†è¢­ï¼ˆRedisï¼‰å¿…çœ‹ğŸ‘</h1><blockquote><p>å›¾æ–‡è¯¦è§£ 53 é“Redisé¢è¯•é«˜é¢‘é¢˜ï¼Œè¿™æ¬¡åŠæ‰“é¢è¯•å®˜ï¼Œæˆ‘è§‰å¾—ç¨³äº†ï¼ˆæ‰‹åŠ¨ dogï¼‰ã€‚æ•´ç†ï¼šæ²‰é»˜ç‹äºŒï¼Œæˆ³<a href="https://mp.weixin.qq.com/s/19u34NXALB1nOlBCE6Eg-Q" target="_blank" rel="noopener noreferrer">è½¬è½½é“¾æ¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œä½œè€…ï¼šä¸‰åˆ†æ¶ï¼Œæˆ³<a href="https://mp.weixin.qq.com/s/iJtNJYgirRugNBnzxkbB4Q" target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚</p></blockquote><h2 id="åŸºç¡€" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€" aria-hidden="true">#</a> åŸºç¡€</h2><h3 id="_1-è¯´è¯´ä»€ä¹ˆæ˜¯redis" tabindex="-1"><a class="header-anchor" href="#_1-è¯´è¯´ä»€ä¹ˆæ˜¯redis" aria-hidden="true">#</a> 1.è¯´è¯´ä»€ä¹ˆæ˜¯Redis?</h3><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-96e079f9-49a3-4c55-b0a4-47d043732b62.png" alt="Rediså›¾æ ‡"></p><p>Redisæ˜¯ä¸€ç§åŸºäºé”®å€¼å¯¹ï¼ˆkey-valueï¼‰çš„NoSQLæ•°æ®åº“ã€‚</p><p>æ¯”ä¸€èˆ¬é”®å€¼å¯¹æ•°æ®åº“å¼ºå¤§çš„åœ°æ–¹ï¼ŒRedisä¸­çš„valueæ”¯æŒstringï¼ˆå­—ç¬¦ä¸²ï¼‰ã€hashï¼ˆå“ˆå¸Œï¼‰ã€ listï¼ˆåˆ—è¡¨ï¼‰ã€setï¼ˆé›†åˆï¼‰ã€zsetï¼ˆæœ‰åºé›†åˆï¼‰ã€Bitmapsï¼ˆä½å›¾ï¼‰ã€ HyperLogLogã€GEOï¼ˆåœ°ç†ä¿¡æ¯å®šä½ï¼‰ç­‰å¤šç§æ•°æ®ç»“æ„ï¼Œå› æ­¤ Rediså¯ä»¥æ»¡è¶³å¾ˆå¤šçš„åº”ç”¨åœºæ™¯ã€‚</p><p>è€Œä¸”å› ä¸ºRedisä¼šå°†æ‰€æœ‰æ•°æ®éƒ½å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥å®ƒçš„è¯»å†™æ€§èƒ½éå¸¸å‡ºè‰²ã€‚</p><p>ä¸ä»…å¦‚æ­¤ï¼ŒRedisè¿˜å¯ä»¥å°†å†…å­˜çš„æ•°æ®åˆ©ç”¨å¿«ç…§å’Œæ—¥å¿—çš„å½¢å¼ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼Œè¿™æ ·åœ¨å‘ç”Ÿç±»ä¼¼æ–­ç”µæˆ–è€…æœºå™¨æ•…éšœçš„æ—¶å€™ï¼Œå†…å­˜ä¸­çš„æ•°æ®ä¸ä¼šâ€œä¸¢å¤±â€ã€‚</p><p>é™¤äº†ä¸Šè¿°åŠŸèƒ½ä»¥å¤–ï¼ŒRedisè¿˜æä¾›äº†é”®è¿‡æœŸã€å‘å¸ƒè®¢é˜…ã€äº‹åŠ¡ã€æµæ°´çº¿ã€Luaè„šæœ¬ç­‰é™„åŠ åŠŸèƒ½ã€‚</p><p>æ€»ä¹‹ï¼ŒRedisæ˜¯ä¸€æ¬¾å¼ºå¤§çš„æ€§èƒ½åˆ©å™¨ã€‚</p><h3 id="_2-rediså¯ä»¥ç”¨æ¥å¹²ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_2-rediså¯ä»¥ç”¨æ¥å¹²ä»€ä¹ˆ" aria-hidden="true">#</a> 2.Rediså¯ä»¥ç”¨æ¥å¹²ä»€ä¹ˆï¼Ÿ</h3><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-b02e44b3-3299-450f-b767-4a862b5ac8ff.png" alt="Redis"></p><ol><li><p>ç¼“å­˜</p><p>è¿™æ˜¯Redisåº”ç”¨æœ€å¹¿æ³›åœ°æ–¹ï¼ŒåŸºæœ¬æ‰€æœ‰çš„Webåº”ç”¨éƒ½ä¼šä½¿ç”¨Redisä½œä¸ºç¼“å­˜ï¼Œæ¥é™ä½æ•°æ®æºå‹åŠ›ï¼Œæé«˜å“åº”é€Ÿåº¦ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-d44c2397-5994-452f-8b7b-eb85d2b87685.png" alt="Redisç¼“å­˜"></p></li><li><p>è®¡æ•°å™¨ Rediså¤©ç„¶æ”¯æŒè®¡æ•°åŠŸèƒ½ï¼Œè€Œä¸”è®¡æ•°æ€§èƒ½éå¸¸å¥½ï¼Œå¯ä»¥ç”¨æ¥è®°å½•æµè§ˆé‡ã€ç‚¹èµé‡ç­‰ç­‰ã€‚</p></li><li><p>æ’è¡Œæ¦œ Redisæä¾›äº†åˆ—è¡¨å’Œæœ‰åºé›†åˆæ•°æ®ç»“æ„ï¼Œåˆç†åœ°ä½¿ç”¨è¿™äº›æ•°æ®ç»“æ„å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ„å»ºå„ç§æ’è¡Œæ¦œç³»ç»Ÿã€‚</p></li><li><p>ç¤¾äº¤ç½‘ç»œ èµ/è¸©ã€ç²‰ä¸ã€å…±åŒå¥½å‹/å–œå¥½ã€æ¨é€ã€ä¸‹æ‹‰åˆ·æ–°ã€‚</p></li><li><p>æ¶ˆæ¯é˜Ÿåˆ— Redisæä¾›äº†å‘å¸ƒè®¢é˜…åŠŸèƒ½å’Œé˜»å¡é˜Ÿåˆ—çš„åŠŸèƒ½ï¼Œå¯ä»¥æ»¡è¶³ä¸€èˆ¬æ¶ˆæ¯é˜Ÿåˆ—åŠŸèƒ½ã€‚</p></li><li><p>åˆ†å¸ƒå¼é” åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œåˆ©ç”¨Rediså®ç°åˆ†å¸ƒå¼é”ï¼Œä¹Ÿæ˜¯Rediså¸¸è§çš„åº”ç”¨ã€‚</p></li></ol><p>Redisçš„åº”ç”¨ä¸€èˆ¬ä¼šç»“åˆé¡¹ç›®å»é—®ï¼Œä»¥ä¸€ä¸ªç”µå•†é¡¹ç›®çš„ç”¨æˆ·æœåŠ¡ä¸ºä¾‹ï¼š</p><ul><li>Tokenå­˜å‚¨ï¼šç”¨æˆ·ç™»å½•æˆåŠŸä¹‹åï¼Œä½¿ç”¨Rediså­˜å‚¨Token</li><li>ç™»å½•å¤±è´¥æ¬¡æ•°è®¡æ•°ï¼šä½¿ç”¨Redisè®¡æ•°ï¼Œç™»å½•å¤±è´¥è¶…è¿‡ä¸€å®šæ¬¡æ•°ï¼Œé”å®šè´¦å·</li><li>åœ°å€ç¼“å­˜ï¼šå¯¹çœå¸‚åŒºæ•°æ®çš„ç¼“å­˜</li><li>åˆ†å¸ƒå¼é”ï¼šåˆ†å¸ƒå¼ç¯å¢ƒä¸‹ç™»å½•ã€æ³¨å†Œç­‰æ“ä½œåŠ åˆ†å¸ƒå¼é”</li><li>â€¦â€¦</li></ul><h3 id="_3-redis-æœ‰å“ªäº›æ•°æ®ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_3-redis-æœ‰å“ªäº›æ•°æ®ç»“æ„" aria-hidden="true">#</a> 3.Redis æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Ÿ</h3><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-10434dc7-c7a3-4c1a-b484-de3fb37669ee.png" alt="RedisåŸºæœ¬æ•°æ®ç»“æ„"> Redisæœ‰äº”ç§åŸºæœ¬æ•°æ®ç»“æ„ã€‚</p><p><strong>string</strong></p><p>å­—ç¬¦ä¸²æœ€åŸºç¡€çš„æ•°æ®ç»“æ„ã€‚å­—ç¬¦ä¸²ç±»å‹çš„å€¼å®é™…å¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼ˆç®€å•çš„å­—ç¬¦ä¸²ã€å¤æ‚çš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚JSONã€XMLï¼‰ï¼‰ã€æ•°å­— ï¼ˆæ•´æ•°ã€æµ®ç‚¹æ•°ï¼‰ï¼Œç”šè‡³æ˜¯äºŒè¿›åˆ¶ï¼ˆå›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ï¼‰ï¼Œä½†æ˜¯å€¼æœ€å¤§ä¸èƒ½è¶…è¿‡512MBã€‚</p><p>å­—ç¬¦ä¸²ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªå…¸å‹ä½¿ç”¨åœºæ™¯ï¼š</p><ul><li>ç¼“å­˜åŠŸèƒ½</li><li>è®¡æ•°</li><li>å…±äº«Session</li><li>é™é€Ÿ</li></ul><p><strong>hash</strong></p><p>å“ˆå¸Œç±»å‹æ˜¯æŒ‡é”®å€¼æœ¬èº«åˆæ˜¯ä¸€ä¸ªé”®å€¼å¯¹ç»“æ„ã€‚</p><p>å“ˆå¸Œä¸»è¦æœ‰ä»¥ä¸‹å…¸å‹åº”ç”¨åœºæ™¯ï¼š</p><ul><li>ç¼“å­˜ç”¨æˆ·ä¿¡æ¯</li><li>ç¼“å­˜å¯¹è±¡</li></ul><p><strong>list</strong></p><p>åˆ—è¡¨ï¼ˆlistï¼‰ç±»å‹æ˜¯ç”¨æ¥å­˜å‚¨å¤šä¸ªæœ‰åºçš„å­—ç¬¦ä¸²ã€‚åˆ—è¡¨æ˜¯ä¸€ç§æ¯”è¾ƒçµæ´»çš„æ•°æ®ç»“æ„ï¼Œå®ƒå¯ä»¥å……å½“æ ˆå’Œé˜Ÿåˆ—çš„è§’è‰²</p><p>åˆ—è¡¨ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ä½¿ç”¨åœºæ™¯ï¼š</p><ul><li>æ¶ˆæ¯é˜Ÿåˆ—</li><li>æ–‡ç« åˆ—è¡¨</li></ul><p><strong>set</strong></p><p>é›†åˆï¼ˆsetï¼‰ç±»å‹ä¹Ÿæ˜¯ç”¨æ¥ä¿å­˜å¤šä¸ªçš„å­—ç¬¦ä¸²å…ƒç´ ï¼Œä½†å’Œåˆ—è¡¨ç±»å‹ä¸ä¸€ æ ·çš„æ˜¯ï¼Œé›†åˆä¸­ä¸å…è®¸æœ‰é‡å¤å…ƒç´ ï¼Œå¹¶ä¸”é›†åˆä¸­çš„å…ƒç´ æ˜¯æ— åºçš„ã€‚</p><p>é›†åˆä¸»è¦æœ‰å¦‚ä¸‹ä½¿ç”¨åœºæ™¯ï¼š</p><ul><li>æ ‡ç­¾ï¼ˆtagï¼‰</li><li>å…±åŒå…³æ³¨</li></ul><p><strong>sorted set</strong></p><p>æœ‰åºé›†åˆä¸­çš„å…ƒç´ å¯ä»¥æ’åºã€‚ä½†æ˜¯å®ƒå’Œåˆ—è¡¨ä½¿ç”¨ç´¢å¼•ä¸‹æ ‡ä½œä¸ºæ’åºä¾æ®ä¸åŒçš„æ˜¯ï¼Œå®ƒç»™æ¯ä¸ªå…ƒç´ è®¾ç½®ä¸€ä¸ªæƒé‡ï¼ˆscoreï¼‰ä½œä¸ºæ’åºçš„ä¾æ®ã€‚</p><p>æœ‰åºé›†åˆä¸»è¦åº”ç”¨åœºæ™¯ï¼š</p><ul><li>ç”¨æˆ·ç‚¹èµç»Ÿè®¡</li><li>ç”¨æˆ·æ’åº</li></ul><h3 id="_4-redisä¸ºä»€ä¹ˆå¿«å‘¢" tabindex="-1"><a class="header-anchor" href="#_4-redisä¸ºä»€ä¹ˆå¿«å‘¢" aria-hidden="true">#</a> 4.Redisä¸ºä»€ä¹ˆå¿«å‘¢ï¼Ÿ</h3><p>Redisçš„é€Ÿåº¦â¾®å¸¸çš„å¿«ï¼Œå•æœºçš„Rediså°±å¯ä»¥â½€æ’‘æ¯ç§’åå‡ ä¸‡çš„å¹¶å‘ï¼Œç›¸å¯¹äºMySQLæ¥è¯´ï¼Œæ€§èƒ½æ˜¯MySQLçš„â¼â¼—å€ã€‚é€Ÿåº¦å¿«çš„åŸå› ä¸»è¦æœ‰â¼ç‚¹ï¼š</p><ol><li><strong>å®Œå…¨åŸºäºå†…å­˜æ“ä½œ</strong></li><li>ä½¿â½¤å•çº¿ç¨‹ï¼Œé¿å…äº†çº¿ç¨‹åˆ‡æ¢å’Œç«æ€äº§ç”Ÿçš„æ¶ˆè€—</li><li>åŸºäºâ¾®é˜»å¡çš„IOå¤šè·¯å¤â½¤æœºåˆ¶</li><li>Cè¯­â¾”å®ç°ï¼Œä¼˜åŒ–è¿‡çš„æ•°æ®ç»“æ„ï¼ŒåŸºäºâ¼ç§åŸºç¡€çš„æ•°æ®ç»“æ„ï¼Œredisåšäº†â¼¤é‡çš„ä¼˜åŒ–ï¼Œæ€§èƒ½æâ¾¼ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-e05bca61-4600-495c-b92a-25ac822e034e.png" alt="Redisä½¿ç”¨IOå¤šè·¯å¤ç”¨å’Œè‡ªèº«äº‹ä»¶æ¨¡å‹"></li></ol><h3 id="_5-èƒ½è¯´ä¸€ä¸‹i-oå¤šè·¯å¤ç”¨å—" tabindex="-1"><a class="header-anchor" href="#_5-èƒ½è¯´ä¸€ä¸‹i-oå¤šè·¯å¤ç”¨å—" aria-hidden="true">#</a> 5.èƒ½è¯´ä¸€ä¸‹I/Oå¤šè·¯å¤ç”¨å—ï¼Ÿ</h3><p>å¼•ç”¨çŸ¥ä¹ä¸Šä¸€ä¸ªé«˜èµçš„å›ç­”æ¥è§£é‡Šä»€ä¹ˆæ˜¯I/Oå¤šè·¯å¤ç”¨ã€‚å‡è®¾ä½ æ˜¯ä¸€ä¸ªè€å¸ˆï¼Œè®©30ä¸ªå­¦ç”Ÿè§£ç­”ä¸€é“é¢˜ç›®ï¼Œç„¶åæ£€æŸ¥å­¦ç”Ÿåšçš„æ˜¯å¦æ­£ç¡®ï¼Œä½ æœ‰ä¸‹é¢å‡ ä¸ªé€‰æ‹©ï¼š</p><ul><li><p>ç¬¬ä¸€ç§é€‰æ‹©ï¼šæŒ‰é¡ºåºé€ä¸ªæ£€æŸ¥ï¼Œå…ˆæ£€æŸ¥Aï¼Œç„¶åæ˜¯Bï¼Œä¹‹åæ˜¯Cã€Dã€‚ã€‚ã€‚è¿™ä¸­é—´å¦‚æœæœ‰ä¸€ä¸ªå­¦ç”Ÿå¡ä½ï¼Œå…¨ç­éƒ½ä¼šè¢«è€½è¯¯ã€‚è¿™ç§æ¨¡å¼å°±å¥½æ¯”ï¼Œä½ ç”¨å¾ªç¯æŒ¨ä¸ªå¤„ç†socketï¼Œæ ¹æœ¬ä¸å…·æœ‰å¹¶å‘èƒ½åŠ›ã€‚</p></li><li><p>ç¬¬äºŒç§é€‰æ‹©ï¼šä½ åˆ›å»º30ä¸ªåˆ†èº«ï¼Œæ¯ä¸ªåˆ†èº«æ£€æŸ¥ä¸€ä¸ªå­¦ç”Ÿçš„ç­”æ¡ˆæ˜¯å¦æ­£ç¡®ã€‚ è¿™ç§ç±»ä¼¼äºä¸ºæ¯ä¸€ä¸ªç”¨æˆ·åˆ›å»ºä¸€ä¸ªè¿›ç¨‹æˆ–è€…- çº¿ç¨‹å¤„ç†è¿æ¥ã€‚</p></li><li><p>ç¬¬ä¸‰ç§é€‰æ‹©ï¼Œä½ ç«™åœ¨è®²å°ä¸Šç­‰ï¼Œè°è§£ç­”å®Œè°ä¸¾æ‰‹ã€‚è¿™æ—¶Cã€Dä¸¾æ‰‹ï¼Œè¡¨ç¤ºä»–ä»¬è§£ç­”é—®é¢˜å®Œæ¯•ï¼Œä½ ä¸‹å»ä¾æ¬¡æ£€æŸ¥Cã€Dçš„ç­”æ¡ˆï¼Œç„¶åç»§ç»­å›åˆ°è®²å°ä¸Šç­‰ã€‚æ­¤æ—¶Eã€Aåˆä¸¾æ‰‹ï¼Œç„¶åå»å¤„ç†Eå’ŒAã€‚</p></li></ul><p>ç¬¬ä¸€ç§å°±æ˜¯é˜»å¡IOæ¨¡å‹ï¼Œç¬¬ä¸‰ç§å°±æ˜¯I/Oå¤ç”¨æ¨¡å‹ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-eb541432-d68a-4dd9-b427-96c4dd607d64.png" alt="å¤šè·¯å¤ç”¨æ¨¡å‹"></p><p>Linuxç³»ç»Ÿæœ‰ä¸‰ç§æ–¹å¼å®ç°IOå¤šè·¯å¤ç”¨ï¼šselectã€pollå’Œepollã€‚</p><p>ä¾‹å¦‚epollæ–¹å¼æ˜¯å°†ç”¨æˆ·socketå¯¹åº”çš„fdæ³¨å†Œè¿›epollï¼Œç„¶åepollå¸®ä½ ç›‘å¬å“ªäº›socketä¸Šæœ‰æ¶ˆæ¯åˆ°è¾¾ï¼Œè¿™æ ·å°±é¿å…äº†å¤§é‡çš„æ— ç”¨æ“ä½œã€‚æ­¤æ—¶çš„socketåº”è¯¥é‡‡ç”¨éé˜»å¡æ¨¡å¼ã€‚</p><p>è¿™æ ·ï¼Œæ•´ä¸ªè¿‡ç¨‹åªåœ¨è¿›è¡Œselectã€pollã€epollè¿™äº›è°ƒç”¨çš„æ—¶å€™æ‰ä¼šé˜»å¡ï¼Œæ”¶å‘å®¢æˆ·æ¶ˆæ¯æ˜¯ä¸ä¼šé˜»å¡çš„ï¼Œæ•´ä¸ªè¿›ç¨‹æˆ–è€…çº¿ç¨‹å°±è¢«å……åˆ†åˆ©ç”¨èµ·æ¥ï¼Œè¿™å°±æ˜¯äº‹ä»¶é©±åŠ¨ï¼Œæ‰€è°“çš„reactoræ¨¡å¼ã€‚</p><h3 id="_6-redisä¸ºä»€ä¹ˆæ—©æœŸé€‰æ‹©å•çº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#_6-redisä¸ºä»€ä¹ˆæ—©æœŸé€‰æ‹©å•çº¿ç¨‹" aria-hidden="true">#</a> 6. Redisä¸ºä»€ä¹ˆæ—©æœŸé€‰æ‹©å•çº¿ç¨‹ï¼Ÿ</h3><p>å®˜æ–¹è§£é‡Šï¼šhttps://redis.io/topics/faq</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-344b8461-98d4-495b-a697-70275b0abad6.png" alt="å®˜æ–¹å•çº¿ç¨‹è§£é‡Š"> å®˜æ–¹FAQè¡¨ç¤ºï¼Œå› ä¸ºRedisæ˜¯åŸºäºå†…å­˜çš„æ“ä½œï¼ŒCPUæˆä¸ºRedisçš„ç“¶é¢ˆçš„æƒ…å†µå¾ˆå°‘è§ï¼ŒRedisçš„ç“¶é¢ˆæœ€æœ‰å¯èƒ½æ˜¯å†…å­˜çš„å¤§å°æˆ–è€…ç½‘ç»œé™åˆ¶ã€‚</p><p>å¦‚æœæƒ³è¦æœ€å¤§ç¨‹åº¦åˆ©ç”¨CPUï¼Œå¯ä»¥åœ¨ä¸€å°æœºå™¨ä¸Šå¯åŠ¨å¤šä¸ªRediså®ä¾‹ã€‚</p><p>PSï¼šç½‘ä¸Šæœ‰è¿™æ ·çš„å›ç­”ï¼Œåæ§½å®˜æ–¹çš„è§£é‡Šæœ‰äº›æ•·è¡ï¼Œå…¶å®å°±æ˜¯å†å²åŸå› ï¼Œå¼€å‘è€…å«Œå¤šçº¿ç¨‹éº»çƒ¦ï¼Œåæ¥è¿™ä¸ªCPUçš„åˆ©ç”¨é—®é¢˜å°±è¢«æŠ›ç»™äº†ä½¿ç”¨è€…ã€‚</p><p>åŒæ—¶FAQé‡Œè¿˜æåˆ°äº†ï¼Œ Redis 4.0 ä¹‹åå¼€å§‹å˜æˆå¤šçº¿ç¨‹ï¼Œé™¤äº†ä¸»çº¿ç¨‹å¤–ï¼Œå®ƒä¹Ÿæœ‰åå°çº¿ç¨‹åœ¨å¤„ç†ä¸€äº›è¾ƒä¸ºç¼“æ…¢çš„æ“ä½œï¼Œä¾‹å¦‚æ¸…ç†è„æ•°æ®ã€æ— ç”¨è¿æ¥çš„é‡Šæ”¾ã€å¤§ Key çš„åˆ é™¤ç­‰ç­‰ã€‚</p><h3 id="_7-redis6-0ä½¿ç”¨å¤šçº¿ç¨‹æ˜¯æ€ä¹ˆå›äº‹" tabindex="-1"><a class="header-anchor" href="#_7-redis6-0ä½¿ç”¨å¤šçº¿ç¨‹æ˜¯æ€ä¹ˆå›äº‹" aria-hidden="true">#</a> 7.Redis6.0ä½¿ç”¨å¤šçº¿ç¨‹æ˜¯æ€ä¹ˆå›äº‹?</h3><p>Redisä¸æ˜¯è¯´ç”¨å•çº¿ç¨‹çš„å—ï¼Ÿæ€ä¹ˆ6.0æˆäº†å¤šçº¿ç¨‹çš„ï¼Ÿ</p><p>Redis6.0çš„å¤šçº¿ç¨‹æ˜¯ç”¨å¤šçº¿ç¨‹æ¥å¤„ç†æ•°æ®çš„<strong>è¯»å†™å’Œåè®®è§£æ</strong>ï¼Œä½†æ˜¯Redis<strong>æ‰§è¡Œå‘½ä»¤</strong>è¿˜æ˜¯å•çº¿ç¨‹çš„ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-b7b24e25-d2dc-4457-994f-95bdb3674b8e.png" alt="Redis6.0å¤šçº¿ç¨‹"> è¿™æ ·åšçš„â½¬çš„æ˜¯å› ä¸ºRedisçš„æ€§èƒ½ç“¶é¢ˆåœ¨äºâ½¹ç»œIOâ½½â¾®CPUï¼Œä½¿â½¤å¤šçº¿ç¨‹èƒ½æå‡IOè¯»å†™çš„æ•ˆç‡ï¼Œä»â½½æ•´ä½“æâ¾¼Redisçš„æ€§èƒ½ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/xingbiaogongzhonghao.png" alt=""></p><h2 id="æŒä¹…åŒ–" tabindex="-1"><a class="header-anchor" href="#æŒä¹…åŒ–" aria-hidden="true">#</a> æŒä¹…åŒ–</h2><h3 id="_8-redisæŒä¹…åŒ–æ–¹å¼æœ‰å“ªäº›-æœ‰ä»€ä¹ˆåŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#_8-redisæŒä¹…åŒ–æ–¹å¼æœ‰å“ªäº›-æœ‰ä»€ä¹ˆåŒºåˆ«" aria-hidden="true">#</a> 8.RedisæŒä¹…åŒ–â½…å¼æœ‰å“ªäº›ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>RedisæŒä¹…åŒ–â½…æ¡ˆåˆ†ä¸ºRDBå’ŒAOFä¸¤ç§ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-3bda4a46-adc3-4f0d-a135-b8ae5d4c0d5d.png" alt="RedisæŒä¹…åŒ–ä¸¤ç§æ–¹å¼"></p><p><strong>RDB</strong></p><p>RDBæŒä¹…åŒ–æ˜¯æŠŠå½“å‰è¿›ç¨‹æ•°æ®ç”Ÿæˆ<strong>å¿«ç…§</strong>ä¿å­˜åˆ°ç¡¬ç›˜çš„è¿‡ç¨‹ï¼Œè§¦å‘RDBæŒä¹…åŒ–è¿‡ç¨‹åˆ†ä¸ºæ‰‹åŠ¨è§¦å‘å’Œè‡ªåŠ¨è§¦å‘ã€‚</p><p>RDBâ½‚ä»¶æ˜¯â¼€ä¸ªå‹ç¼©çš„â¼†è¿›åˆ¶â½‚ä»¶ï¼Œé€šè¿‡å®ƒå¯ä»¥è¿˜åŸæŸä¸ªæ—¶åˆ»æ•°æ®åº“çš„çŠ¶æ€ã€‚ç”±äºRDBâ½‚ä»¶æ˜¯ä¿å­˜åœ¨ç¡¬ç›˜ä¸Šçš„ï¼Œæ‰€ä»¥å³ä½¿Rediså´©æºƒæˆ–è€…é€€å‡ºï¼Œåªè¦RDBâ½‚ä»¶å­˜åœ¨ï¼Œå°±å¯ä»¥â½¤å®ƒæ¥æ¢å¤è¿˜åŸæ•°æ®åº“çš„çŠ¶æ€ã€‚</p><p>æ‰‹åŠ¨è§¦å‘åˆ†åˆ«å¯¹åº”saveå’Œbgsaveå‘½ä»¤: <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-ffe56e32-34c5-453d-8859-c2febbe6a038.png" alt="saveå’Œbgsave"></p><ul><li><p>saveå‘½ä»¤ï¼šé˜»å¡å½“å‰RedisæœåŠ¡å™¨ï¼Œç›´åˆ°RDBè¿‡ç¨‹å®Œæˆä¸ºæ­¢ï¼Œå¯¹äºå†…å­˜æ¯”è¾ƒå¤§çš„å®ä¾‹ä¼šé€ æˆé•¿æ—¶é—´é˜»å¡ï¼Œçº¿ä¸Šç¯å¢ƒä¸å»ºè®®ä½¿ç”¨ã€‚</p></li><li><p>bgsaveå‘½ä»¤ï¼šRedisè¿›ç¨‹æ‰§è¡Œforkæ“ä½œåˆ›å»ºå­è¿›ç¨‹ï¼ŒRDBæŒä¹…åŒ–è¿‡ç¨‹ç”±å­è¿›ç¨‹è´Ÿè´£ï¼Œå®Œæˆåè‡ªåŠ¨ç»“æŸã€‚é˜»å¡åªå‘ç”Ÿåœ¨forké˜¶æ®µï¼Œä¸€èˆ¬æ—¶é—´å¾ˆçŸ­ã€‚</p></li></ul><p>ä»¥ä¸‹åœºæ™¯ä¼šè‡ªåŠ¨è§¦å‘RDBæŒä¹…åŒ–ï¼š</p><ul><li>ä½¿ç”¨saveç›¸å…³é…ç½®ï¼Œå¦‚â€œsave m nâ€ã€‚è¡¨ç¤ºmç§’å†…æ•°æ®é›†å­˜åœ¨næ¬¡ä¿®æ”¹æ—¶ï¼Œè‡ªåŠ¨è§¦å‘bgsaveã€‚</li><li>å¦‚æœä»èŠ‚ç‚¹æ‰§è¡Œå…¨é‡å¤åˆ¶æ“ä½œï¼Œä¸»èŠ‚ç‚¹è‡ªåŠ¨æ‰§è¡Œbgsaveç”ŸæˆRDBæ–‡ä»¶å¹¶å‘é€ç»™ä»èŠ‚ç‚¹</li><li>æ‰§è¡Œdebug reloadå‘½ä»¤é‡æ–°åŠ è½½Redisæ—¶ï¼Œä¹Ÿä¼šè‡ªåŠ¨è§¦å‘saveæ“ä½œ</li><li>é»˜è®¤æƒ…å†µä¸‹æ‰§è¡Œshutdownå‘½ä»¤æ—¶ï¼Œå¦‚æœæ²¡æœ‰å¼€å¯AOFæŒä¹…åŒ–åŠŸèƒ½åˆ™è‡ªåŠ¨æ‰§è¡Œbgsaveã€‚</li></ul><p><strong>AOF</strong></p><p>AOFï¼ˆappend only fileï¼‰æŒä¹…åŒ–ï¼šä»¥ç‹¬ç«‹æ—¥å¿—çš„æ–¹å¼è®°å½•æ¯æ¬¡å†™å‘½ä»¤ï¼Œ é‡å¯æ—¶å†é‡æ–°æ‰§è¡ŒAOFæ–‡ä»¶ä¸­çš„å‘½ä»¤è¾¾åˆ°æ¢å¤æ•°æ®çš„ç›®çš„ã€‚AOFçš„ä¸»è¦ä½œç”¨æ˜¯è§£å†³äº†æ•°æ®æŒä¹…åŒ–çš„å®æ—¶æ€§ï¼Œç›®å‰å·²ç»æ˜¯RedisæŒä¹…åŒ–çš„ä¸»æµæ–¹å¼ã€‚</p><p>AOFçš„å·¥ä½œæµç¨‹æ“ä½œï¼šå‘½ä»¤å†™å…¥ ï¼ˆappendï¼‰ã€æ–‡ä»¶åŒæ­¥ï¼ˆsyncï¼‰ã€æ–‡ä»¶é‡å†™ï¼ˆrewriteï¼‰ã€é‡å¯åŠ è½½ ï¼ˆloadï¼‰ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-a9fb6202-b1a1-484d-a4fa-fef519090b44.png" alt="AOFå·¥ä½œæµç¨‹">æµç¨‹å¦‚ä¸‹ï¼š</p><p>1ï¼‰æ‰€æœ‰çš„å†™å…¥å‘½ä»¤ä¼šè¿½åŠ åˆ°aof_bufï¼ˆç¼“å†²åŒºï¼‰ä¸­ã€‚</p><p>2ï¼‰AOFç¼“å†²åŒºæ ¹æ®å¯¹åº”çš„ç­–ç•¥å‘ç¡¬ç›˜åšåŒæ­¥æ“ä½œã€‚</p><p>3ï¼‰éšç€AOFæ–‡ä»¶è¶Šæ¥è¶Šå¤§ï¼Œéœ€è¦å®šæœŸå¯¹AOFæ–‡ä»¶è¿›è¡Œé‡å†™ï¼Œè¾¾åˆ°å‹ç¼© çš„ç›®çš„ã€‚</p><p>4ï¼‰å½“RedisæœåŠ¡å™¨é‡å¯æ—¶ï¼Œå¯ä»¥åŠ è½½AOFæ–‡ä»¶è¿›è¡Œæ•°æ®æ¢å¤ã€‚</p><h3 id="_9-rdb-å’Œ-aof-å„è‡ªæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹" tabindex="-1"><a class="header-anchor" href="#_9-rdb-å’Œ-aof-å„è‡ªæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹" aria-hidden="true">#</a> 9.RDB å’Œ AOF å„è‡ªæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</h3><p><strong>RDB | ä¼˜ç‚¹</strong></p><ol><li>åªæœ‰ä¸€ä¸ªç´§å‡‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ <code>dump.rdb</code>ï¼Œéå¸¸é€‚åˆå¤‡ä»½ã€å…¨é‡å¤åˆ¶çš„åœºæ™¯ã€‚</li><li><strong>å®¹ç¾æ€§å¥½</strong>ï¼Œå¯ä»¥æŠŠRDBæ–‡ä»¶æ‹·è´é“è¿œç¨‹æœºå™¨æˆ–è€…æ–‡ä»¶ç³»ç»Ÿå¼ ï¼Œç”¨äºå®¹ç¾æ¢å¤ã€‚</li><li><strong>æ¢å¤é€Ÿåº¦å¿«</strong>ï¼ŒRDBæ¢å¤æ•°æ®çš„é€Ÿåº¦è¿œè¿œå¿«äºAOFçš„æ–¹å¼</li></ol><p><strong>RDB | ç¼ºç‚¹</strong></p><ol><li><strong>å®æ—¶æ€§ä½</strong>ï¼ŒRDB æ˜¯é—´éš”ä¸€æ®µæ—¶é—´è¿›è¡ŒæŒä¹…åŒ–ï¼Œæ²¡æ³•åšåˆ°å®æ—¶æŒä¹…åŒ–/ç§’çº§æŒä¹…åŒ–ã€‚å¦‚æœåœ¨è¿™ä¸€é—´éš”äº‹ä»¶å‘ç”Ÿæ•…éšœï¼Œæ•°æ®ä¼šä¸¢å¤±ã€‚</li><li><strong>å­˜åœ¨å…¼å®¹é—®é¢˜</strong>ï¼ŒRedisæ¼”è¿›è¿‡ç¨‹å­˜åœ¨å¤šä¸ªæ ¼å¼çš„RDBç‰ˆæœ¬ï¼Œå­˜åœ¨è€ç‰ˆæœ¬Redisæ— æ³•å…¼å®¹æ–°ç‰ˆæœ¬RDBçš„é—®é¢˜ã€‚</li></ol><p><strong>AOF | ä¼˜ç‚¹</strong></p><ol><li><strong>å®æ—¶æ€§å¥½</strong>ï¼Œaof æŒä¹…åŒ–å¯ä»¥é…ç½® <code>appendfsync</code> å±æ€§ï¼Œæœ‰ <code>always</code>ï¼Œæ¯è¿›è¡Œä¸€æ¬¡å‘½ä»¤æ“ä½œå°±è®°å½•åˆ° aof æ–‡ä»¶ä¸­ä¸€æ¬¡ã€‚</li><li>é€šè¿‡ append æ¨¡å¼å†™æ–‡ä»¶ï¼Œå³ä½¿ä¸­é€”æœåŠ¡å™¨å®•æœºï¼Œå¯ä»¥é€šè¿‡ redis-check-aof å·¥å…·è§£å†³æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚</li></ol><p><strong>AOF | ç¼ºç‚¹</strong></p><ol><li>AOF æ–‡ä»¶æ¯” RDB <strong>æ–‡ä»¶å¤§</strong>ï¼Œä¸” <strong>æ¢å¤é€Ÿåº¦æ…¢</strong>ã€‚</li><li><strong>æ•°æ®é›†å¤§</strong> çš„æ—¶å€™ï¼Œæ¯” RDB <strong>å¯åŠ¨æ•ˆç‡ä½</strong>ã€‚</li></ol><h3 id="_10-rdbå’Œaofå¦‚ä½•é€‰æ‹©" tabindex="-1"><a class="header-anchor" href="#_10-rdbå’Œaofå¦‚ä½•é€‰æ‹©" aria-hidden="true">#</a> 10.RDBå’ŒAOFå¦‚ä½•é€‰æ‹©ï¼Ÿ</h3><ul><li>ä¸€èˆ¬æ¥è¯´ï¼Œ å¦‚æœæƒ³è¾¾åˆ°è¶³ä»¥åª²ç¾æ•°æ®åº“çš„ <strong>æ•°æ®å®‰å…¨æ€§</strong>ï¼Œåº”è¯¥ <strong>åŒæ—¶ä½¿ç”¨ä¸¤ç§æŒä¹…åŒ–åŠŸèƒ½</strong>ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“ Redis é‡å¯çš„æ—¶å€™ä¼šä¼˜å…ˆè½½å…¥ AOF æ–‡ä»¶æ¥æ¢å¤åŸå§‹çš„æ•°æ®ï¼Œå› ä¸ºåœ¨é€šå¸¸æƒ…å†µä¸‹ AOF æ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦æ¯” RDB æ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦å®Œæ•´ã€‚</li><li>å¦‚æœ <strong>å¯ä»¥æ¥å—æ•°åˆ†é’Ÿä»¥å†…çš„æ•°æ®ä¸¢å¤±</strong>ï¼Œé‚£ä¹ˆå¯ä»¥ <strong>åªä½¿ç”¨ RDB æŒä¹…åŒ–</strong>ã€‚</li><li>æœ‰å¾ˆå¤šç”¨æˆ·éƒ½åªä½¿ç”¨ AOF æŒä¹…åŒ–ï¼Œä½†å¹¶ä¸æ¨èè¿™ç§æ–¹å¼ï¼Œå› ä¸ºå®šæ—¶ç”Ÿæˆ RDB å¿«ç…§ï¼ˆsnapshotï¼‰éå¸¸ä¾¿äºè¿›è¡Œæ•°æ®å¤‡ä»½ï¼Œ å¹¶ä¸” RDB æ¢å¤æ•°æ®é›†çš„é€Ÿåº¦ä¹Ÿè¦æ¯” AOF æ¢å¤çš„é€Ÿåº¦è¦å¿«ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œä½¿ç”¨ RDB è¿˜å¯ä»¥é¿å… AOF ç¨‹åºçš„ bugã€‚</li><li>å¦‚æœåªéœ€è¦æ•°æ®åœ¨æœåŠ¡å™¨è¿è¡Œçš„æ—¶å€™å­˜åœ¨ï¼Œä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ä»»ä½•æŒä¹…åŒ–æ–¹å¼ã€‚</li></ul><h3 id="_11-redisçš„æ•°æ®æ¢å¤" tabindex="-1"><a class="header-anchor" href="#_11-redisçš„æ•°æ®æ¢å¤" aria-hidden="true">#</a> 11.Redisçš„æ•°æ®æ¢å¤ï¼Ÿ</h3><p>å½“Rediså‘ç”Ÿäº†æ•…éšœï¼Œå¯ä»¥ä»RDBæˆ–è€…AOFä¸­æ¢å¤æ•°æ®ã€‚</p><p>æ¢å¤çš„è¿‡ç¨‹ä¹Ÿå¾ˆç®€å•ï¼ŒæŠŠRDBæˆ–è€…AOFæ–‡ä»¶æ‹·è´åˆ°Redisçš„æ•°æ®ç›®å½•ä¸‹ï¼Œå¦‚æœä½¿ç”¨AOFæ¢å¤ï¼Œé…ç½®æ–‡ä»¶å¼€å¯AOFï¼Œç„¶åå¯åŠ¨redis-serverå³å¯ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-f9aab5e9-a875-4316-9ec9-0c5650afe5c1.png" alt="Rediså¯åŠ¨åŠ è½½æ•°æ®"></p><p><strong>Redis</strong> å¯åŠ¨æ—¶åŠ è½½æ•°æ®çš„æµç¨‹ï¼š</p><ol><li>AOFæŒä¹…åŒ–å¼€å¯ä¸”å­˜åœ¨AOFæ–‡ä»¶æ—¶ï¼Œä¼˜å…ˆåŠ è½½AOFæ–‡ä»¶ã€‚</li><li>AOFå…³é—­æˆ–è€…AOFæ–‡ä»¶ä¸å­˜åœ¨æ—¶ï¼ŒåŠ è½½RDBæ–‡ä»¶ã€‚</li><li>åŠ è½½AOF/RDBæ–‡ä»¶æˆåŠŸåï¼ŒRediså¯åŠ¨æˆåŠŸã€‚</li><li>AOF/RDBæ–‡ä»¶å­˜åœ¨é”™è¯¯æ—¶ï¼ŒRediså¯åŠ¨å¤±è´¥å¹¶æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</li></ol><h3 id="_12-redis-4-0-çš„æ··åˆæŒä¹…åŒ–äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#_12-redis-4-0-çš„æ··åˆæŒä¹…åŒ–äº†è§£å—" aria-hidden="true">#</a> 12.Redis 4.0 çš„æ··åˆæŒä¹…åŒ–äº†è§£å—ï¼Ÿ</h3><p>é‡å¯ Redis æ—¶ï¼Œæˆ‘ä»¬å¾ˆå°‘ä½¿ç”¨ <code>RDB</code> æ¥æ¢å¤å†…å­˜çŠ¶æ€ï¼Œå› ä¸ºä¼šä¸¢å¤±å¤§é‡æ•°æ®ã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ AOF æ—¥å¿—é‡æ”¾ï¼Œä½†æ˜¯é‡æ”¾ AOF æ—¥å¿—æ€§èƒ½ç›¸å¯¹ <code>RDB</code> æ¥è¯´è¦æ…¢å¾ˆå¤šï¼Œè¿™æ ·åœ¨ Redis å®ä¾‹å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼Œå¯åŠ¨éœ€è¦èŠ±è´¹å¾ˆé•¿çš„æ—¶é—´ã€‚</p><p><strong>Redis 4.0</strong> ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¸¦æ¥äº†ä¸€ä¸ªæ–°çš„æŒä¹…åŒ–é€‰é¡¹â€”â€”<strong>æ··åˆæŒä¹…åŒ–</strong>ã€‚å°† <code>rdb</code> æ–‡ä»¶çš„å†…å®¹å’Œå¢é‡çš„ AOF æ—¥å¿—æ–‡ä»¶å­˜åœ¨ä¸€èµ·ã€‚è¿™é‡Œçš„ AOF æ—¥å¿—ä¸å†æ˜¯å…¨é‡çš„æ—¥å¿—ï¼Œè€Œæ˜¯ <strong>è‡ªæŒä¹…åŒ–å¼€å§‹åˆ°æŒä¹…åŒ–ç»“æŸ</strong> çš„è¿™æ®µæ—¶é—´å‘ç”Ÿçš„å¢é‡ AOF æ—¥å¿—ï¼Œé€šå¸¸è¿™éƒ¨åˆ† AOF æ—¥å¿—å¾ˆå°ï¼š <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-19c531e5-da95-495a-a4c4-d63a0b8bba95.png" alt="æ··åˆæŒä¹…åŒ–"></p><p>äºæ˜¯åœ¨ Redis é‡å¯çš„æ—¶å€™ï¼Œå¯ä»¥å…ˆåŠ è½½ <code>rdb</code> çš„å†…å®¹ï¼Œç„¶åå†é‡æ”¾å¢é‡ AOF æ—¥å¿—å°±å¯ä»¥å®Œå…¨æ›¿ä»£ä¹‹å‰çš„ AOF å…¨é‡æ–‡ä»¶é‡æ”¾ï¼Œé‡å¯æ•ˆç‡å› æ­¤å¤§å¹…å¾—åˆ°æå‡ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/xingbiaogongzhonghao.png" alt=""></p><h2 id="é«˜å¯ç”¨" tabindex="-1"><a class="header-anchor" href="#é«˜å¯ç”¨" aria-hidden="true">#</a> é«˜å¯ç”¨</h2><p>Redisä¿è¯é«˜å¯ç”¨ä¸»è¦æœ‰ä¸‰ç§æ–¹å¼ï¼šä¸»ä»ã€å“¨å…µã€é›†ç¾¤ã€‚</p><h3 id="_13-ä¸»ä»å¤åˆ¶äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#_13-ä¸»ä»å¤åˆ¶äº†è§£å—" aria-hidden="true">#</a> 13.ä¸»ä»å¤åˆ¶äº†è§£å—ï¼Ÿ</h3><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-60497f1e-8afb-44b3-bb7a-d4c29e5ac484.png" alt="Redisä¸»ä»å¤åˆ¶ç®€å›¾"></p><p><strong>ä¸»ä»å¤åˆ¶</strong>ï¼Œæ˜¯æŒ‡å°†ä¸€å° Redis æœåŠ¡å™¨çš„æ•°æ®ï¼Œå¤åˆ¶åˆ°å…¶ä»–çš„ Redis æœåŠ¡å™¨ã€‚å‰è€…ç§°ä¸º <strong>ä¸»èŠ‚ç‚¹(master)</strong>ï¼Œåè€…ç§°ä¸º <strong>ä»èŠ‚ç‚¹(slave)</strong>ã€‚ä¸”æ•°æ®çš„å¤åˆ¶æ˜¯ <strong>å•å‘</strong> çš„ï¼Œåªèƒ½ç”±ä¸»èŠ‚ç‚¹åˆ°ä»èŠ‚ç‚¹ã€‚Redis ä¸»ä»å¤åˆ¶æ”¯æŒ <strong>ä¸»ä»åŒæ­¥</strong> å’Œ <strong>ä»ä»åŒæ­¥</strong> ä¸¤ç§ï¼Œåè€…æ˜¯ Redis åç»­ç‰ˆæœ¬æ–°å¢çš„åŠŸèƒ½ï¼Œä»¥å‡è½»ä¸»èŠ‚ç‚¹çš„åŒæ­¥è´Ÿæ‹…ã€‚</p><blockquote><p>ä¸»ä»å¤åˆ¶ä¸»è¦çš„ä½œç”¨?</p></blockquote><ul><li><strong>æ•°æ®å†—ä½™ï¼š</strong> ä¸»ä»å¤åˆ¶å®ç°äº†æ•°æ®çš„çƒ­å¤‡ä»½ï¼Œæ˜¯æŒä¹…åŒ–ä¹‹å¤–çš„ä¸€ç§æ•°æ®å†—ä½™æ–¹å¼ã€‚</li><li><strong>æ•…éšœæ¢å¤ï¼š</strong> å½“ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥ç”±ä»èŠ‚ç‚¹æä¾›æœåŠ¡ï¼Œå®ç°å¿«é€Ÿçš„æ•…éšœæ¢å¤ <em>(å®é™…ä¸Šæ˜¯ä¸€ç§æœåŠ¡çš„å†—ä½™)</em>ã€‚</li><li><strong>è´Ÿè½½å‡è¡¡ï¼š</strong> åœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œé…åˆè¯»å†™åˆ†ç¦»ï¼Œå¯ä»¥ç”±ä¸»èŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œç”±ä»èŠ‚ç‚¹æä¾›è¯»æœåŠ¡ <em>ï¼ˆå³å†™ Redis æ•°æ®æ—¶åº”ç”¨è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œè¯» Redis æ•°æ®æ—¶åº”ç”¨è¿æ¥ä»èŠ‚ç‚¹ï¼‰</em>ï¼Œåˆ†æ‹…æœåŠ¡å™¨è´Ÿè½½ã€‚å°¤å…¶æ˜¯åœ¨å†™å°‘è¯»å¤šçš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹åˆ†æ‹…è¯»è´Ÿè½½ï¼Œå¯ä»¥å¤§å¤§æé«˜ Redis æœåŠ¡å™¨çš„å¹¶å‘é‡ã€‚</li><li><strong>é«˜å¯ç”¨åŸºçŸ³ï¼š</strong> é™¤äº†ä¸Šè¿°ä½œç”¨ä»¥å¤–ï¼Œä¸»ä»å¤åˆ¶è¿˜æ˜¯å“¨å…µå’Œé›†ç¾¤èƒ½å¤Ÿå®æ–½çš„ <strong>åŸºç¡€</strong>ï¼Œå› æ­¤è¯´ä¸»ä»å¤åˆ¶æ˜¯ Redis é«˜å¯ç”¨çš„åŸºç¡€ã€‚</li></ul><h3 id="_14-redisä¸»ä»æœ‰å‡ ç§å¸¸è§çš„æ‹“æ‰‘ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_14-redisä¸»ä»æœ‰å‡ ç§å¸¸è§çš„æ‹“æ‰‘ç»“æ„" aria-hidden="true">#</a> 14.Redisä¸»ä»æœ‰å‡ ç§å¸¸è§çš„æ‹“æ‰‘ç»“æ„ï¼Ÿ</h3><p>Redisçš„å¤åˆ¶æ‹“æ‰‘ç»“æ„å¯ä»¥æ”¯æŒå•å±‚æˆ–å¤šå±‚å¤åˆ¶å…³ç³»ï¼Œæ ¹æ®æ‹“æ‰‘å¤æ‚æ€§å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§ï¼šä¸€ä¸»ä¸€ä»ã€ä¸€ä¸»å¤šä»ã€æ ‘çŠ¶ä¸»ä»ç»“æ„ã€‚</p><p>1.ä¸€ä¸»ä¸€ä»ç»“æ„</p><p>ä¸€ä¸»ä¸€ä»ç»“æ„æ˜¯æœ€ç®€å•çš„å¤åˆ¶æ‹“æ‰‘ç»“æ„ï¼Œç”¨äºä¸»èŠ‚ç‚¹å‡ºç°å®•æœºæ—¶ä»èŠ‚ç‚¹æä¾›æ•…éšœè½¬ç§»æ”¯æŒã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-5d91a67c-dbff-4a8d-bf9d-1fe7602d5a27.png" alt="ä¸€ä¸»ä¸€ä»ç»“æ„"> 2.ä¸€ä¸»å¤šä»ç»“æ„</p><p>ä¸€ä¸»å¤šä»ç»“æ„ï¼ˆåˆç§°ä¸ºæ˜Ÿå½¢æ‹“æ‰‘ç»“æ„ï¼‰ä½¿å¾—åº”ç”¨ç«¯å¯ä»¥åˆ©ç”¨å¤šä¸ªä»èŠ‚ç‚¹å®ç°è¯»å†™åˆ†ç¦»ï¼ˆè§å›¾6-5ï¼‰ã€‚å¯¹äºè¯»å æ¯”è¾ƒå¤§çš„åœºæ™¯ï¼Œå¯ä»¥æŠŠè¯»å‘½ä»¤å‘é€åˆ°ä»èŠ‚ç‚¹æ¥åˆ†æ‹…ä¸»èŠ‚ç‚¹å‹åŠ›ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-71074254-699a-480b-bbb0-c68f364a380b.png" alt="ä¸€ä¸»å¤šä»ç»“æ„"> 3.æ ‘çŠ¶ä¸»ä»ç»“æ„</p><p>æ ‘çŠ¶ä¸»ä»ç»“æ„ï¼ˆåˆç§°ä¸ºæ ‘çŠ¶æ‹“æ‰‘ç»“æ„ï¼‰ä½¿å¾—ä»èŠ‚ç‚¹ä¸ä½†å¯ä»¥å¤åˆ¶ä¸»èŠ‚ç‚¹æ•°æ®ï¼ŒåŒæ—¶å¯ä»¥ä½œä¸ºå…¶ä»–ä»èŠ‚ç‚¹çš„ä¸»èŠ‚ç‚¹ç»§ç»­å‘ä¸‹å±‚å¤åˆ¶ã€‚é€šè¿‡å¼•å…¥å¤åˆ¶ä¸­é—´å±‚ï¼Œå¯ä»¥æœ‰æ•ˆé™ä½ä¸»èŠ‚ç‚¹è´Ÿè½½å’Œéœ€è¦ä¼ é€ç»™ä»èŠ‚ç‚¹çš„æ•°æ®é‡ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-dff14203-5e01-4d1b-a775-10ee444ada54.png" alt="æ ‘çŠ¶ä¸»ä»ç»“æ„"></p><h3 id="_15-redisçš„ä¸»ä»å¤åˆ¶åŸç†äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#_15-redisçš„ä¸»ä»å¤åˆ¶åŸç†äº†è§£å—" aria-hidden="true">#</a> 15.Redisçš„ä¸»ä»å¤åˆ¶åŸç†äº†è§£å—ï¼Ÿ</h3><p>Redisä¸»ä»å¤åˆ¶çš„å·¥ä½œæµç¨‹å¤§æ¦‚å¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å‡ æ­¥ï¼š <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-21123b1e-68b4-436b-ac84-3365a49a81bd.png" alt="Redisä¸»ä»å¤åˆ¶å·¥ä½œæµç¨‹"></p><ol><li>ä¿å­˜ä¸»èŠ‚ç‚¹ï¼ˆmasterï¼‰ä¿¡æ¯ è¿™ä¸€æ­¥åªæ˜¯ä¿å­˜ä¸»èŠ‚ç‚¹ä¿¡æ¯ï¼Œä¿å­˜ä¸»èŠ‚ç‚¹çš„ipå’Œportã€‚</li><li>ä¸»ä»å»ºç«‹è¿æ¥ ä»èŠ‚ç‚¹ï¼ˆslaveï¼‰å‘ç°æ–°çš„ä¸»èŠ‚ç‚¹åï¼Œä¼šå°è¯•å’Œä¸»èŠ‚ç‚¹å»ºç«‹ç½‘ç»œè¿æ¥ã€‚</li><li>å‘é€pingå‘½ä»¤ è¿æ¥å»ºç«‹æˆåŠŸåä»èŠ‚ç‚¹å‘é€pingè¯·æ±‚è¿›è¡Œé¦–æ¬¡é€šä¿¡ï¼Œä¸»è¦æ˜¯æ£€æµ‹ä¸»ä»ä¹‹é—´ç½‘ç»œå¥—æ¥å­—æ˜¯å¦å¯ç”¨ã€ä¸»èŠ‚ç‚¹å½“å‰æ˜¯å¦å¯æ¥å—å¤„ç†å‘½ä»¤ã€‚</li><li>æƒé™éªŒè¯ å¦‚æœä¸»èŠ‚ç‚¹è¦æ±‚å¯†ç éªŒè¯ï¼Œä»èŠ‚ç‚¹å¿…é¡»æ­£ç¡®çš„å¯†ç æ‰èƒ½é€šè¿‡éªŒè¯ã€‚</li><li>åŒæ­¥æ•°æ®é›† ä¸»ä»å¤åˆ¶è¿æ¥æ­£å¸¸é€šä¿¡åï¼Œä¸»èŠ‚ç‚¹ä¼šæŠŠæŒæœ‰çš„æ•°æ®å…¨éƒ¨å‘é€ç»™ä»èŠ‚ç‚¹ã€‚</li><li>å‘½ä»¤æŒç»­å¤åˆ¶ æ¥ä¸‹æ¥ä¸»èŠ‚ç‚¹ä¼šæŒç»­åœ°æŠŠå†™å‘½ä»¤å‘é€ç»™ä»èŠ‚ç‚¹ï¼Œä¿è¯ä¸»ä»æ•°æ®ä¸€è‡´æ€§ã€‚</li></ol><h3 id="_16-è¯´è¯´ä¸»ä»æ•°æ®åŒæ­¥çš„æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#_16-è¯´è¯´ä¸»ä»æ•°æ®åŒæ­¥çš„æ–¹å¼" aria-hidden="true">#</a> 16.è¯´è¯´ä¸»ä»æ•°æ®åŒæ­¥çš„æ–¹å¼ï¼Ÿ</h3><p>Redisåœ¨2.8åŠä»¥ä¸Šç‰ˆæœ¬ä½¿ç”¨psyncå‘½ä»¤å®Œæˆä¸»ä»æ•°æ®åŒæ­¥ï¼ŒåŒæ­¥è¿‡ç¨‹åˆ†ä¸ºï¼šå…¨é‡å¤åˆ¶å’Œéƒ¨åˆ†å¤åˆ¶ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-7518f715-6dee-4e70-b972-8aed9879e451.png" alt="ä¸»ä»æ•°æ®åŒæ­¥æ–¹å¼"></p><p><strong>å…¨é‡å¤åˆ¶</strong> ä¸€èˆ¬ç”¨äºåˆæ¬¡å¤åˆ¶åœºæ™¯ï¼ŒRedisæ—©æœŸæ”¯æŒçš„å¤åˆ¶åŠŸèƒ½åªæœ‰å…¨é‡å¤åˆ¶ï¼Œå®ƒä¼šæŠŠä¸»èŠ‚ç‚¹å…¨éƒ¨æ•°æ®ä¸€æ¬¡æ€§å‘é€ç»™ä»èŠ‚ç‚¹ï¼Œå½“æ•°æ®é‡è¾ƒå¤§æ—¶ï¼Œä¼šå¯¹ä¸»ä»èŠ‚ç‚¹å’Œç½‘ç»œé€ æˆå¾ˆå¤§çš„å¼€é”€ã€‚</p><p>å…¨é‡å¤åˆ¶çš„å®Œæ•´è¿è¡Œæµç¨‹å¦‚ä¸‹ï¼š <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-aa8d2960-b341-49cc-b04c-201241fd15de.png" alt="å…¨é‡å¤åˆ¶"></p><ol><li>å‘é€psyncå‘½ä»¤è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œç”±äºæ˜¯ç¬¬ä¸€æ¬¡è¿›è¡Œå¤åˆ¶ï¼Œä»èŠ‚ç‚¹æ²¡æœ‰å¤åˆ¶åç§»é‡å’Œä¸»èŠ‚ç‚¹çš„è¿è¡ŒIDï¼Œæ‰€ä»¥å‘é€psync-1ã€‚</li><li>ä¸»èŠ‚ç‚¹æ ¹æ®psync-1è§£æå‡ºå½“å‰ä¸ºå…¨é‡å¤åˆ¶ï¼Œå›å¤+FULLRESYNCå“åº”ã€‚</li><li>ä»èŠ‚ç‚¹æ¥æ”¶ä¸»èŠ‚ç‚¹çš„å“åº”æ•°æ®ä¿å­˜è¿è¡ŒIDå’Œåç§»é‡offset</li><li>ä¸»èŠ‚ç‚¹æ‰§è¡Œbgsaveä¿å­˜RDBæ–‡ä»¶åˆ°æœ¬åœ°</li><li>ä¸»èŠ‚ç‚¹å‘é€RDBæ–‡ä»¶ç»™ä»èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹æŠŠæ¥æ”¶çš„RDBæ–‡ä»¶ä¿å­˜åœ¨æœ¬åœ°å¹¶ç›´æ¥ä½œä¸ºä»èŠ‚ç‚¹çš„æ•°æ®æ–‡ä»¶</li><li>å¯¹äºä»èŠ‚ç‚¹å¼€å§‹æ¥æ”¶RDBå¿«ç…§åˆ°æ¥æ”¶å®ŒæˆæœŸé—´ï¼Œä¸»èŠ‚ç‚¹ä»ç„¶å“åº”è¯»å†™å‘½ä»¤ï¼Œå› æ­¤ä¸»èŠ‚ç‚¹ä¼šæŠŠè¿™æœŸé—´å†™å‘½ä»¤æ•°æ®ä¿å­˜åœ¨å¤åˆ¶å®¢æˆ·ç«¯ç¼“å†²åŒºå†…ï¼Œå½“ä»èŠ‚ç‚¹åŠ è½½å®ŒRDBæ–‡ä»¶åï¼Œä¸»èŠ‚ç‚¹å†æŠŠç¼“å†²åŒºå†…çš„æ•°æ®å‘é€ç»™ä»èŠ‚ç‚¹ï¼Œä¿è¯ä¸»ä»ä¹‹é—´æ•°æ®ä¸€è‡´æ€§ã€‚</li><li>ä»èŠ‚ç‚¹æ¥æ”¶å®Œä¸»èŠ‚ç‚¹ä¼ é€æ¥çš„å…¨éƒ¨æ•°æ®åä¼šæ¸…ç©ºè‡ªèº«æ—§æ•°æ®</li><li>ä»èŠ‚ç‚¹æ¸…ç©ºæ•°æ®åå¼€å§‹åŠ è½½RDBæ–‡ä»¶</li><li>ä»èŠ‚ç‚¹æˆåŠŸåŠ è½½å®ŒRDBåï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹å¼€å¯äº†AOFæŒä¹…åŒ–åŠŸèƒ½ï¼Œ å®ƒä¼šç«‹åˆ»åšbgrewriteaofæ“ä½œï¼Œä¸ºäº†ä¿è¯å…¨é‡å¤åˆ¶åAOFæŒä¹…åŒ–æ–‡ä»¶ç«‹åˆ»å¯ç”¨ã€‚</li></ol><p><strong>éƒ¨åˆ†å¤åˆ¶</strong> éƒ¨åˆ†å¤åˆ¶ä¸»è¦æ˜¯Redisé’ˆå¯¹å…¨é‡å¤åˆ¶çš„è¿‡é«˜å¼€é”€åšå‡ºçš„ä¸€ç§ä¼˜åŒ–æªæ–½ï¼Œ ä½¿ç”¨psync{runId}{offset}å‘½ä»¤å®ç°ã€‚å½“ä»èŠ‚ç‚¹ï¼ˆslaveï¼‰æ­£åœ¨å¤åˆ¶ä¸»èŠ‚ç‚¹ ï¼ˆmasterï¼‰æ—¶ï¼Œå¦‚æœå‡ºç°ç½‘ç»œé—ªæ–­æˆ–è€…å‘½ä»¤ä¸¢å¤±ç­‰å¼‚å¸¸æƒ…å†µæ—¶ï¼Œä»èŠ‚ç‚¹ä¼šå‘ ä¸»èŠ‚ç‚¹è¦æ±‚è¡¥å‘ä¸¢å¤±çš„å‘½ä»¤æ•°æ®ï¼Œå¦‚æœä¸»èŠ‚ç‚¹çš„å¤åˆ¶ç§¯å‹ç¼“å†²åŒºå†…å­˜åœ¨è¿™éƒ¨åˆ†æ•°æ®åˆ™ç›´æ¥å‘é€ç»™ä»èŠ‚ç‚¹ï¼Œè¿™æ ·å°±å¯ä»¥ä¿æŒä¸»ä»èŠ‚ç‚¹å¤åˆ¶çš„ä¸€è‡´æ€§ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-87600c72-cc6a-4656-81b2-e71864c97f23.png" alt="éƒ¨åˆ†å¤åˆ¶"></p><ol><li>å½“ä¸»ä»èŠ‚ç‚¹ä¹‹é—´ç½‘ç»œå‡ºç°ä¸­æ–­æ—¶ï¼Œå¦‚æœè¶…è¿‡repl-timeoutæ—¶é—´ï¼Œä¸»èŠ‚ç‚¹ä¼šè®¤ä¸ºä»èŠ‚ç‚¹æ•…éšœå¹¶ä¸­æ–­å¤åˆ¶è¿æ¥</li><li>ä¸»ä»è¿æ¥ä¸­æ–­æœŸé—´ä¸»èŠ‚ç‚¹ä¾ç„¶å“åº”å‘½ä»¤ï¼Œä½†å› å¤åˆ¶è¿æ¥ä¸­æ–­å‘½ä»¤æ— æ³•å‘é€ç»™ä»èŠ‚ç‚¹ï¼Œä¸è¿‡ä¸»èŠ‚ç‚¹å†…éƒ¨å­˜åœ¨çš„å¤åˆ¶ç§¯å‹ç¼“å†²åŒºï¼Œä¾ç„¶å¯ä»¥ä¿å­˜æœ€è¿‘ä¸€æ®µæ—¶é—´çš„å†™å‘½ä»¤æ•°æ®ï¼Œé»˜è®¤æœ€å¤§ç¼“å­˜1MBã€‚</li><li>å½“ä¸»ä»èŠ‚ç‚¹ç½‘ç»œæ¢å¤åï¼Œä»èŠ‚ç‚¹ä¼šå†æ¬¡è¿ä¸Šä¸»èŠ‚ç‚¹</li><li>å½“ä¸»ä»è¿æ¥æ¢å¤åï¼Œç”±äºä»èŠ‚ç‚¹ä¹‹å‰ä¿å­˜äº†è‡ªèº«å·²å¤åˆ¶çš„åç§»é‡å’Œä¸»èŠ‚ç‚¹çš„è¿è¡ŒIDã€‚å› æ­¤ä¼šæŠŠå®ƒä»¬å½“ä½œpsyncå‚æ•°å‘é€ç»™ä¸»èŠ‚ç‚¹ï¼Œè¦æ±‚è¿›è¡Œéƒ¨åˆ†å¤åˆ¶æ“ä½œã€‚</li><li>ä¸»èŠ‚ç‚¹æ¥åˆ°psyncå‘½ä»¤åé¦–å…ˆæ ¸å¯¹å‚æ•°runIdæ˜¯å¦ä¸è‡ªèº«ä¸€è‡´ï¼Œå¦‚æœä¸€ è‡´ï¼Œè¯´æ˜ä¹‹å‰å¤åˆ¶çš„æ˜¯å½“å‰ä¸»èŠ‚ç‚¹ï¼›ä¹‹åæ ¹æ®å‚æ•°offsetåœ¨è‡ªèº«å¤åˆ¶ç§¯å‹ç¼“å†²åŒºæŸ¥æ‰¾ï¼Œå¦‚æœåç§»é‡ä¹‹åçš„æ•°æ®å­˜åœ¨ç¼“å†²åŒºä¸­ï¼Œåˆ™å¯¹ä»èŠ‚ç‚¹å‘é€+CONTINUEå“åº”ï¼Œè¡¨ç¤ºå¯ä»¥è¿›è¡Œéƒ¨åˆ†å¤åˆ¶ã€‚</li><li>ä¸»èŠ‚ç‚¹æ ¹æ®åç§»é‡æŠŠå¤åˆ¶ç§¯å‹ç¼“å†²åŒºé‡Œçš„æ•°æ®å‘é€ç»™ä»èŠ‚ç‚¹ï¼Œä¿è¯ä¸»ä»å¤åˆ¶è¿›å…¥æ­£å¸¸çŠ¶æ€ã€‚</li></ol><h3 id="_17-ä¸»ä»å¤åˆ¶å­˜åœ¨å“ªäº›é—®é¢˜å‘¢" tabindex="-1"><a class="header-anchor" href="#_17-ä¸»ä»å¤åˆ¶å­˜åœ¨å“ªäº›é—®é¢˜å‘¢" aria-hidden="true">#</a> 17.ä¸»ä»å¤åˆ¶å­˜åœ¨å“ªäº›é—®é¢˜å‘¢ï¼Ÿ</h3><p>ä¸»ä»å¤åˆ¶è™½å¥½ï¼Œä½†ä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜ï¼š</p><ul><li>ä¸€æ—¦ä¸»èŠ‚ç‚¹å‡ºç°æ•…éšœï¼Œéœ€è¦æ‰‹åŠ¨å°†ä¸€ä¸ªä»èŠ‚ç‚¹æ™‹å‡ä¸ºä¸»èŠ‚ç‚¹ï¼ŒåŒæ—¶éœ€è¦ä¿®æ”¹åº”ç”¨æ–¹çš„ä¸»èŠ‚ç‚¹åœ°å€ï¼Œè¿˜éœ€è¦å‘½ä»¤å…¶ä»–ä»èŠ‚ç‚¹å»å¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹ï¼Œæ•´ä¸ªè¿‡ç¨‹éƒ½éœ€è¦äººå·¥å¹²é¢„ã€‚</li><li>ä¸»èŠ‚ç‚¹çš„å†™èƒ½åŠ›å—åˆ°å•æœºçš„é™åˆ¶ã€‚</li><li>ä¸»èŠ‚ç‚¹çš„å­˜å‚¨èƒ½åŠ›å—åˆ°å•æœºçš„é™åˆ¶ã€‚</li></ul><p>ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯Redisçš„é«˜å¯ç”¨é—®é¢˜ï¼Œç¬¬äºŒã€ä¸‰ä¸ªé—®é¢˜å±äºRedisçš„åˆ†å¸ƒå¼é—®é¢˜ã€‚</p><h3 id="_18-redis-sentinel-å“¨å…µ-äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#_18-redis-sentinel-å“¨å…µ-äº†è§£å—" aria-hidden="true">#</a> 18.Redis Sentinelï¼ˆå“¨å…µï¼‰äº†è§£å—ï¼Ÿ</h3><p>ä¸»ä»å¤åˆ¶å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œæ²¡æ³•å®Œæˆè‡ªåŠ¨æ•…éšœè½¬ç§»ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–¹æ¡ˆæ¥å®Œæˆè‡ªåŠ¨æ•…éšœè½¬ç§»ï¼Œå®ƒå°±æ˜¯Redis Sentinelï¼ˆå“¨å…µï¼‰ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-8b1a055c-f077-49ff-9432-c194d4fc3639.png" alt="Redis Sentinel"></p><p>Redis Sentinel ï¼Œå®ƒç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå“¨å…µèŠ‚ç‚¹å’Œæ•°æ®èŠ‚ç‚¹ï¼š</p><ul><li><strong>å“¨å…µèŠ‚ç‚¹ï¼š</strong> å“¨å…µç³»ç»Ÿç”±ä¸€ä¸ªæˆ–å¤šä¸ªå“¨å…µèŠ‚ç‚¹ç»„æˆï¼Œå“¨å…µèŠ‚ç‚¹æ˜¯ç‰¹æ®Šçš„ Redis èŠ‚ç‚¹ï¼Œä¸å­˜å‚¨æ•°æ®ï¼Œå¯¹æ•°æ®èŠ‚ç‚¹è¿›è¡Œç›‘æ§ã€‚</li><li><strong>æ•°æ®èŠ‚ç‚¹ï¼š</strong> ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹éƒ½æ˜¯æ•°æ®èŠ‚ç‚¹ï¼›</li></ul><p>åœ¨å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œå“¨å…µå®ç°äº† <strong>è‡ªåŠ¨åŒ–çš„æ•…éšœæ¢å¤</strong> åŠŸèƒ½ï¼Œä¸‹é¢æ˜¯å®˜æ–¹å¯¹äºå“¨å…µåŠŸèƒ½çš„æè¿°ï¼š</p><ul><li><strong>ç›‘æ§ï¼ˆMonitoringï¼‰ï¼š</strong> å“¨å…µä¼šä¸æ–­åœ°æ£€æŸ¥ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹æ˜¯å¦è¿ä½œæ­£å¸¸ã€‚</li><li><strong>è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼ˆAutomatic failoverï¼‰ï¼š</strong> å½“ <strong>ä¸»èŠ‚ç‚¹</strong> ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼Œå“¨å…µä¼šå¼€å§‹ <strong>è‡ªåŠ¨æ•…éšœè½¬ç§»æ“ä½œ</strong>ï¼Œå®ƒä¼šå°†å¤±æ•ˆä¸»èŠ‚ç‚¹çš„å…¶ä¸­ä¸€ä¸ª <strong>ä»èŠ‚ç‚¹å‡çº§ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹</strong>ï¼Œå¹¶è®©å…¶ä»–ä»èŠ‚ç‚¹æ”¹ä¸ºå¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹ã€‚</li><li><strong>é…ç½®æä¾›è€…ï¼ˆConfiguration providerï¼‰ï¼š</strong> å®¢æˆ·ç«¯åœ¨åˆå§‹åŒ–æ—¶ï¼Œé€šè¿‡è¿æ¥å“¨å…µæ¥è·å¾—å½“å‰ Redis æœåŠ¡çš„ä¸»èŠ‚ç‚¹åœ°å€ã€‚</li><li><strong>é€šçŸ¥ï¼ˆNotificationï¼‰ï¼š</strong> å“¨å…µå¯ä»¥å°†æ•…éšœè½¬ç§»çš„ç»“æœå‘é€ç»™å®¢æˆ·ç«¯ã€‚</li></ul><p>å…¶ä¸­ï¼Œç›‘æ§å’Œè‡ªåŠ¨æ•…éšœè½¬ç§»åŠŸèƒ½ï¼Œä½¿å¾—å“¨å…µå¯ä»¥åŠæ—¶å‘ç°ä¸»èŠ‚ç‚¹æ•…éšœå¹¶å®Œæˆè½¬ç§»ã€‚è€Œé…ç½®æä¾›è€…å’Œé€šçŸ¥åŠŸèƒ½ï¼Œåˆ™éœ€è¦åœ¨ä¸å®¢æˆ·ç«¯çš„äº¤äº’ä¸­æ‰èƒ½ä½“ç°ã€‚</p><h3 id="_19-redis-sentinel-å“¨å…µ-å®ç°åŸç†çŸ¥é“å—" tabindex="-1"><a class="header-anchor" href="#_19-redis-sentinel-å“¨å…µ-å®ç°åŸç†çŸ¥é“å—" aria-hidden="true">#</a> 19.Redis Sentinelï¼ˆå“¨å…µï¼‰å®ç°åŸç†çŸ¥é“å—ï¼Ÿ</h3><p>å“¨å…µæ¨¡å¼æ˜¯é€šè¿‡å“¨å…µèŠ‚ç‚¹å®Œæˆå¯¹æ•°æ®èŠ‚ç‚¹çš„ç›‘æ§ã€ä¸‹çº¿ã€æ•…éšœè½¬ç§»ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-4074d72a-886a-4892-8f55-80112005aad8.png" alt="Redis Sentinelå·¥ä½œæµç¨‹"></p><ul><li><strong>å®šæ—¶ç›‘æ§</strong><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-e7708f8d-ef34-4255-b5d0-cb300c649716.png" alt="ä¸‰ä¸ªå®šæ—¶ä»»åŠ¡">Redis Sentinelé€šè¿‡ä¸‰ä¸ªå®šæ—¶ç›‘æ§ä»»åŠ¡å®Œæˆå¯¹å„ä¸ªèŠ‚ç‚¹å‘ç°å’Œç›‘æ§ï¼š <ol><li>æ¯éš”10ç§’ï¼Œæ¯ä¸ªSentinelèŠ‚ç‚¹ä¼šå‘ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹å‘é€infoå‘½ä»¤è·å–æœ€æ–°çš„æ‹“æ‰‘ç»“æ„</li><li>æ¯éš”2ç§’ï¼Œæ¯ä¸ªSentinelèŠ‚ç‚¹ä¼šå‘Redisæ•°æ®èŠ‚ç‚¹çš„__sentinel__ï¼šhello é¢‘é“ä¸Šå‘é€è¯¥SentinelèŠ‚ç‚¹å¯¹äºä¸»èŠ‚ç‚¹çš„åˆ¤æ–­ä»¥åŠå½“å‰SentinelèŠ‚ç‚¹çš„ä¿¡æ¯</li><li>æ¯éš”1ç§’ï¼Œæ¯ä¸ªSentinelèŠ‚ç‚¹ä¼šå‘ä¸»èŠ‚ç‚¹ã€ä»èŠ‚ç‚¹ã€å…¶ä½™SentinelèŠ‚ç‚¹å‘é€ä¸€æ¡pingå‘½ä»¤åšä¸€æ¬¡å¿ƒè·³æ£€æµ‹ï¼Œæ¥ç¡®è®¤è¿™äº›èŠ‚ç‚¹å½“å‰æ˜¯å¦å¯è¾¾</li></ol></li><li><strong>ä¸»è§‚ä¸‹çº¿å’Œå®¢è§‚ä¸‹çº¿</strong> ä¸»è§‚ä¸‹çº¿å°±æ˜¯å“¨å…µèŠ‚ç‚¹è®¤ä¸ºæŸä¸ªèŠ‚ç‚¹æœ‰é—®é¢˜ï¼Œå®¢è§‚ä¸‹çº¿å°±æ˜¯è¶…è¿‡ä¸€å®šæ•°é‡çš„å“¨å…µèŠ‚ç‚¹è®¤ä¸ºä¸»èŠ‚ç‚¹æœ‰é—®é¢˜ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-11839a24-9249-48a5-8c9d-888aa80d91dc.png" alt="ä¸»è§‚ä¸‹çº¿å’Œå®¢è§‚ä¸‹çº¿"></li></ul><ol><li><p>ä¸»è§‚ä¸‹çº¿ æ¯ä¸ªSentinelèŠ‚ç‚¹ä¼šæ¯éš”1ç§’å¯¹ä¸»èŠ‚ç‚¹ã€ä»èŠ‚ç‚¹ã€å…¶ä»–SentinelèŠ‚ç‚¹å‘é€pingå‘½ä»¤åšå¿ƒè·³æ£€æµ‹ï¼Œå½“è¿™äº›èŠ‚ç‚¹è¶…è¿‡ down-after-millisecondsæ²¡æœ‰è¿›è¡Œæœ‰æ•ˆå›å¤ï¼ŒSentinelèŠ‚ç‚¹å°±ä¼šå¯¹è¯¥èŠ‚ç‚¹åšå¤±è´¥åˆ¤å®šï¼Œè¿™ä¸ªè¡Œä¸ºå«åšä¸»è§‚ä¸‹çº¿ã€‚</p></li><li><p>å®¢è§‚ä¸‹çº¿ å½“Sentinelä¸»è§‚ä¸‹çº¿çš„èŠ‚ç‚¹æ˜¯ä¸»èŠ‚ç‚¹æ—¶ï¼Œè¯¥SentinelèŠ‚ç‚¹ä¼šé€šè¿‡sentinel is- master-down-by-addrå‘½ä»¤å‘å…¶ä»–SentinelèŠ‚ç‚¹è¯¢é—®å¯¹ä¸»èŠ‚ç‚¹çš„åˆ¤æ–­ï¼Œå½“è¶…è¿‡ &lt;quorum&gt;ä¸ªæ•°ï¼ŒSentinelèŠ‚ç‚¹è®¤ä¸ºä¸»èŠ‚ç‚¹ç¡®å®æœ‰é—®é¢˜ï¼Œè¿™æ—¶è¯¥SentinelèŠ‚ç‚¹ä¼šåšå‡ºå®¢è§‚ä¸‹çº¿çš„å†³å®š</p></li></ol><ul><li><p><strong>é¢†å¯¼è€…SentinelèŠ‚ç‚¹é€‰ä¸¾</strong> SentinelèŠ‚ç‚¹ä¹‹é—´ä¼šåšä¸€ä¸ªé¢†å¯¼è€…é€‰ä¸¾çš„å·¥ä½œï¼Œé€‰å‡ºä¸€ä¸ªSentinelèŠ‚ç‚¹ä½œä¸ºé¢†å¯¼è€…è¿›è¡Œæ•…éšœè½¬ç§»çš„å·¥ä½œã€‚Redisä½¿ç”¨äº†Raftç®—æ³•å®ç°é¢†å¯¼è€…é€‰ä¸¾ã€‚</p></li><li><p><strong>æ•…éšœè½¬ç§»</strong></p><p>é¢†å¯¼è€…é€‰ä¸¾å‡ºçš„SentinelèŠ‚ç‚¹è´Ÿè´£æ•…éšœè½¬ç§»ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-0618a5e2-e94f-40d7-888a-e78019ba8f93.png" alt="æ•…éšœè½¬ç§»"></p><ol><li>åœ¨ä»èŠ‚ç‚¹åˆ—è¡¨ä¸­é€‰å‡ºä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œè¿™ä¸€æ­¥æ˜¯ç›¸å¯¹å¤æ‚ä¸€äº›çš„ä¸€æ­¥</li><li>Sentinelé¢†å¯¼è€…èŠ‚ç‚¹ä¼šå¯¹ç¬¬ä¸€æ­¥é€‰å‡ºæ¥çš„ä»èŠ‚ç‚¹æ‰§è¡Œslaveof no oneå‘½ä»¤è®©å…¶æˆä¸ºä¸»èŠ‚ç‚¹</li><li>Sentinelé¢†å¯¼è€…èŠ‚ç‚¹ä¼šå‘å‰©ä½™çš„ä»èŠ‚ç‚¹å‘é€å‘½ä»¤ï¼Œè®©å®ƒä»¬æˆä¸ºæ–°ä¸»èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹</li><li>SentinelèŠ‚ç‚¹é›†åˆä¼šå°†åŸæ¥çš„ä¸»èŠ‚ç‚¹æ›´æ–°ä¸ºä»èŠ‚ç‚¹ï¼Œå¹¶ä¿æŒç€å¯¹å…¶å…³æ³¨ï¼Œå½“å…¶æ¢å¤åå‘½ä»¤å®ƒå»å¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹</li></ol></li></ul><h3 id="_20-é¢†å¯¼è€…sentinelèŠ‚ç‚¹é€‰ä¸¾äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#_20-é¢†å¯¼è€…sentinelèŠ‚ç‚¹é€‰ä¸¾äº†è§£å—" aria-hidden="true">#</a> 20.é¢†å¯¼è€…SentinelèŠ‚ç‚¹é€‰ä¸¾äº†è§£å—ï¼Ÿ</h3><p>Redisä½¿ç”¨äº†Raftç®—æ³•å® ç°é¢†å¯¼è€…é€‰ä¸¾ï¼Œå¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-6586ae3c-6b33-4c9f-8137-f02fc0e6cfae.png" alt="é¢†å¯¼è€…SentinelèŠ‚ç‚¹é€‰ä¸¾"></p><ol><li>æ¯ä¸ªåœ¨çº¿çš„SentinelèŠ‚ç‚¹éƒ½æœ‰èµ„æ ¼æˆä¸ºé¢†å¯¼è€…ï¼Œå½“å®ƒç¡®è®¤ä¸»èŠ‚ç‚¹ä¸»è§‚ ä¸‹çº¿æ—¶å€™ï¼Œä¼šå‘å…¶ä»–SentinelèŠ‚ç‚¹å‘é€sentinel is-master-down-by-addrå‘½ä»¤ï¼Œ è¦æ±‚å°†è‡ªå·±è®¾ç½®ä¸ºé¢†å¯¼è€…ã€‚</li><li>æ”¶åˆ°å‘½ä»¤çš„SentinelèŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰åŒæ„è¿‡å…¶ä»–SentinelèŠ‚ç‚¹çš„sentinel is-master-down-by-addrå‘½ä»¤ï¼Œå°†åŒæ„è¯¥è¯·æ±‚ï¼Œå¦åˆ™æ‹’ç»ã€‚</li><li>å¦‚æœè¯¥SentinelèŠ‚ç‚¹å‘ç°è‡ªå·±çš„ç¥¨æ•°å·²ç»å¤§äºç­‰äºmaxï¼ˆquorumï¼Œ numï¼ˆsentinelsï¼‰/2+1ï¼‰ï¼Œé‚£ä¹ˆå®ƒå°†æˆä¸ºé¢†å¯¼è€…ã€‚</li><li>å¦‚æœæ­¤è¿‡ç¨‹æ²¡æœ‰é€‰ä¸¾å‡ºé¢†å¯¼è€…ï¼Œå°†è¿›å…¥ä¸‹ä¸€æ¬¡é€‰ä¸¾ã€‚</li></ol><h3 id="_21-æ–°çš„ä¸»èŠ‚ç‚¹æ˜¯æ€æ ·è¢«æŒ‘é€‰å‡ºæ¥çš„" tabindex="-1"><a class="header-anchor" href="#_21-æ–°çš„ä¸»èŠ‚ç‚¹æ˜¯æ€æ ·è¢«æŒ‘é€‰å‡ºæ¥çš„" aria-hidden="true">#</a> 21.æ–°çš„ä¸»èŠ‚ç‚¹æ˜¯æ€æ ·è¢«æŒ‘é€‰å‡ºæ¥çš„ï¼Ÿ</h3><p>é€‰å‡ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œå¤§æ¦‚åˆ†ä¸ºè¿™ä¹ˆå‡ æ­¥ï¼š <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-03976d35-20b6-4efe-aa9c-7d3759460d34.png" alt="æ–°çš„ä¸»èŠ‚ç‚¹"></p><ol><li>è¿‡æ»¤ï¼šâ€œä¸å¥åº·â€ï¼ˆä¸»è§‚ä¸‹çº¿ã€æ–­çº¿ï¼‰ã€5ç§’å†…æ²¡æœ‰å›å¤è¿‡SentinelèŠ‚ ç‚¹pingå“åº”ã€ä¸ä¸»èŠ‚ç‚¹å¤±è”è¶…è¿‡down-after-milliseconds*10ç§’ã€‚</li><li>é€‰æ‹©slave-priorityï¼ˆä»èŠ‚ç‚¹ä¼˜å…ˆçº§ï¼‰æœ€é«˜çš„ä»èŠ‚ç‚¹åˆ—è¡¨ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å›ï¼Œä¸å­˜åœ¨åˆ™ç»§ç»­ã€‚</li><li>é€‰æ‹©å¤åˆ¶åç§»é‡æœ€å¤§çš„ä»èŠ‚ç‚¹ï¼ˆå¤åˆ¶çš„æœ€å®Œæ•´ï¼‰ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿” å›ï¼Œä¸å­˜åœ¨åˆ™ç»§ç»­ã€‚</li><li>é€‰æ‹©runidæœ€å°çš„ä»èŠ‚ç‚¹ã€‚</li></ol><h3 id="_22-redis-é›†ç¾¤äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#_22-redis-é›†ç¾¤äº†è§£å—" aria-hidden="true">#</a> 22.Redis é›†ç¾¤äº†è§£å—ï¼Ÿ</h3><p>å‰é¢è¯´åˆ°äº†ä¸»ä»å­˜åœ¨é«˜å¯ç”¨å’Œåˆ†å¸ƒå¼çš„é—®é¢˜ï¼Œå“¨å…µè§£å†³äº†é«˜å¯ç”¨çš„é—®é¢˜ï¼Œè€Œé›†ç¾¤å°±æ˜¯ç»ˆææ–¹æ¡ˆï¼Œä¸€ä¸¾è§£å†³é«˜å¯ç”¨å’Œåˆ†å¸ƒå¼é—®é¢˜ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-5cbc6009-251e-4d5b-8f22-8d543938eccb.png" alt="Redis é›†ç¾¤ç¤ºæ„å›¾"></p><ol><li><p><strong>æ•°æ®åˆ†åŒºï¼š</strong> æ•°æ®åˆ†åŒº <em>(æˆ–ç§°æ•°æ®åˆ†ç‰‡)</em> æ˜¯é›†ç¾¤æœ€æ ¸å¿ƒçš„åŠŸèƒ½ã€‚é›†ç¾¤å°†æ•°æ®åˆ†æ•£åˆ°å¤šä¸ªèŠ‚ç‚¹ï¼Œä¸€æ–¹é¢ çªç ´äº† Redis å•æœºå†…å­˜å¤§å°çš„é™åˆ¶ï¼Œ<strong>å­˜å‚¨å®¹é‡å¤§å¤§å¢åŠ </strong>ï¼›<strong>å¦ä¸€æ–¹é¢</strong> æ¯ä¸ªä¸»èŠ‚ç‚¹éƒ½å¯ä»¥å¯¹å¤–æä¾›è¯»æœåŠ¡å’Œå†™æœåŠ¡ï¼Œ<strong>å¤§å¤§æé«˜äº†é›†ç¾¤çš„å“åº”èƒ½åŠ›</strong>ã€‚</p></li><li><p><strong>é«˜å¯ç”¨ï¼š</strong> é›†ç¾¤æ”¯æŒä¸»ä»å¤åˆ¶å’Œä¸»èŠ‚ç‚¹çš„ <strong>è‡ªåŠ¨æ•…éšœè½¬ç§»</strong> <em>ï¼ˆä¸å“¨å…µç±»ä¼¼ï¼‰</em>ï¼Œå½“ä»»ä¸€èŠ‚ç‚¹å‘ç”Ÿæ•…éšœæ—¶ï¼Œé›†ç¾¤ä»ç„¶å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ã€‚</p></li></ol><h3 id="_23-é›†ç¾¤ä¸­æ•°æ®å¦‚ä½•åˆ†åŒº" tabindex="-1"><a class="header-anchor" href="#_23-é›†ç¾¤ä¸­æ•°æ®å¦‚ä½•åˆ†åŒº" aria-hidden="true">#</a> 23.é›†ç¾¤ä¸­æ•°æ®å¦‚ä½•åˆ†åŒºï¼Ÿ</h3><p>åˆ†å¸ƒå¼çš„å­˜å‚¨ä¸­ï¼Œè¦æŠŠæ•°æ®é›†æŒ‰ç…§åˆ†åŒºè§„åˆ™æ˜ å°„åˆ°å¤šä¸ªèŠ‚ç‚¹ï¼Œå¸¸è§çš„æ•°æ®åˆ†åŒºè§„åˆ™ä¸‰ç§ï¼š <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-ceb49e41-dfd7-4d1e-91f9-c299437227d2.png" alt="åˆ†å¸ƒå¼æ•°æ®åˆ†åŒº"></p><h5 id="æ–¹æ¡ˆä¸€-èŠ‚ç‚¹å–ä½™åˆ†åŒº" tabindex="-1"><a class="header-anchor" href="#æ–¹æ¡ˆä¸€-èŠ‚ç‚¹å–ä½™åˆ†åŒº" aria-hidden="true">#</a> æ–¹æ¡ˆä¸€ï¼šèŠ‚ç‚¹å–ä½™åˆ†åŒº</h5><p>èŠ‚ç‚¹å–ä½™åˆ†åŒºï¼Œéå¸¸å¥½ç†è§£ï¼Œä½¿ç”¨ç‰¹å®šçš„æ•°æ®ï¼Œæ¯”å¦‚Redisçš„é”®ï¼Œæˆ–è€…ç”¨æˆ·IDä¹‹ç±»ï¼Œå¯¹å“åº”çš„hashå€¼å–ä½™ï¼šhashï¼ˆkeyï¼‰%Nï¼Œæ¥ç¡®å®šæ•°æ®æ˜ å°„åˆ°å“ªä¸€ä¸ªèŠ‚ç‚¹ä¸Šã€‚</p><p>ä¸è¿‡è¯¥æ–¹æ¡ˆæœ€å¤§çš„é—®é¢˜æ˜¯ï¼Œå½“èŠ‚ç‚¹æ•°é‡å˜åŒ–æ—¶ï¼Œå¦‚æ‰©å®¹æˆ–æ”¶ç¼©èŠ‚ç‚¹ï¼Œæ•°æ®èŠ‚ç‚¹æ˜ å°„å…³ ç³»éœ€è¦é‡æ–°è®¡ç®—ï¼Œä¼šå¯¼è‡´æ•°æ®çš„é‡æ–°è¿ç§»ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-8b1fcaec-37e6-420a-9ca2-03615232af17.png" alt="èŠ‚ç‚¹å–ä½™åˆ†åŒº"></p><h5 id="æ–¹æ¡ˆäºŒ-ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒº" tabindex="-1"><a class="header-anchor" href="#æ–¹æ¡ˆäºŒ-ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒº" aria-hidden="true">#</a> æ–¹æ¡ˆäºŒï¼šä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒº</h5><p>å°†æ•´ä¸ª Hash å€¼ç©ºé—´ç»„ç»‡æˆä¸€ä¸ªè™šæ‹Ÿçš„åœ†ç¯ï¼Œç„¶åå°†ç¼“å­˜èŠ‚ç‚¹çš„ IP åœ°å€æˆ–è€…ä¸»æœºååš Hash å–å€¼åï¼Œæ”¾ç½®åœ¨è¿™ä¸ªåœ†ç¯ä¸Šã€‚å½“æˆ‘ä»¬éœ€è¦ç¡®å®šæŸä¸€ä¸ª Key éœ€ è¦å­˜å–åˆ°å“ªä¸ªèŠ‚ç‚¹ä¸Šçš„æ—¶å€™ï¼Œå…ˆå¯¹è¿™ä¸ª Key åšåŒæ ·çš„ Hash å–å€¼ï¼Œç¡®å®šåœ¨ç¯ä¸Šçš„ä½ç½®ï¼Œç„¶åæŒ‰ç…§é¡ºæ—¶é’ˆæ–¹å‘åœ¨ç¯ä¸Šâ€œè¡Œèµ°â€ï¼Œé‡åˆ°çš„ç¬¬ä¸€ä¸ªç¼“å­˜èŠ‚ç‚¹å°±æ˜¯è¦è®¿é—®çš„èŠ‚ç‚¹ã€‚</p><p>æ¯”å¦‚è¯´ä¸‹é¢ è¿™å¼ å›¾é‡Œé¢ï¼ŒKey 1 å’Œ Key 2 ä¼šè½å…¥åˆ° Node 1 ä¸­ï¼ŒKey 3ã€Key 4 ä¼šè½å…¥åˆ° Node 2 ä¸­ï¼ŒKey 5 è½å…¥åˆ° Node 3 ä¸­ï¼ŒKey 6 è½å…¥åˆ° Node 4 ä¸­ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-89bd1c1c-251c-4f53-bba3-fe945b2ae9e2.png" alt="ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒº"></p><p>è¿™ç§æ–¹å¼ç›¸æ¯”èŠ‚ç‚¹å–ä½™æœ€å¤§çš„å¥½å¤„åœ¨äºåŠ å…¥å’Œåˆ é™¤èŠ‚ç‚¹åªå½±å“å“ˆå¸Œç¯ä¸­ ç›¸é‚»çš„èŠ‚ç‚¹ï¼Œå¯¹å…¶ä»–èŠ‚ç‚¹æ— å½±å“ã€‚</p><p>ä½†å®ƒè¿˜æ˜¯å­˜åœ¨é—®é¢˜ï¼š</p><ul><li>ç¼“å­˜èŠ‚ç‚¹åœ¨åœ†ç¯ä¸Šåˆ†å¸ƒä¸å¹³å‡ï¼Œä¼šé€ æˆéƒ¨åˆ†ç¼“å­˜èŠ‚ç‚¹çš„å‹åŠ›è¾ƒå¤§</li><li>å½“æŸä¸ªèŠ‚ç‚¹æ•…éšœæ—¶ï¼Œè¿™ä¸ªèŠ‚ç‚¹æ‰€è¦æ‰¿æ‹…çš„æ‰€æœ‰è®¿é—®éƒ½ä¼šè¢«é¡ºç§»åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œä¼šå¯¹åé¢è¿™ä¸ªèŠ‚ç‚¹é€ æˆåŠ›ã€‚</li></ul><h5 id="æ–¹æ¡ˆä¸‰-è™šæ‹Ÿæ§½åˆ†åŒº" tabindex="-1"><a class="header-anchor" href="#æ–¹æ¡ˆä¸‰-è™šæ‹Ÿæ§½åˆ†åŒº" aria-hidden="true">#</a> æ–¹æ¡ˆä¸‰ï¼šè™šæ‹Ÿæ§½åˆ†åŒº</h5><p>è¿™ä¸ªæ–¹æ¡ˆ ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒºçš„åŸºç¡€ä¸Šï¼Œå¼•å…¥äº† <strong>è™šæ‹ŸèŠ‚ç‚¹</strong> çš„æ¦‚å¿µã€‚Redis é›†ç¾¤ä½¿ç”¨çš„ä¾¿æ˜¯è¯¥æ–¹æ¡ˆï¼Œå…¶ä¸­çš„è™šæ‹ŸèŠ‚ç‚¹ç§°ä¸º <strong>æ§½ï¼ˆslotï¼‰</strong>ã€‚æ§½æ˜¯ä»‹äºæ•°æ®å’Œå®é™…èŠ‚ç‚¹ä¹‹é—´çš„è™šæ‹Ÿæ¦‚å¿µï¼Œæ¯ä¸ªå®é™…èŠ‚ç‚¹åŒ…å«ä¸€å®šæ•°é‡çš„æ§½ï¼Œæ¯ä¸ªæ§½åŒ…å«å“ˆå¸Œå€¼åœ¨ä¸€å®šèŒƒå›´å†…çš„æ•°æ®ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-e0ed9d62-3406-40db-8b01-c931f1020612.png" alt="è™šæ‹Ÿæ§½åˆ†é…"></p><p>åœ¨ä½¿ç”¨äº†æ§½çš„ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒºä¸­ï¼Œæ§½æ˜¯æ•°æ®ç®¡ç†å’Œè¿ç§»çš„åŸºæœ¬å•ä½ã€‚æ§½è§£è€¦äº†æ•°æ®å’Œå®é™…èŠ‚ç‚¹ ä¹‹é—´çš„å…³ç³»ï¼Œå¢åŠ æˆ–åˆ é™¤èŠ‚ç‚¹å¯¹ç³»ç»Ÿçš„å½±å“å¾ˆå°ã€‚ä»ä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œç³»ç»Ÿä¸­æœ‰ <code>4</code> ä¸ªå®é™…èŠ‚ç‚¹ï¼Œå‡è®¾ä¸ºå…¶åˆ†é… <code>16</code> ä¸ªæ§½(0-15)ï¼›</p><ul><li>æ§½ 0-3 ä½äº node1ï¼›4-7 ä½äº node2ï¼›ä»¥æ­¤ç±»æ¨....</li></ul><p>å¦‚æœæ­¤æ—¶åˆ é™¤ <code>node2</code>ï¼Œåªéœ€è¦å°†æ§½ 4-7 é‡æ–°åˆ†é…å³å¯ï¼Œä¾‹å¦‚æ§½ 4-5 åˆ†é…ç»™ <code>node1</code>ï¼Œæ§½ 6 åˆ†é…ç»™ <code>node3</code>ï¼Œæ§½ 7 åˆ†é…ç»™ <code>node4</code>ï¼Œæ•°æ®åœ¨å…¶ä»–èŠ‚ç‚¹çš„åˆ†å¸ƒä»ç„¶è¾ƒä¸ºå‡è¡¡ã€‚</p><h3 id="_24-èƒ½è¯´è¯´redisé›†ç¾¤çš„åŸç†å—" tabindex="-1"><a class="header-anchor" href="#_24-èƒ½è¯´è¯´redisé›†ç¾¤çš„åŸç†å—" aria-hidden="true">#</a> 24.èƒ½è¯´è¯´Redisé›†ç¾¤çš„åŸç†å—ï¼Ÿ</h3><p>Redisé›†ç¾¤é€šè¿‡æ•°æ®åˆ†åŒºæ¥å®ç°æ•°æ®çš„åˆ†å¸ƒå¼å­˜å‚¨ï¼Œé€šè¿‡è‡ªåŠ¨æ•…éšœè½¬ç§»å®ç°é«˜å¯ç”¨ã€‚</p><h5 id="é›†ç¾¤åˆ›å»º" tabindex="-1"><a class="header-anchor" href="#é›†ç¾¤åˆ›å»º" aria-hidden="true">#</a> é›†ç¾¤åˆ›å»º</h5><p>æ•°æ®åˆ†åŒºæ˜¯åœ¨é›†ç¾¤åˆ›å»ºçš„æ—¶å€™å®Œæˆçš„ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-046a512c-baab-4e3a-9409-2af58088cceb.png" alt="é›†ç¾¤åˆ›å»º"></p><p><strong>è®¾ç½®èŠ‚ç‚¹</strong> Redisé›†ç¾¤ä¸€èˆ¬ç”±å¤šä¸ªèŠ‚ç‚¹ç»„æˆï¼ŒèŠ‚ç‚¹æ•°é‡è‡³å°‘ä¸º6ä¸ªæ‰èƒ½ä¿è¯ç»„æˆå®Œæ•´é«˜å¯ç”¨çš„é›†ç¾¤ã€‚æ¯ä¸ªèŠ‚ç‚¹éœ€è¦å¼€å¯é…ç½®cluster-enabled yesï¼Œè®©Redisè¿è¡Œåœ¨é›†ç¾¤æ¨¡å¼ä¸‹ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-e6064ba6-fd6f-4270-92f9-68c0bb98fd4b.png" alt="èŠ‚ç‚¹å’Œæ¡æ‰‹"><strong>èŠ‚ç‚¹æ¡æ‰‹</strong> èŠ‚ç‚¹æ¡æ‰‹æ˜¯æŒ‡ä¸€æ‰¹è¿è¡Œåœ¨é›†ç¾¤æ¨¡å¼ä¸‹çš„èŠ‚ç‚¹é€šè¿‡Gossipåè®®å½¼æ­¤é€šä¿¡ï¼Œ è¾¾åˆ°æ„ŸçŸ¥å¯¹æ–¹çš„è¿‡ç¨‹ã€‚èŠ‚ç‚¹æ¡æ‰‹æ˜¯é›†ç¾¤å½¼æ­¤é€šä¿¡çš„ç¬¬ä¸€æ­¥ï¼Œç”±å®¢æˆ·ç«¯å‘èµ·å‘½ ä»¤ï¼šcluster meet{ip}{port}ã€‚å®ŒæˆèŠ‚ç‚¹æ¡æ‰‹ä¹‹åï¼Œä¸€ä¸ªä¸ªçš„RedisèŠ‚ç‚¹å°±ç»„æˆäº†ä¸€ä¸ªå¤šèŠ‚ç‚¹çš„é›†ç¾¤ã€‚</p><p><strong>åˆ†é…æ§½ï¼ˆslotï¼‰</strong> Redisé›†ç¾¤æŠŠæ‰€æœ‰çš„æ•°æ®æ˜ å°„åˆ°16384ä¸ªæ§½ä¸­ã€‚æ¯ä¸ªèŠ‚ç‚¹å¯¹åº”è‹¥å¹²ä¸ªæ§½ï¼Œåªæœ‰å½“èŠ‚ç‚¹åˆ†é…äº†æ§½ï¼Œæ‰èƒ½å“åº”å’Œè¿™äº›æ§½å…³è”çš„é”®å‘½ä»¤ã€‚é€šè¿‡ cluster addslotså‘½ä»¤ä¸ºèŠ‚ç‚¹åˆ†é…æ§½ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-15341792-e7a6-428c-a109-22827e02be5f.png" alt="åˆ†é…æ§½"></p><h5 id="æ•…éšœè½¬ç§»" tabindex="-1"><a class="header-anchor" href="#æ•…éšœè½¬ç§»" aria-hidden="true">#</a> æ•…éšœè½¬ç§»</h5><p>Redisé›†ç¾¤çš„æ•…éšœè½¬ç§»å’Œå“¨å…µçš„æ•…éšœè½¬ç§»ç±»ä¼¼ï¼Œä½†æ˜¯Redisé›†ç¾¤ä¸­æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½è¦æ‰¿æ‹…çŠ¶æ€ç»´æŠ¤çš„ä»»åŠ¡ã€‚</p><p><strong>æ•…éšœå‘ç°</strong> Redisé›†ç¾¤å†…èŠ‚ç‚¹é€šè¿‡ping/pongæ¶ˆæ¯å®ç°èŠ‚ç‚¹é€šä¿¡ï¼Œé›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šå®šæœŸå‘å…¶ä»–èŠ‚ç‚¹å‘é€pingæ¶ˆæ¯ï¼Œæ¥æ”¶èŠ‚ç‚¹å›å¤pong æ¶ˆæ¯ä½œä¸ºå“åº”ã€‚å¦‚æœåœ¨cluster-node-timeoutæ—¶é—´å†…é€šä¿¡ä¸€ç›´å¤±è´¥ï¼Œåˆ™å‘é€èŠ‚ ç‚¹ä¼šè®¤ä¸ºæ¥æ”¶èŠ‚ç‚¹å­˜åœ¨æ•…éšœï¼ŒæŠŠæ¥æ”¶èŠ‚ç‚¹æ ‡è®°ä¸ºä¸»è§‚ä¸‹çº¿ï¼ˆpfailï¼‰çŠ¶æ€ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-84a2a89e-f9ea-4681-b748-1a4f1dee172b.png" alt="ä¸»è§‚ä¸‹çº¿"> å½“æŸä¸ªèŠ‚ç‚¹åˆ¤æ–­å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸»è§‚ä¸‹çº¿åï¼Œç›¸åº”çš„èŠ‚ç‚¹çŠ¶æ€ä¼šè·Ÿéšæ¶ˆæ¯åœ¨é›†ç¾¤å†…ä¼ æ’­ã€‚é€šè¿‡Gossipæ¶ˆæ¯ä¼ æ’­ï¼Œé›†ç¾¤å†…èŠ‚ç‚¹ä¸æ–­æ”¶é›†åˆ°æ•…éšœèŠ‚ç‚¹çš„ä¸‹çº¿æŠ¥å‘Šã€‚å½“ åŠæ•°ä»¥ä¸ŠæŒæœ‰æ§½çš„ä¸»èŠ‚ç‚¹éƒ½æ ‡è®°æŸä¸ªèŠ‚ç‚¹æ˜¯ä¸»è§‚ä¸‹çº¿æ—¶ã€‚è§¦å‘å®¢è§‚ä¸‹çº¿æµç¨‹ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-b61a6109-7aea-45ab-a53c-267eebb9180a.png" alt="ä¸»è§‚ä¸‹çº¿å’Œå®¢è§‚ä¸‹çº¿"></p><p><strong>æ•…éšœæ¢å¤</strong></p><p>æ•…éšœèŠ‚ç‚¹å˜ä¸ºå®¢è§‚ä¸‹çº¿åï¼Œå¦‚æœä¸‹çº¿èŠ‚ç‚¹æ˜¯æŒæœ‰æ§½çš„ä¸»èŠ‚ç‚¹åˆ™éœ€è¦åœ¨å®ƒ çš„ä»èŠ‚ç‚¹ä¸­é€‰å‡ºä¸€ä¸ªæ›¿æ¢å®ƒï¼Œä»è€Œä¿è¯é›†ç¾¤çš„é«˜å¯ç”¨ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-0e5a49b3-cb5a-4aef-a81f-fce50a012a39.png" alt="æ•…éšœæ¢å¤æµç¨‹"></p><ol><li>èµ„æ ¼æ£€æŸ¥ æ¯ä¸ªä»èŠ‚ç‚¹éƒ½è¦æ£€æŸ¥æœ€åä¸ä¸»èŠ‚ç‚¹æ–­çº¿æ—¶é—´ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰èµ„æ ¼æ›¿æ¢æ•…éšœ çš„ä¸»èŠ‚ç‚¹ã€‚</li><li>å‡†å¤‡é€‰ä¸¾æ—¶é—´ å½“ä»èŠ‚ç‚¹ç¬¦åˆæ•…éšœè½¬ç§»èµ„æ ¼åï¼Œæ›´æ–°è§¦å‘æ•…éšœé€‰ä¸¾çš„æ—¶é—´ï¼Œåªæœ‰åˆ°è¾¾è¯¥ æ—¶é—´åæ‰èƒ½æ‰§è¡Œåç»­æµç¨‹ã€‚</li><li>å‘èµ·é€‰ä¸¾ å½“ä»èŠ‚ç‚¹å®šæ—¶ä»»åŠ¡æ£€æµ‹åˆ°è¾¾æ•…éšœé€‰ä¸¾æ—¶é—´ï¼ˆfailover_auth_timeï¼‰åˆ°è¾¾åï¼Œå‘èµ·é€‰ä¸¾æµç¨‹ã€‚</li><li>é€‰ä¸¾æŠ•ç¥¨ æŒæœ‰æ§½çš„ä¸»èŠ‚ç‚¹å¤„ç†æ•…éšœé€‰ä¸¾æ¶ˆæ¯ã€‚æŠ•ç¥¨è¿‡ç¨‹å…¶å®æ˜¯ä¸€ä¸ªé¢†å¯¼è€…é€‰ä¸¾çš„è¿‡ç¨‹ï¼Œå¦‚é›†ç¾¤å†…æœ‰Nä¸ªæŒæœ‰æ§½çš„ä¸»èŠ‚ ç‚¹ä»£è¡¨æœ‰Nå¼ é€‰ç¥¨ã€‚ç”±äºåœ¨æ¯ä¸ªé…ç½®çºªå…ƒå†…æŒæœ‰æ§½çš„ä¸»èŠ‚ç‚¹åªèƒ½æŠ•ç¥¨ç»™ä¸€ä¸ª ä»èŠ‚ç‚¹ï¼Œå› æ­¤åªèƒ½æœ‰ä¸€ä¸ªä»èŠ‚ç‚¹è·å¾—N/2+1çš„é€‰ç¥¨ï¼Œä¿è¯èƒ½å¤Ÿæ‰¾å‡ºå”¯ä¸€çš„ä»èŠ‚ç‚¹ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-d0e16ea3-6683-43f4-82a3-80478703ae06.png" alt="é€‰ä¸¾æŠ•ç¥¨"></li><li>æ›¿æ¢ä¸»èŠ‚ç‚¹ å½“ä»èŠ‚ç‚¹æ”¶é›†åˆ°è¶³å¤Ÿçš„é€‰ç¥¨ä¹‹åï¼Œè§¦å‘æ›¿æ¢ä¸»èŠ‚ç‚¹æ“ä½œã€‚</li></ol><blockquote><p><strong>éƒ¨ç½²Redisé›†ç¾¤è‡³å°‘éœ€è¦å‡ ä¸ªç‰©ç†èŠ‚ç‚¹ï¼Ÿ</strong></p></blockquote><p>åœ¨æŠ•ç¥¨é€‰ä¸¾çš„ç¯èŠ‚ï¼Œæ•…éšœä¸»èŠ‚ç‚¹ä¹Ÿç®—åœ¨æŠ•ç¥¨æ•°å†…ï¼Œå‡è®¾é›†ç¾¤å†…èŠ‚ç‚¹è§„æ¨¡æ˜¯3ä¸»3ä»ï¼Œå…¶ä¸­æœ‰2 ä¸ªä¸»èŠ‚ç‚¹éƒ¨ç½²åœ¨ä¸€å°æœºå™¨ä¸Šï¼Œå½“è¿™å°æœºå™¨å®•æœºæ—¶ï¼Œç”±äºä»èŠ‚ç‚¹æ— æ³•æ”¶é›†åˆ° 3/2+1ä¸ªä¸»èŠ‚ç‚¹é€‰ç¥¨å°†å¯¼è‡´æ•…éšœè½¬ç§»å¤±è´¥ã€‚è¿™ä¸ªé—®é¢˜ä¹Ÿé€‚ç”¨äºæ•…éšœå‘ç°ç¯èŠ‚ã€‚å› æ­¤éƒ¨ç½²é›†ç¾¤æ—¶æ‰€æœ‰ä¸»èŠ‚ç‚¹æœ€å°‘éœ€è¦éƒ¨ç½²åœ¨3å°ç‰©ç†æœºä¸Šæ‰èƒ½é¿å…å•ç‚¹é—®é¢˜ã€‚</p><h3 id="_25-è¯´è¯´é›†ç¾¤çš„ä¼¸ç¼©" tabindex="-1"><a class="header-anchor" href="#_25-è¯´è¯´é›†ç¾¤çš„ä¼¸ç¼©" aria-hidden="true">#</a> 25.è¯´è¯´é›†ç¾¤çš„ä¼¸ç¼©ï¼Ÿ</h3><p>Redisé›†ç¾¤æä¾›äº†çµæ´»çš„èŠ‚ç‚¹æ‰©å®¹å’Œæ”¶ç¼©æ–¹æ¡ˆï¼Œå¯ä»¥åœ¨ä¸å½±å“é›†ç¾¤å¯¹å¤–æœåŠ¡çš„æƒ…å†µä¸‹ï¼Œä¸ºé›†ç¾¤æ·»åŠ èŠ‚ç‚¹è¿›è¡Œæ‰©å®¹ä¹Ÿå¯ä»¥ä¸‹çº¿éƒ¨åˆ†èŠ‚ç‚¹è¿›è¡Œç¼©å®¹ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-dd3e9494-eddb-4861-85f7-2646018d93f6.png" alt="é›†ç¾¤çš„ä¼¸ç¼©">å…¶å®ï¼Œé›†ç¾¤æ‰©å®¹å’Œç¼©å®¹çš„å…³é”®ç‚¹ï¼Œå°±åœ¨äºæ§½å’ŒèŠ‚ç‚¹çš„å¯¹åº”å…³ç³»ï¼Œæ‰©å®¹å’Œç¼©å®¹å°±æ˜¯å°†ä¸€éƒ¨åˆ†<code>æ§½</code>å’Œ<code>æ•°æ®</code>è¿ç§»ç»™æ–°èŠ‚ç‚¹ã€‚</p><p>ä¾‹å¦‚ä¸‹é¢ä¸€ä¸ªé›†ç¾¤ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯¹åº”è‹¥å¹²ä¸ªæ§½ï¼Œæ¯ä¸ªæ§½å¯¹åº”ä¸€å®šçš„æ•°æ®ï¼Œå¦‚æœå¸Œæœ›åŠ å…¥1ä¸ªèŠ‚ç‚¹å¸Œæœ›å®ç°é›†ç¾¤æ‰©å®¹æ—¶ï¼Œéœ€è¦é€šè¿‡ç›¸å…³å‘½ä»¤æŠŠä¸€éƒ¨åˆ†æ§½å’Œå†…å®¹è¿ç§»ç»™æ–°èŠ‚ç‚¹ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-1d24bb63-2b05-4db9-bd6b-983f16a4830e.png" alt="æ‰©å®¹å®ä¾‹">ç¼©å®¹ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œå…ˆæŠŠæ§½å’Œæ•°æ®è¿ç§»åˆ°å…¶å®ƒèŠ‚ç‚¹ï¼Œå†æŠŠå¯¹åº”çš„èŠ‚ç‚¹ä¸‹çº¿ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/xingbiaogongzhonghao.png" alt=""></p><h2 id="ç¼“å­˜è®¾è®¡" tabindex="-1"><a class="header-anchor" href="#ç¼“å­˜è®¾è®¡" aria-hidden="true">#</a> ç¼“å­˜è®¾è®¡</h2><h3 id="_26-ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©" tabindex="-1"><a class="header-anchor" href="#_26-ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©" aria-hidden="true">#</a> 26.ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©ï¼Ÿ</h3><p>PS:è¿™æ˜¯å¤šå¹´é»„å†çš„è€å…«è‚¡äº†ï¼Œä¸€å®šè¦ç†è§£æ¸…æ¥šã€‚</p><h5 id="ç¼“å­˜å‡»ç©¿" tabindex="-1"><a class="header-anchor" href="#ç¼“å­˜å‡»ç©¿" aria-hidden="true">#</a> ç¼“å­˜å‡»ç©¿</h5><p>ä¸€ä¸ªå¹¶å‘è®¿é—®é‡æ¯”è¾ƒå¤§çš„keyåœ¨æŸä¸ªæ—¶é—´è¿‡æœŸï¼Œå¯¼è‡´æ‰€æœ‰çš„è¯·æ±‚ç›´æ¥æ‰“åœ¨DBä¸Šã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-86579ee6-9dae-4274-a5cc-af6812f48da4.png" alt="ç¼“å­˜å‡»ç©¿"> è§£å†³â½…æ¡ˆï¼š</p><ol><li><p>åŠ é”æ›´æ–°ï¼Œâ½å¦‚è¯·æ±‚æŸ¥è¯¢Aï¼Œå‘ç°ç¼“å­˜ä¸­æ²¡æœ‰ï¼Œå¯¹Aè¿™ä¸ªkeyåŠ é”ï¼ŒåŒæ—¶å»æ•°æ®åº“æŸ¥è¯¢æ•°æ®ï¼Œå†™â¼Šç¼“å­˜ï¼Œå†è¿”å›ç»™â½¤æˆ·ï¼Œè¿™æ ·åâ¾¯çš„è¯·æ±‚å°±å¯ä»¥ä»ç¼“å­˜ä¸­æ‹¿åˆ°æ•°æ®äº†ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-cf63911a-8501-493e-a375-8b47a9f33358.png" alt="åŠ é”æ›´æ–°"></p></li><li><p>å°†è¿‡æœŸæ—¶é—´ç»„åˆå†™åœ¨valueä¸­ï¼Œé€šè¿‡å¼‚æ­¥çš„â½…å¼ä¸æ–­çš„åˆ·æ–°è¿‡æœŸæ—¶é—´ï¼Œé˜²â½Œæ­¤ç±»ç°è±¡ã€‚</p></li></ol><h5 id="ç¼“å­˜ç©¿é€" tabindex="-1"><a class="header-anchor" href="#ç¼“å­˜ç©¿é€" aria-hidden="true">#</a> ç¼“å­˜ç©¿é€</h5><p>ç¼“å­˜ç©¿é€æŒ‡çš„æŸ¥è¯¢ç¼“å­˜å’Œæ•°æ®åº“ä¸­éƒ½ä¸å­˜åœ¨çš„æ•°æ®ï¼Œè¿™æ ·æ¯æ¬¡è¯·æ±‚ç›´æ¥æ‰“åˆ°æ•°æ®åº“ï¼Œå°±å¥½åƒç¼“å­˜ä¸å­˜åœ¨ä¸€æ ·ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-029951e6-8b99-4364-a570-010853deb594.png" alt="ç¼“å­˜ç©¿é€"> ç¼“å­˜ç©¿é€å°†å¯¼è‡´ä¸å­˜åœ¨çš„æ•°æ®æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ°å­˜å‚¨å±‚å»æŸ¥è¯¢ï¼Œå¤±å»äº†ç¼“å­˜ä¿æŠ¤åç«¯å­˜å‚¨çš„æ„ä¹‰ã€‚</p><p>ç¼“å­˜ç©¿é€å¯èƒ½ä¼šä½¿åç«¯å­˜å‚¨è´Ÿè½½åŠ å¤§ï¼Œå¦‚æœå‘ç°å¤§é‡å­˜å‚¨å±‚ç©ºå‘½ä¸­ï¼Œå¯èƒ½å°±æ˜¯å‡ºç°äº†ç¼“å­˜ç©¿é€é—®é¢˜ã€‚</p><p>ç¼“å­˜ç©¿é€å¯èƒ½æœ‰ä¸¤ç§åŸå› ï¼š</p><ol><li>è‡ªèº«ä¸šåŠ¡ä»£ç é—®é¢˜</li><li>æ¶æ„æ”»å‡»ï¼Œçˆ¬è™«é€ æˆç©ºå‘½ä¸­</li></ol><p>å®ƒä¸»è¦æœ‰ä¸¤ç§è§£å†³åŠæ³•ï¼š</p><ul><li><strong>ç¼“å­˜ç©ºå€¼/é»˜è®¤å€¼</strong></li></ul><p>ä¸€ç§æ–¹å¼æ˜¯åœ¨æ•°æ®åº“ä¸å‘½ä¸­ä¹‹åï¼ŒæŠŠä¸€ä¸ªç©ºå¯¹è±¡æˆ–è€…é»˜è®¤å€¼ä¿å­˜åˆ°ç¼“å­˜ï¼Œä¹‹åå†è®¿é—®è¿™ä¸ªæ•°æ®ï¼Œå°±ä¼šä»ç¼“å­˜ä¸­è·å–ï¼Œè¿™æ ·å°±ä¿æŠ¤äº†æ•°æ®åº“ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-288af5a2-ae5a-427a-95e9-b4a658b01386.png" alt="ç¼“å­˜ç©ºå€¼/é»˜è®¤å€¼"></p><p>ç¼“å­˜ç©ºå€¼æœ‰ä¸¤å¤§é—®é¢˜ï¼š</p><ol><li><p>ç©ºå€¼åšäº†ç¼“å­˜ï¼Œæ„å‘³ç€ç¼“å­˜å±‚ä¸­å­˜äº†æ›´å¤šçš„é”®ï¼Œéœ€è¦æ›´å¤šçš„å†…å­˜ç©ºé—´ï¼ˆå¦‚æœæ˜¯æ”»å‡»ï¼Œé—®é¢˜æ›´ä¸¥é‡ï¼‰ï¼Œæ¯”è¾ƒæœ‰æ•ˆçš„æ–¹æ³•æ˜¯é’ˆå¯¹è¿™ç±»æ•°æ®è®¾ç½®ä¸€ä¸ªè¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´ï¼Œè®©å…¶è‡ªåŠ¨å‰”é™¤ã€‚</p></li><li><p>ç¼“å­˜å±‚å’Œå­˜å‚¨å±‚çš„æ•°æ®ä¼šæœ‰ä¸€æ®µæ—¶é—´çª—å£çš„ä¸ä¸€è‡´ï¼Œå¯èƒ½ä¼šå¯¹ä¸šåŠ¡æœ‰ä¸€å®šå½±å“ã€‚ ä¾‹å¦‚è¿‡æœŸæ—¶é—´è®¾ç½®ä¸º5åˆ†é’Ÿï¼Œå¦‚æœæ­¤æ—¶å­˜å‚¨å±‚æ·»åŠ äº†è¿™ä¸ªæ•°æ®ï¼Œé‚£æ­¤æ®µæ—¶é—´å°±ä¼šå‡ºç°ç¼“å­˜å±‚å’Œå­˜å‚¨å±‚æ•°æ®çš„ä¸ä¸€è‡´ã€‚ è¿™æ—¶å€™å¯ä»¥åˆ©ç”¨æ¶ˆæ¯é˜Ÿåˆ—æˆ–è€…å…¶å®ƒå¼‚æ­¥æ–¹å¼æ¸…ç†ç¼“å­˜ä¸­çš„ç©ºå¯¹è±¡ã€‚</p></li></ol><ul><li><strong>å¸ƒéš†è¿‡æ»¤å™¨</strong> é™¤äº†ç¼“å­˜ç©ºå¯¹è±¡ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨å­˜å‚¨å’Œç¼“å­˜ä¹‹å‰ï¼ŒåŠ ä¸€ä¸ªå¸ƒéš†è¿‡æ»¤å™¨ï¼Œåšä¸€å±‚è¿‡æ»¤ã€‚</li></ul><p>å¸ƒéš†è¿‡æ»¤å™¨é‡Œä¼šä¿å­˜æ•°æ®æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœåˆ¤æ–­æ•°æ®ä¸ä¸èƒ½å†ï¼Œå°±ä¸ä¼šè®¿é—®å­˜å‚¨ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-0e18ea40-a2e5-4fa6-989e-e771f6e4b0fc.png" alt="å¸ƒéš†è¿‡æ»¤å™¨"> ä¸¤ç§è§£å†³æ–¹æ¡ˆçš„å¯¹æ¯”ï¼š <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-e8a382c9-4379-44ab-b1dc-fb598a228105.png" alt="ç¼“å­˜ç©ºå¯¹è±¡æ ¸å¸ƒéš†è¿‡æ»¤å™¨æ–¹æ¡ˆå¯¹æ¯”"></p><h5 id="ç¼“å­˜é›ªå´©" tabindex="-1"><a class="header-anchor" href="#ç¼“å­˜é›ªå´©" aria-hidden="true">#</a> ç¼“å­˜é›ªå´©</h5><p>æŸâ¼€æ—¶åˆ»å‘â½£â¼¤è§„æ¨¡çš„ç¼“å­˜å¤±æ•ˆçš„æƒ…å†µï¼Œä¾‹å¦‚ç¼“å­˜æœåŠ¡å®•æœºã€å¤§é‡keyåœ¨åŒä¸€æ—¶é—´è¿‡æœŸï¼Œè¿™æ ·çš„åæœå°±æ˜¯â¼¤é‡çš„è¯·æ±‚è¿›æ¥ç›´æ¥æ‰“åˆ°DBä¸Šï¼Œå¯èƒ½å¯¼è‡´æ•´ä¸ªç³»ç»Ÿçš„å´©æºƒï¼Œç§°ä¸ºé›ªå´©ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-1464fe22-c463-4850-8989-b899510cb10e.png" alt="ç¼“å­˜é›ªå´©"> ç¼“å­˜é›ªå´©æ˜¯ä¸‰å¤§ç¼“å­˜é—®é¢˜é‡Œæœ€ä¸¥é‡çš„ä¸€ç§ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ€ä¹ˆé¢„é˜²å’Œå¤„ç†ã€‚</p><ul><li><strong>æé«˜ç¼“å­˜å¯ç”¨æ€§</strong></li></ul><ol><li>é›†ç¾¤éƒ¨ç½²ï¼šé€šè¿‡é›†ç¾¤æ¥æå‡ç¼“å­˜çš„å¯ç”¨æ€§ï¼Œå¯ä»¥åˆ©ç”¨Redisæœ¬èº«çš„Redis Clusteræˆ–è€…ç¬¬ä¸‰æ–¹é›†ç¾¤æ–¹æ¡ˆå¦‚Codisç­‰ã€‚</li><li>å¤šçº§ç¼“å­˜ï¼šè®¾ç½®å¤šçº§ç¼“å­˜ï¼Œç¬¬ä¸€çº§ç¼“å­˜å¤±æ•ˆçš„åŸºç¡€ä¸Šï¼Œè®¿é—®äºŒçº§ç¼“å­˜ï¼Œæ¯ä¸€çº§ç¼“å­˜çš„å¤±æ•ˆæ—¶é—´éƒ½ä¸åŒã€‚</li></ol><ul><li><strong>è¿‡æœŸæ—¶é—´</strong></li></ul><ol><li>å‡åŒ€è¿‡æœŸï¼šä¸ºäº†é¿å…å¤§é‡çš„ç¼“å­˜åœ¨åŒä¸€æ—¶é—´è¿‡æœŸï¼Œå¯ä»¥æŠŠä¸åŒçš„ key è¿‡æœŸæ—¶é—´éšæœºç”Ÿæˆï¼Œé¿å…è¿‡æœŸæ—¶é—´å¤ªè¿‡é›†ä¸­ã€‚</li><li>çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸã€‚</li></ol><ul><li><strong>ç†”æ–­é™çº§</strong></li></ul><ol><li>æœåŠ¡ç†”æ–­ï¼šå½“ç¼“å­˜æœåŠ¡å™¨å®•æœºæˆ–è¶…æ—¶å“åº”æ—¶ï¼Œä¸ºäº†é˜²æ­¢æ•´ä¸ªç³»ç»Ÿå‡ºç°é›ªå´©ï¼Œæš‚æ—¶åœæ­¢ä¸šåŠ¡æœåŠ¡è®¿é—®ç¼“å­˜ç³»ç»Ÿã€‚</li><li>æœåŠ¡é™çº§ï¼šå½“å‡ºç°å¤§é‡ç¼“å­˜å¤±æ•ˆï¼Œè€Œä¸”å¤„åœ¨é«˜å¹¶å‘é«˜è´Ÿè·çš„æƒ…å†µä¸‹ï¼Œåœ¨ä¸šåŠ¡ç³»ç»Ÿå†…éƒ¨æš‚æ—¶èˆå¼ƒå¯¹ä¸€äº›éæ ¸å¿ƒçš„æ¥å£å’Œæ•°æ®çš„è¯·æ±‚ï¼Œè€Œç›´æ¥è¿”å›ä¸€ä¸ªæå‰å‡†å¤‡å¥½çš„ fallbackï¼ˆé€€è·¯ï¼‰é”™è¯¯å¤„ç†ä¿¡æ¯ã€‚</li></ol><h3 id="_27-èƒ½è¯´è¯´å¸ƒéš†è¿‡æ»¤å™¨å—" tabindex="-1"><a class="header-anchor" href="#_27-èƒ½è¯´è¯´å¸ƒéš†è¿‡æ»¤å™¨å—" aria-hidden="true">#</a> 27.èƒ½è¯´è¯´å¸ƒéš†è¿‡æ»¤å™¨å—ï¼Ÿ</h3><p>å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªè¿ç»­çš„æ•°æ®ç»“æ„ï¼Œæ¯ä¸ªå­˜å‚¨ä½å­˜å‚¨éƒ½æ˜¯ä¸€ä¸ª<code>bit</code>ï¼Œå³<code>0</code>æˆ–è€…<code>1</code>, æ¥æ ‡è¯†æ•°æ®æ˜¯å¦å­˜åœ¨ã€‚</p><p>å­˜å‚¨æ•°æ®çš„æ—¶æ—¶å€™ï¼Œä½¿ç”¨Kä¸ªä¸åŒçš„å“ˆå¸Œå‡½æ•°å°†è¿™ä¸ªå˜é‡æ˜ å°„ä¸ºbitåˆ—è¡¨çš„çš„Kä¸ªç‚¹ï¼ŒæŠŠå®ƒä»¬ç½®ä¸º1ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-d0b8d85c-85dc-4843-b4be-d5d48338a44e.png" alt="å¸ƒéš†è¿‡æ»¤å™¨">æˆ‘ä»¬åˆ¤æ–­ç¼“å­˜keyæ˜¯å¦å­˜åœ¨ï¼ŒåŒæ ·ï¼ŒKä¸ªå“ˆå¸Œå‡½æ•°ï¼Œæ˜ å°„åˆ°bitåˆ—è¡¨ä¸Šçš„Kä¸ªç‚¹ï¼Œåˆ¤æ–­æ˜¯ä¸æ˜¯1ï¼š</p><ul><li>å¦‚æœå…¨ä¸æ˜¯1ï¼Œé‚£ä¹ˆkeyä¸å­˜åœ¨ï¼›</li><li>å¦‚æœéƒ½æ˜¯1ï¼Œä¹Ÿåªæ˜¯è¡¨ç¤ºkeyå¯èƒ½å­˜åœ¨ã€‚</li></ul><p>å¸ƒéš†è¿‡æ»¤å™¨ä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼š</p><ol><li>å®ƒåœ¨åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­æ—¶æ˜¯æœ‰ä¸€å®šé”™è¯¯å‡ ç‡ï¼Œå› ä¸ºå“ˆå¸Œç®—æ³•æœ‰ä¸€å®šçš„ç¢°æ’çš„æ¦‚ç‡ã€‚</li><li>ä¸æ”¯æŒåˆ é™¤å…ƒç´ ã€‚</li></ol><h3 id="_28-å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®çš„ä¸€è‡´æ€§" tabindex="-1"><a class="header-anchor" href="#_28-å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®çš„ä¸€è‡´æ€§" aria-hidden="true">#</a> 28.å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®çš„â¼€è‡´æ€§ï¼Ÿ</h3><p>æ ¹æ®CAPç†è®ºï¼Œåœ¨ä¿è¯å¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§çš„å‰æä¸‹ï¼Œæ— æ³•ä¿è¯ä¸€è‡´æ€§ï¼Œæ‰€ä»¥ç¼“å­˜å’Œæ•°æ®åº“çš„ç»å¯¹ä¸€è‡´æ˜¯ä¸å¯èƒ½å®ç°çš„ï¼Œåªèƒ½å°½å¯èƒ½ä¿å­˜ç¼“å­˜å’Œæ•°æ®åº“çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚</p><h5 id="é€‰æ‹©åˆé€‚çš„ç¼“å­˜æ›´æ–°ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#é€‰æ‹©åˆé€‚çš„ç¼“å­˜æ›´æ–°ç­–ç•¥" aria-hidden="true">#</a> é€‰æ‹©åˆé€‚çš„ç¼“å­˜æ›´æ–°ç­–ç•¥</h5><p><strong>1. åˆ é™¤ç¼“å­˜è€Œä¸æ˜¯æ›´æ–°ç¼“å­˜</strong></p><p>å½“ä¸€ä¸ªçº¿ç¨‹å¯¹ç¼“å­˜çš„keyè¿›è¡Œå†™æ“ä½œçš„æ—¶å€™ï¼Œå¦‚æœå…¶å®ƒçº¿ç¨‹è¿›æ¥è¯»æ•°æ®åº“çš„æ—¶å€™ï¼Œè¯»åˆ°çš„å°±æ˜¯è„æ•°æ®ï¼Œäº§ç”Ÿäº†æ•°æ®ä¸ä¸€è‡´é—®é¢˜ã€‚</p><p>ç›¸æ¯”è¾ƒè€Œè¨€ï¼Œåˆ é™¤ç¼“å­˜çš„é€Ÿåº¦æ¯”æ›´æ–°ç¼“å­˜çš„é€Ÿåº¦å¿«å¾ˆå¤šï¼Œæ‰€ç”¨æ—¶é—´ç›¸å¯¹ä¹Ÿå°‘å¾ˆå¤šï¼Œè¯»è„æ•°æ®çš„æ¦‚ç‡ä¹Ÿå°å¾ˆå¤šã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-ebad0a67-3012-4466-a4dc-e834104c48f8.png" alt="åˆ é™¤ç¼“å­˜å’Œæ›´æ–°ç¼“å­˜"></p><ol start="2"><li><strong>å…ˆæ›´æ•°æ®ï¼Œååˆ ç¼“å­˜</strong> å…ˆæ›´æ•°æ®åº“è¿˜æ˜¯å…ˆåˆ ç¼“å­˜ï¼Ÿè¿™æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚</li></ol><p>æ›´æ–°æ•°æ®ï¼Œè€—æ—¶å¯èƒ½åœ¨åˆ é™¤ç¼“å­˜çš„ç™¾å€ä»¥ä¸Šã€‚åœ¨ç¼“å­˜ä¸­ä¸å­˜åœ¨å¯¹åº”çš„keyï¼Œæ•°æ®åº“åˆæ²¡æœ‰å®Œæˆæ›´æ–°çš„æ—¶å€™ï¼Œå¦‚æœæœ‰çº¿ç¨‹è¿›æ¥è¯»å–æ•°æ®ï¼Œå¹¶å†™å…¥åˆ°ç¼“å­˜ï¼Œé‚£ä¹ˆåœ¨æ›´æ–°æˆåŠŸä¹‹åï¼Œè¿™ä¸ªkeyå°±æ˜¯ä¸€ä¸ªè„æ•°æ®ã€‚</p><p>æ¯«æ— ç–‘é—®ï¼Œå…ˆåˆ ç¼“å­˜ï¼Œå†æ›´æ•°æ®åº“ï¼Œç¼“å­˜ä¸­keyä¸å­˜åœ¨çš„æ—¶é—´çš„æ—¶é—´æ›´é•¿ï¼Œæœ‰æ›´å¤§çš„æ¦‚ç‡ä¼šäº§ç”Ÿè„æ•°æ®ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-5c929a9e-a723-43b3-8f3c-f22c83765f9d.png" alt="å…ˆæ›´æ•°æ®åº“è¿˜æ˜¯å…ˆåˆ ç¼“å­˜">ç›®å‰æœ€æµè¡Œçš„ç¼“å­˜è¯»å†™ç­–ç•¥cache-aside-patternå°±æ˜¯é‡‡ç”¨å…ˆæ›´æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜çš„æ–¹å¼ã€‚</p><h5 id="ç¼“å­˜ä¸ä¸€è‡´å¤„ç†" tabindex="-1"><a class="header-anchor" href="#ç¼“å­˜ä¸ä¸€è‡´å¤„ç†" aria-hidden="true">#</a> ç¼“å­˜ä¸ä¸€è‡´å¤„ç†</h5><p>å¦‚æœä¸æ˜¯å¹¶å‘ç‰¹åˆ«é«˜ï¼Œå¯¹ç¼“å­˜ä¾èµ–æ€§å¾ˆå¼ºï¼Œå…¶å®ä¸€å®šç¨‹åºçš„ä¸ä¸€è‡´æ˜¯å¯ä»¥æ¥å—çš„ã€‚</p><p>ä½†æ˜¯å¦‚æœå¯¹ä¸€è‡´æ€§è¦æ±‚æ¯”è¾ƒé«˜ï¼Œé‚£å°±å¾—æƒ³åŠæ³•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“ä¸­æ•°æ®ä¸€è‡´ã€‚</p><p>ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®ä¸ä¸€è‡´å¸¸è§çš„ä¸¤ç§åŸå› ï¼š</p><ul><li>ç¼“å­˜keyåˆ é™¤å¤±è´¥</li><li>å¹¶å‘å¯¼è‡´å†™å…¥äº†è„æ•°æ®</li></ul><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-51b3453e-e1f1-4c65-9879-2aa59df23eca.png" alt="ç¼“å­˜ä¸€è‡´æ€§"></p><p><strong>æ¶ˆæ¯é˜Ÿåˆ—ä¿è¯keyè¢«åˆ é™¤</strong> å¯ä»¥å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—ï¼ŒæŠŠè¦åˆ é™¤çš„keyæˆ–è€…åˆ é™¤å¤±è´¥çš„keyä¸¢å°½æ¶ˆæ¯é˜Ÿåˆ—ï¼Œåˆ©ç”¨æ¶ˆæ¯é˜Ÿåˆ—çš„é‡è¯•æœºåˆ¶ï¼Œé‡è¯•åˆ é™¤å¯¹åº”çš„keyã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-e4a61193-515a-409f-a436-2733abc3a86e.png" alt="æ¶ˆæ¯é˜Ÿåˆ—ä¿è¯keyè¢«åˆ é™¤">è¿™ç§æ–¹æ¡ˆçœ‹èµ·æ¥ä¸é”™ï¼Œç¼ºç‚¹æ˜¯å¯¹ä¸šåŠ¡ä»£ç æœ‰ä¸€å®šçš„ä¾µå…¥æ€§ã€‚</p><p><strong>æ•°æ®åº“è®¢é˜…+æ¶ˆæ¯é˜Ÿåˆ—ä¿è¯keyè¢«åˆ é™¤</strong> å¯ä»¥ç”¨ä¸€ä¸ªæœåŠ¡ï¼ˆæ¯”å¦‚é˜¿é‡Œçš„ canalï¼‰å»ç›‘å¬æ•°æ®åº“çš„binlogï¼Œè·å–éœ€è¦æ“ä½œçš„æ•°æ®ã€‚</p><p>ç„¶åç”¨ä¸€ä¸ªå…¬å…±çš„æœåŠ¡è·å–è®¢é˜…ç¨‹åºä¼ æ¥çš„ä¿¡æ¯ï¼Œè¿›è¡Œç¼“å­˜åˆ é™¤æ“ä½œã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-37c07418-9cd8-43d9-90e7-0cb43b329025.png" alt="æ•°æ®åº“è®¢é˜…+æ¶ˆæ¯é˜Ÿåˆ—ä¿è¯keyè¢«åˆ é™¤"> è¿™ç§æ–¹å¼é™ä½äº†å¯¹ä¸šåŠ¡çš„ä¾µå…¥ï¼Œä½†å…¶å®æ•´ä¸ªç³»ç»Ÿçš„å¤æ‚åº¦æ˜¯æå‡çš„ï¼Œé€‚åˆåŸºå»ºå®Œå–„çš„å¤§å‚ã€‚</p><p><strong>å»¶æ—¶åŒåˆ é˜²æ­¢è„æ•°æ®</strong> è¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œæ˜¯åœ¨ç¼“å­˜ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œå†™å…¥äº†è„æ•°æ®ï¼Œè¿™ç§æƒ…å†µåœ¨å…ˆåˆ ç¼“å­˜ï¼Œå†æ›´æ•°æ®åº“çš„ç¼“å­˜æ›´æ–°ç­–ç•¥ä¸‹å‘ç”Ÿçš„æ¯”è¾ƒå¤šï¼Œè§£å†³æ–¹æ¡ˆæ˜¯å»¶æ—¶åŒåˆ ã€‚</p><p>ç®€å•è¯´ï¼Œå°±æ˜¯åœ¨ç¬¬ä¸€æ¬¡åˆ é™¤ç¼“å­˜ä¹‹åï¼Œè¿‡äº†ä¸€æ®µæ—¶é—´ä¹‹åï¼Œå†æ¬¡åˆ é™¤ç¼“å­˜ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-fab24753-9c53-4432-9413-5feba07ae1e3.png" alt="å»¶æ—¶åŒåˆ "></p><p>è¿™ç§æ–¹å¼çš„å»¶æ—¶æ—¶é—´è®¾ç½®éœ€è¦ä»”ç»†è€ƒé‡å’Œæµ‹è¯•ã€‚</p><p><strong>è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´å…œåº•</strong></p><p>è¿™æ˜¯ä¸€ä¸ªæœ´ç´ ä½†æ˜¯æœ‰ç”¨çš„åŠæ³•ï¼Œç»™ç¼“å­˜è®¾ç½®ä¸€ä¸ªåˆç†çš„è¿‡æœŸæ—¶é—´ï¼Œå³ä½¿å‘ç”Ÿäº†ç¼“å­˜æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œå®ƒä¹Ÿä¸ä¼šæ°¸è¿œä¸ä¸€è‡´ä¸‹å»ï¼Œç¼“å­˜è¿‡æœŸçš„æ—¶å€™ï¼Œè‡ªç„¶åˆä¼šæ¢å¤ä¸€è‡´ã€‚</p><h3 id="_29-å¦‚ä½•ä¿è¯æœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜çš„ä¸€è‡´" tabindex="-1"><a class="header-anchor" href="#_29-å¦‚ä½•ä¿è¯æœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜çš„ä¸€è‡´" aria-hidden="true">#</a> 29.å¦‚ä½•ä¿è¯æœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜çš„ä¸€è‡´ï¼Ÿ</h3><p>PS:è¿™é“é¢˜é¢è¯•å¾ˆå°‘é—®ï¼Œä½†å®é™…å·¥ä½œä¸­å¾ˆå¸¸è§ã€‚</p><p>åœ¨æ—¥å¸¸çš„å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸é‡‡ç”¨ä¸¤çº§ç¼“å­˜ï¼šæœ¬åœ°ç¼“å­˜+åˆ†å¸ƒå¼ç¼“å­˜ã€‚</p><p>æ‰€è°“æœ¬åœ°ç¼“å­˜ï¼Œå°±æ˜¯å¯¹åº”æœåŠ¡å™¨çš„å†…å­˜ç¼“å­˜ï¼Œæ¯”å¦‚Caffeineï¼Œåˆ†å¸ƒå¼ç¼“å­˜åŸºæœ¬å°±æ˜¯é‡‡ç”¨Redisã€‚</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜æ€ä¹ˆä¿æŒæ•°æ®ä¸€è‡´ï¼Ÿ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-6d4ab7e6-8337-4576-bbf0-79202a1c3331.png" alt="å»¶æ—¶åŒåˆ "> Redisç¼“å­˜ï¼Œæ•°æ®åº“å‘ç”Ÿæ›´æ–°ï¼Œç›´æ¥åˆ é™¤ç¼“å­˜çš„keyå³å¯ï¼Œå› ä¸ºå¯¹äºåº”ç”¨ç³»ç»Ÿè€Œè¨€ï¼Œå®ƒæ˜¯ä¸€ç§ä¸­å¿ƒåŒ–çš„ç¼“å­˜ã€‚</p><p>ä½†æ˜¯æœ¬åœ°ç¼“å­˜ï¼Œå®ƒæ˜¯éä¸­å¿ƒåŒ–çš„ï¼Œæ•£è½åœ¨åˆ†å¸ƒå¼æœåŠ¡çš„å„ä¸ªèŠ‚ç‚¹ä¸Šï¼Œæ²¡æ³•é€šè¿‡å®¢æˆ·ç«¯çš„è¯·æ±‚åˆ é™¤æœ¬åœ°ç¼“å­˜çš„keyï¼Œæ‰€ä»¥å¾—æƒ³åŠæ³•é€šçŸ¥é›†ç¾¤æ‰€æœ‰èŠ‚ç‚¹ï¼Œåˆ é™¤å¯¹åº”çš„æœ¬åœ°ç¼“å­˜keyã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-20c15f0d-fb3c-4922-94b1-edcd856658be.png" alt="æœ¬åœ°ç¼“å­˜/åˆ†å¸ƒå¼ç¼“å­˜ä¿æŒä¸€è‡´"></p><p>å¯ä»¥é‡‡ç”¨æ¶ˆæ¯é˜Ÿåˆ—çš„æ–¹å¼ï¼š</p><ol><li>é‡‡ç”¨Redisæœ¬èº«çš„Pub/Subæœºåˆ¶ï¼Œåˆ†å¸ƒå¼é›†ç¾¤çš„æ‰€æœ‰èŠ‚ç‚¹è®¢é˜…åˆ é™¤æœ¬åœ°ç¼“å­˜é¢‘é“ï¼Œåˆ é™¤Redisç¼“å­˜çš„èŠ‚ç‚¹ï¼ŒåŒäº‹å‘å¸ƒåˆ é™¤æœ¬åœ°ç¼“å­˜æ¶ˆæ¯ï¼Œè®¢é˜…è€…ä»¬è®¢é˜…åˆ°æ¶ˆæ¯åï¼Œåˆ é™¤å¯¹åº”çš„æœ¬åœ°keyã€‚ ä½†æ˜¯Redisçš„å‘å¸ƒè®¢é˜…ä¸æ˜¯å¯é çš„ï¼Œä¸èƒ½ä¿è¯ä¸€å®šåˆ é™¤æˆåŠŸã€‚</li><li>å¼•å…¥ä¸“ä¸šçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ¯”å¦‚RocketMQï¼Œä¿è¯æ¶ˆæ¯çš„å¯é æ€§ï¼Œä½†æ˜¯å¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ã€‚</li><li>è®¾ç½®é€‚å½“çš„è¿‡æœŸæ—¶é—´å…œåº•ï¼Œæœ¬åœ°ç¼“å­˜å¯ä»¥è®¾ç½®ç›¸å¯¹çŸ­ä¸€äº›çš„è¿‡æœŸæ—¶é—´ã€‚</li></ol><h3 id="_30-æ€ä¹ˆå¤„ç†çƒ­key" tabindex="-1"><a class="header-anchor" href="#_30-æ€ä¹ˆå¤„ç†çƒ­key" aria-hidden="true">#</a> 30.æ€ä¹ˆå¤„ç†çƒ­keyï¼Ÿ</h3><blockquote><p><strong>ä»€ä¹ˆæ˜¯çƒ­Keyï¼Ÿ</strong> æ‰€è°“çš„çƒ­keyï¼Œå°±æ˜¯è®¿é—®é¢‘ç‡æ¯”è¾ƒçš„keyã€‚</p></blockquote><p>æ¯”å¦‚ï¼Œçƒ­é—¨æ–°é—»äº‹ä»¶æˆ–å•†å“ï¼Œè¿™ç±»keyé€šå¸¸æœ‰å¤§æµé‡çš„è®¿é—®ï¼Œå¯¹å­˜å‚¨è¿™ç±»ä¿¡æ¯çš„ Redisæ¥è¯´ï¼Œæ˜¯ä¸å°çš„å‹åŠ›ã€‚</p><p>å‡å¦‚Redisé›†ç¾¤éƒ¨ç½²ï¼Œçƒ­keyå¯èƒ½ä¼šé€ æˆæ•´ä½“æµé‡çš„ä¸å‡è¡¡ï¼Œä¸ªåˆ«èŠ‚ç‚¹å‡ºç°OPSè¿‡å¤§çš„æƒ…å†µï¼Œæç«¯æƒ…å†µä¸‹çƒ­ç‚¹keyç”šè‡³ä¼šè¶…è¿‡ Redisæœ¬èº«èƒ½å¤Ÿæ‰¿å—çš„OPSã€‚</p><blockquote><p><strong>æ€ä¹ˆå¤„ç†çƒ­keyï¼Ÿ</strong></p></blockquote><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-6fa972ec-5531-48f2-a608-4465d79d4518.png" alt="çƒ­keyå¤„ç†"> å¯¹çƒ­keyçš„å¤„ç†ï¼Œæœ€å…³é”®çš„æ˜¯å¯¹çƒ­ç‚¹keyçš„ç›‘æ§ï¼Œå¯ä»¥ä»è¿™äº›ç«¯æ¥ç›‘æ§çƒ­ç‚¹key:</p><ol><li><p>å®¢æˆ·ç«¯ å®¢æˆ·ç«¯å…¶å®æ˜¯è·ç¦»keyâ€œæœ€è¿‘â€çš„åœ°æ–¹ï¼Œå› ä¸ºRediså‘½ä»¤å°±æ˜¯ä»å®¢æˆ·ç«¯å‘å‡ºçš„ï¼Œä¾‹å¦‚åœ¨å®¢æˆ·ç«¯è®¾ç½®å…¨å±€å­—å…¸ï¼ˆkeyå’Œè°ƒç”¨æ¬¡æ•°ï¼‰ï¼Œæ¯æ¬¡è°ƒç”¨Rediså‘½ä»¤æ—¶ï¼Œä½¿ç”¨è¿™ä¸ªå­—å…¸è¿›è¡Œè®°å½•ã€‚</p></li><li><p>ä»£ç†ç«¯ åƒTwemproxyã€Codisè¿™äº›åŸºäºä»£ç†çš„Redisåˆ†å¸ƒå¼æ¶æ„ï¼Œæ‰€æœ‰å®¢æˆ·ç«¯çš„è¯·æ±‚éƒ½æ˜¯é€šè¿‡ä»£ç†ç«¯å®Œæˆçš„ï¼Œå¯ä»¥åœ¨ä»£ç†ç«¯è¿›è¡Œæ”¶é›†ç»Ÿè®¡ã€‚</p></li><li><p>RedisæœåŠ¡ç«¯ ä½¿ç”¨monitorå‘½ä»¤ç»Ÿè®¡çƒ­ç‚¹keyæ˜¯å¾ˆå¤šå¼€å‘å’Œè¿ç»´äººå‘˜é¦–å…ˆæƒ³åˆ°ï¼Œmonitorå‘½ä»¤å¯ä»¥ç›‘æ§åˆ°Redisæ‰§è¡Œçš„æ‰€æœ‰å‘½ä»¤ã€‚</p></li></ol><p>åªè¦ç›‘æ§åˆ°äº†çƒ­keyï¼Œå¯¹çƒ­keyçš„å¤„ç†å°±ç®€å•äº†ï¼š</p><ol><li><p>æŠŠçƒ­keyæ‰“æ•£åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œé™ä½å‹â¼’</p></li><li><p>åŠ â¼Šâ¼†çº§ç¼“å­˜ï¼Œæå‰åŠ è½½çƒ­keyæ•°æ®åˆ°å†…å­˜ä¸­ï¼Œå¦‚æœrediså®•æœºï¼Œâ¾›å†…å­˜æŸ¥è¯¢</p></li></ol><h3 id="_31-ç¼“å­˜é¢„çƒ­æ€ä¹ˆåšå‘¢" tabindex="-1"><a class="header-anchor" href="#_31-ç¼“å­˜é¢„çƒ­æ€ä¹ˆåšå‘¢" aria-hidden="true">#</a> 31.ç¼“å­˜é¢„çƒ­æ€ä¹ˆåšå‘¢ï¼Ÿ</h3><p>æ‰€è°“ç¼“å­˜é¢„çƒ­ï¼Œå°±æ˜¯æå‰æŠŠæ•°æ®åº“é‡Œçš„æ•°æ®åˆ·åˆ°ç¼“å­˜é‡Œï¼Œé€šå¸¸æœ‰è¿™äº›æ–¹æ³•ï¼š</p><p>1ã€ç›´æ¥å†™ä¸ªç¼“å­˜åˆ·æ–°é¡µé¢æˆ–è€…æ¥å£ï¼Œä¸Šçº¿æ—¶æ‰‹åŠ¨æ“ä½œ</p><p>2ã€æ•°æ®é‡ä¸å¤§ï¼Œå¯ä»¥åœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨è¿›è¡ŒåŠ è½½</p><p>3ã€å®šæ—¶ä»»åŠ¡åˆ·æ–°ç¼“å­˜.</p><h3 id="_32-çƒ­ç‚¹keyé‡å»º-é—®é¢˜-è§£å†³" tabindex="-1"><a class="header-anchor" href="#_32-çƒ­ç‚¹keyé‡å»º-é—®é¢˜-è§£å†³" aria-hidden="true">#</a> 32.çƒ­ç‚¹keyé‡å»ºï¼Ÿé—®é¢˜ï¼Ÿè§£å†³ï¼Ÿ</h3><p>å¼€å‘çš„æ—¶å€™ä¸€èˆ¬ä½¿ç”¨â€œç¼“å­˜+è¿‡æœŸæ—¶é—´â€çš„ç­–ç•¥ï¼Œæ—¢å¯ä»¥åŠ é€Ÿæ•°æ®è¯»å†™ï¼Œåˆä¿è¯æ•°æ®çš„å®šæœŸæ›´æ–°ï¼Œè¿™ç§æ¨¡å¼åŸºæœ¬èƒ½å¤Ÿæ»¡è¶³ç»å¤§éƒ¨åˆ†éœ€æ±‚ã€‚</p><p>ä½†æ˜¯æœ‰ä¸¤ä¸ªé—®é¢˜å¦‚æœåŒæ—¶å‡ºç°ï¼Œå¯èƒ½å°±ä¼šå‡ºç°æ¯”è¾ƒå¤§çš„é—®é¢˜ï¼š</p><ul><li><p>å½“å‰keyæ˜¯ä¸€ä¸ªçƒ­ç‚¹keyï¼ˆä¾‹å¦‚ä¸€ä¸ªçƒ­é—¨çš„å¨±ä¹æ–°é—»ï¼‰ï¼Œå¹¶å‘é‡éå¸¸å¤§ã€‚</p></li><li><p>é‡å»ºç¼“å­˜ä¸èƒ½åœ¨çŸ­æ—¶é—´å®Œæˆï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªå¤æ‚è®¡ç®—ï¼Œä¾‹å¦‚å¤æ‚çš„ SQLã€å¤šæ¬¡IOã€å¤šä¸ªä¾èµ–ç­‰ã€‚ åœ¨ç¼“å­˜å¤±æ•ˆçš„ç¬é—´ï¼Œæœ‰å¤§é‡çº¿ç¨‹æ¥é‡å»ºç¼“å­˜ï¼Œé€ æˆåç«¯è´Ÿè½½åŠ å¤§ï¼Œç”šè‡³å¯èƒ½ä¼šè®©åº”ç”¨å´©æºƒã€‚</p></li></ul><blockquote><p><strong>æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</strong></p></blockquote><p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ä¹Ÿä¸æ˜¯å¾ˆå¤æ‚ï¼Œè§£å†³é—®é¢˜çš„è¦ç‚¹åœ¨äºï¼š</p><ul><li>å‡å°‘é‡å»ºç¼“å­˜çš„æ¬¡æ•°ã€‚</li><li>æ•°æ®å°½å¯èƒ½ä¸€è‡´ã€‚</li><li>è¾ƒå°‘çš„æ½œåœ¨å±é™©ã€‚</li></ul><p>æ‰€ä»¥ä¸€èˆ¬é‡‡ç”¨å¦‚ä¸‹æ–¹å¼ï¼š</p><ol><li>äº’æ–¥é”ï¼ˆmutex keyï¼‰ è¿™ç§æ–¹æ³•åªå…è®¸ä¸€ä¸ªçº¿ç¨‹é‡å»ºç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾…é‡å»ºç¼“å­˜çš„çº¿ç¨‹æ‰§è¡Œå®Œï¼Œé‡æ–°ä»ç¼“å­˜è·å–æ•°æ®å³å¯ã€‚</li><li>æ°¸è¿œä¸è¿‡æœŸ â€œæ°¸è¿œä¸è¿‡æœŸâ€åŒ…å«ä¸¤å±‚æ„æ€ï¼š</li></ol><ul><li>ä»ç¼“å­˜å±‚é¢æ¥çœ‹ï¼Œç¡®å®æ²¡æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°çƒ­ç‚¹keyè¿‡æœŸåäº§ç”Ÿçš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯â€œç‰©ç†â€ä¸è¿‡æœŸã€‚</li><li>ä»åŠŸèƒ½å±‚é¢æ¥çœ‹ï¼Œä¸ºæ¯ä¸ªvalueè®¾ç½®ä¸€ä¸ªé€»è¾‘è¿‡æœŸæ—¶é—´ï¼Œå½“å‘ç°è¶…è¿‡é€»è¾‘è¿‡æœŸæ—¶é—´åï¼Œä¼šä½¿ç”¨å•ç‹¬çš„çº¿ç¨‹å»æ„å»ºç¼“å­˜ã€‚</li></ul><h3 id="_33-æ— åº•æ´é—®é¢˜å—-å¦‚ä½•è§£å†³" tabindex="-1"><a class="header-anchor" href="#_33-æ— åº•æ´é—®é¢˜å—-å¦‚ä½•è§£å†³" aria-hidden="true">#</a> 33.æ— åº•æ´é—®é¢˜å—ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ</h3><blockquote><p><strong>ä»€ä¹ˆæ˜¯æ— åº•æ´é—®é¢˜ï¼Ÿ</strong></p></blockquote><p>2010å¹´ï¼ŒFacebookçš„MemcacheèŠ‚ç‚¹å·²ç»è¾¾åˆ°äº†3000ä¸ªï¼Œæ‰¿è½½ç€TBçº§åˆ«çš„ç¼“å­˜æ•°æ®ã€‚ä½†å¼€å‘å’Œè¿ç»´äººå‘˜å‘ç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºäº†æ»¡è¶³ä¸šåŠ¡è¦æ±‚æ·»åŠ äº†å¤§é‡æ–°MemcacheèŠ‚ç‚¹ï¼Œä½†æ˜¯å‘ç°æ€§èƒ½ä¸ä½†æ²¡æœ‰å¥½è½¬åè€Œä¸‹é™äº†ï¼Œå½“æ—¶å°†è¿™ ç§ç°è±¡ç§°ä¸ºç¼“å­˜çš„â€œ<strong>æ— åº•æ´</strong>â€ç°è±¡ã€‚</p><p>é‚£ä¹ˆä¸ºä»€ä¹ˆä¼šäº§ç”Ÿè¿™ç§ç°è±¡å‘¢?</p><p>é€šå¸¸æ¥è¯´æ·»åŠ èŠ‚ç‚¹ä½¿å¾—Memcacheé›†ç¾¤ æ€§èƒ½åº”è¯¥æ›´å¼ºäº†ï¼Œä½†äº‹å®å¹¶éå¦‚æ­¤ã€‚é”®å€¼æ•°æ®åº“ç”±äºé€šå¸¸é‡‡ç”¨å“ˆå¸Œå‡½æ•°å°† keyæ˜ å°„åˆ°å„ä¸ªèŠ‚ç‚¹ä¸Šï¼Œé€ æˆkeyçš„åˆ†å¸ƒä¸ä¸šåŠ¡æ— å…³ï¼Œä½†æ˜¯ç”±äºæ•°æ®é‡å’Œè®¿é—®é‡çš„æŒç»­å¢é•¿ï¼Œé€ æˆéœ€è¦æ·»åŠ å¤§é‡èŠ‚ç‚¹åšæ°´å¹³æ‰©å®¹ï¼Œå¯¼è‡´é”®å€¼åˆ†å¸ƒåˆ°æ›´å¤šçš„ èŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥æ— è®ºæ˜¯Memcacheè¿˜æ˜¯Redisçš„åˆ†å¸ƒå¼ï¼Œæ‰¹é‡æ“ä½œé€šå¸¸éœ€è¦ä»ä¸åŒèŠ‚ç‚¹ä¸Šè·å–ï¼Œç›¸æ¯”äºå•æœºæ‰¹é‡æ“ä½œåªæ¶‰åŠä¸€æ¬¡ç½‘ç»œæ“ä½œï¼Œåˆ†å¸ƒå¼æ‰¹é‡æ“ä½œä¼šæ¶‰åŠå¤šæ¬¡ç½‘ç»œæ—¶é—´ã€‚</p><blockquote><p><strong>æ— åº•æ´é—®é¢˜å¦‚ä½•ä¼˜åŒ–å‘¢ï¼Ÿ</strong></p></blockquote><p>å…ˆåˆ†æä¸€ä¸‹æ— åº•æ´é—®é¢˜ï¼š</p><ul><li><p>å®¢æˆ·ç«¯ä¸€æ¬¡æ‰¹é‡æ“ä½œä¼šæ¶‰åŠå¤šæ¬¡ç½‘ç»œæ“ä½œï¼Œä¹Ÿå°±æ„å‘³ç€æ‰¹é‡æ“ä½œä¼šéšç€èŠ‚ç‚¹çš„å¢å¤šï¼Œè€—æ—¶ä¼šä¸æ–­å¢å¤§ã€‚</p></li><li><p>ç½‘ç»œè¿æ¥æ•°å˜å¤šï¼Œå¯¹èŠ‚ç‚¹çš„æ€§èƒ½ä¹Ÿæœ‰ä¸€å®šå½±å“ã€‚</p></li></ul><p>å¸¸è§çš„ä¼˜åŒ–æ€è·¯å¦‚ä¸‹ï¼š</p><ul><li><p>å‘½ä»¤æœ¬èº«çš„ä¼˜åŒ–ï¼Œä¾‹å¦‚ä¼˜åŒ–æ“ä½œè¯­å¥ç­‰ã€‚</p></li><li><p>å‡å°‘ç½‘ç»œé€šä¿¡æ¬¡æ•°ã€‚</p></li><li><p>é™ä½æ¥å…¥æˆæœ¬ï¼Œä¾‹å¦‚å®¢æˆ·ç«¯ä½¿ç”¨é•¿è¿/è¿æ¥æ± ã€NIOç­‰ã€‚</p></li></ul><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/xingbiaogongzhonghao.png" alt=""></p><h2 id="redisè¿ç»´" tabindex="-1"><a class="header-anchor" href="#redisè¿ç»´" aria-hidden="true">#</a> Redisè¿ç»´</h2><h3 id="_34-redisæŠ¥å†…å­˜ä¸è¶³æ€ä¹ˆå¤„ç†" tabindex="-1"><a class="header-anchor" href="#_34-redisæŠ¥å†…å­˜ä¸è¶³æ€ä¹ˆå¤„ç†" aria-hidden="true">#</a> 34.RedisæŠ¥å†…å­˜ä¸è¶³æ€ä¹ˆå¤„ç†ï¼Ÿ</h3><p>Redis å†…å­˜ä¸è¶³æœ‰è¿™ä¹ˆå‡ ç§å¤„ç†æ–¹å¼ï¼š</p><ul><li>ä¿®æ”¹é…ç½®æ–‡ä»¶ redis.conf çš„ maxmemory å‚æ•°ï¼Œå¢åŠ  Redis å¯ç”¨å†…å­˜</li><li>ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤set maxmemoryåŠ¨æ€è®¾ç½®å†…å­˜ä¸Šé™</li><li>ä¿®æ”¹å†…å­˜æ·˜æ±°ç­–ç•¥ï¼ŒåŠæ—¶é‡Šæ”¾å†…å­˜ç©ºé—´</li><li>ä½¿ç”¨ Redis é›†ç¾¤æ¨¡å¼ï¼Œè¿›è¡Œæ¨ªå‘æ‰©å®¹ã€‚</li></ul><h3 id="_35-redisçš„è¿‡æœŸæ•°æ®å›æ”¶ç­–ç•¥æœ‰å“ªäº›" tabindex="-1"><a class="header-anchor" href="#_35-redisçš„è¿‡æœŸæ•°æ®å›æ”¶ç­–ç•¥æœ‰å“ªäº›" aria-hidden="true">#</a> 35.Redisçš„è¿‡æœŸæ•°æ®å›æ”¶ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ</h3><p>Redisä¸»è¦æœ‰2ç§è¿‡æœŸæ•°æ®å›æ”¶ç­–ç•¥ï¼š <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-de726c67-e56f-4f4b-96be-5cb998659541.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><strong>æƒ°æ€§åˆ é™¤</strong></p><p>æƒ°æ€§åˆ é™¤æŒ‡çš„æ˜¯å½“æˆ‘ä»¬æŸ¥è¯¢keyçš„æ—¶å€™æ‰å¯¹keyè¿›â¾æ£€æµ‹ï¼Œå¦‚æœå·²ç»è¾¾åˆ°è¿‡æœŸæ—¶é—´ï¼Œåˆ™åˆ é™¤ã€‚æ˜¾ç„¶ï¼Œä»–æœ‰â¼€ä¸ªç¼ºç‚¹å°±æ˜¯å¦‚æœè¿™äº›è¿‡æœŸçš„keyæ²¡æœ‰è¢«è®¿é—®ï¼Œé‚£ä¹ˆä»–å°±â¼€ç›´â½†æ³•è¢«åˆ é™¤ï¼Œâ½½ä¸”â¼€ç›´å â½¤å†…å­˜ã€‚</p><p><strong>å®šæœŸåˆ é™¤</strong></p><p>å®šæœŸåˆ é™¤æŒ‡çš„æ˜¯Redisæ¯éš”â¼€æ®µæ—¶é—´å¯¹æ•°æ®åº“åšâ¼€æ¬¡æ£€æŸ¥ï¼Œåˆ é™¤â¾¥â¾¯çš„è¿‡æœŸkeyã€‚ç”±äºä¸å¯èƒ½å¯¹æ‰€æœ‰keyå»åšè½®è¯¢æ¥åˆ é™¤ï¼Œæ‰€ä»¥Redisä¼šæ¯æ¬¡éšæœºå–â¼€äº›keyå»åšæ£€æŸ¥å’Œåˆ é™¤ã€‚</p><h3 id="_36-redisæœ‰å“ªäº›å†…å­˜æº¢å‡ºæ§åˆ¶-å†…å­˜æ·˜æ±°ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#_36-redisæœ‰å“ªäº›å†…å­˜æº¢å‡ºæ§åˆ¶-å†…å­˜æ·˜æ±°ç­–ç•¥" aria-hidden="true">#</a> 36.Redisæœ‰å“ªäº›å†…å­˜æº¢å‡ºæ§åˆ¶/å†…å­˜æ·˜æ±°ç­–ç•¥ï¼Ÿ</h3><p>Redisæ‰€ç”¨å†…å­˜è¾¾åˆ°maxmemoryä¸Šé™æ—¶ä¼šè§¦å‘ç›¸åº”çš„æº¢å‡ºæ§åˆ¶ç­–ç•¥ï¼ŒRedisæ”¯æŒå…­ç§ç­–ç•¥ï¼š <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-5be7405c-ee11-4d2b-bea4-9598f10a1b17.png" alt="Rediså…­ç§å†…å­˜æº¢å‡ºæ§åˆ¶ç­–ç•¥"></p><ol><li>noevictionï¼šé»˜è®¤ç­–ç•¥ï¼Œä¸ä¼šåˆ é™¤ä»»ä½•æ•°æ®ï¼Œæ‹’ç»æ‰€æœ‰å†™å…¥æ“ä½œå¹¶è¿” å›å®¢æˆ·ç«¯é”™è¯¯ä¿¡æ¯ï¼Œæ­¤ æ—¶Redisåªå“åº”è¯»æ“ä½œã€‚</li><li>volatile-lruï¼šæ ¹æ®LRUç®—æ³•åˆ é™¤è®¾ç½®äº†è¶…æ—¶å±æ€§ï¼ˆexpireï¼‰çš„é”®ï¼Œç›´ åˆ°è…¾å‡ºè¶³å¤Ÿç©ºé—´ä¸ºæ­¢ã€‚å¦‚æœæ²¡æœ‰å¯åˆ é™¤çš„é”®å¯¹è±¡ï¼Œå›é€€åˆ°noevictionç­–ç•¥ã€‚</li><li>allkeys-lruï¼šæ ¹æ®LRUç®—æ³•åˆ é™¤é”®ï¼Œä¸ç®¡æ•°æ®æœ‰æ²¡æœ‰è®¾ç½®è¶…æ—¶å±æ€§ï¼Œ ç›´åˆ°è…¾å‡ºè¶³å¤Ÿç©ºé—´ä¸ºæ­¢ã€‚</li><li>allkeys-randomï¼šéšæœºåˆ é™¤æ‰€æœ‰é”®ï¼Œç›´åˆ°è…¾å‡ºè¶³å¤Ÿç©ºé—´ä¸ºæ­¢ã€‚</li><li>volatile-randomï¼šéšæœºåˆ é™¤è¿‡æœŸé”®ï¼Œç›´åˆ°è…¾å‡ºè¶³å¤Ÿç©ºé—´ä¸ºæ­¢ã€‚</li><li>volatile-ttlï¼šæ ¹æ®é”®å€¼å¯¹è±¡çš„ttlå±æ€§ï¼Œåˆ é™¤æœ€è¿‘å°†è¦è¿‡æœŸæ•°æ®ã€‚å¦‚æœ æ²¡æœ‰ï¼Œå›é€€åˆ°noevictionç­–ç•¥ã€‚</li></ol><h3 id="_37-redisé˜»å¡-æ€ä¹ˆè§£å†³" tabindex="-1"><a class="header-anchor" href="#_37-redisé˜»å¡-æ€ä¹ˆè§£å†³" aria-hidden="true">#</a> 37.Redisé˜»å¡ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ</h3><p>Rediså‘ç”Ÿé˜»å¡ï¼Œå¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢æ’æŸ¥ï¼š <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-e6a35258-7a78-4489-90b7-e47a4190802b.png" alt="Redisé˜»å¡æ’æŸ¥"></p><ul><li><p><strong>APIæˆ–æ•°æ®ç»“æ„ä½¿ç”¨ä¸åˆç†</strong></p><p>é€šå¸¸Redisæ‰§è¡Œå‘½ä»¤é€Ÿåº¦éå¸¸å¿«ï¼Œä½†æ˜¯ä¸åˆç†åœ°ä½¿ç”¨å‘½ä»¤ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‰§è¡Œé€Ÿåº¦å¾ˆæ…¢ï¼Œå¯¼è‡´é˜»å¡ï¼Œå¯¹äºé«˜å¹¶å‘çš„åœºæ™¯ï¼Œåº”è¯¥å°½é‡é¿å…åœ¨å¤§å¯¹è±¡ä¸Šæ‰§è¡Œç®—æ³•å¤æ‚ åº¦è¶…è¿‡Oï¼ˆnï¼‰çš„å‘½ä»¤ã€‚</p><p>å¯¹æ…¢æŸ¥è¯¢çš„å¤„ç†åˆ†ä¸ºä¸¤æ­¥ï¼š</p><ol><li>å‘ç°æ…¢æŸ¥è¯¢ï¼š slowlog get{n}å‘½ä»¤å¯ä»¥è·å–æœ€è¿‘ çš„næ¡æ…¢æŸ¥è¯¢å‘½ä»¤ï¼›</li><li>å‘ç°æ…¢æŸ¥è¯¢åï¼Œå¯ä»¥ä»ä¸¤ä¸ªæ–¹å‘å»ä¼˜åŒ–æ…¢æŸ¥è¯¢ï¼š 1ï¼‰ä¿®æ”¹ä¸ºä½ç®—æ³•å¤æ‚åº¦çš„å‘½ä»¤ï¼Œå¦‚hgetallæ”¹ä¸ºhmgetç­‰ï¼Œç¦ç”¨keysã€sortç­‰å‘½ ä»¤ 2ï¼‰è°ƒæ•´å¤§å¯¹è±¡ï¼šç¼©å‡å¤§å¯¹è±¡æ•°æ®æˆ–æŠŠå¤§å¯¹è±¡æ‹†åˆ†ä¸ºå¤šä¸ªå°å¯¹è±¡ï¼Œé˜²æ­¢ä¸€æ¬¡å‘½ä»¤æ“ä½œè¿‡å¤šçš„æ•°æ®ã€‚</li></ol></li><li><p><strong>CPUé¥±å’Œçš„é—®é¢˜</strong></p><p>å•çº¿ç¨‹çš„Rediså¤„ç†å‘½ä»¤æ—¶åªèƒ½ä½¿ç”¨ä¸€ä¸ªCPUã€‚è€ŒCPUé¥±å’Œæ˜¯æŒ‡Rediså•æ ¸CPUä½¿ç”¨ç‡è·‘åˆ°æ¥è¿‘100%ã€‚</p><p>é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œå¤„ç†æ­¥éª¤ä¸€èˆ¬å¦‚ä¸‹ï¼š</p><ol><li>åˆ¤æ–­å½“å‰Rediså¹¶å‘é‡æ˜¯å¦å·²ç»è¾¾åˆ°æé™ï¼Œå¯ä»¥ä½¿ç”¨ç»Ÿè®¡å‘½ä»¤redis-cli-h{ip}-p{port}--statè·å–å½“å‰ Redisä½¿ç”¨æƒ…å†µ</li><li>å¦‚æœRedisçš„è¯·æ±‚å‡ ä¸‡+ï¼Œé‚£ä¹ˆå¤§æ¦‚å°±æ˜¯Redisçš„OPSå·²ç»åˆ°äº†æé™ï¼Œåº”è¯¥åšé›†ç¾¤åŒ–æ°´å“æ‰©å±•æ¥åˆ†æ‘ŠOPSå‹åŠ›</li><li>å¦‚æœåªæœ‰å‡ ç™¾å‡ åƒï¼Œé‚£ä¹ˆå°±å¾—æ’æŸ¥å‘½ä»¤å’Œå†…å­˜çš„ä½¿ç”¨</li></ol></li><li><p><strong>æŒä¹…åŒ–ç›¸å…³çš„é˜»å¡</strong></p><p>å¯¹äºå¼€å¯äº†æŒä¹…åŒ–åŠŸèƒ½çš„RedisèŠ‚ç‚¹ï¼Œéœ€è¦æ’æŸ¥æ˜¯å¦æ˜¯æŒä¹…åŒ–å¯¼è‡´çš„é˜»å¡ã€‚</p><ol><li>forké˜»å¡ forkæ“ä½œå‘ç”Ÿåœ¨RDBå’ŒAOFé‡å†™æ—¶ï¼ŒRedisä¸»çº¿ç¨‹è°ƒç”¨forkæ“ä½œäº§ç”Ÿå…±äº« å†…å­˜çš„å­è¿›ç¨‹ï¼Œç”±å­è¿›ç¨‹å®ŒæˆæŒä¹…åŒ–æ–‡ä»¶é‡å†™å·¥ä½œã€‚å¦‚æœforkæ“ä½œæœ¬èº«è€—æ—¶è¿‡é•¿ï¼Œå¿…ç„¶ä¼šå¯¼è‡´ä¸»çº¿ç¨‹çš„é˜»å¡ã€‚</li><li>AOFåˆ·ç›˜é˜»å¡ å½“æˆ‘ä»¬å¼€å¯AOFæŒä¹…åŒ–åŠŸèƒ½æ—¶ï¼Œæ–‡ä»¶åˆ·ç›˜çš„æ–¹å¼ä¸€èˆ¬é‡‡ç”¨æ¯ç§’ä¸€æ¬¡ï¼Œåå°çº¿ç¨‹æ¯ç§’å¯¹AOFæ–‡ä»¶åšfsyncæ“ä½œã€‚å½“ç¡¬ç›˜å‹åŠ›è¿‡å¤§æ—¶ï¼Œfsyncæ“ä½œéœ€è¦ç­‰ å¾…ï¼Œç›´åˆ°å†™å…¥å®Œæˆã€‚å¦‚æœä¸»çº¿ç¨‹å‘ç°è·ç¦»ä¸Šä¸€æ¬¡çš„fsyncæˆåŠŸè¶…è¿‡2ç§’ï¼Œä¸ºäº† æ•°æ®å®‰å…¨æ€§å®ƒä¼šé˜»å¡ç›´åˆ°åå°çº¿ç¨‹æ‰§è¡Œfsyncæ“ä½œå®Œæˆã€‚</li><li>HugePageå†™æ“ä½œé˜»å¡ å¯¹äºå¼€å¯Transparent HugePagesçš„ æ“ä½œç³»ç»Ÿï¼Œæ¯æ¬¡å†™å‘½ä»¤å¼•èµ·çš„å¤åˆ¶å†…å­˜é¡µå•ä½ç”±4Kå˜ä¸º2MBï¼Œæ”¾å¤§äº†512 å€ï¼Œä¼šæ‹–æ…¢å†™æ“ä½œçš„æ‰§è¡Œæ—¶é—´ï¼Œå¯¼è‡´å¤§é‡å†™æ“ä½œæ…¢æŸ¥è¯¢ã€‚</li></ol></li></ul><h3 id="_38-å¤§keyé—®é¢˜äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#_38-å¤§keyé—®é¢˜äº†è§£å—" aria-hidden="true">#</a> 38.å¤§keyé—®é¢˜äº†è§£å—ï¼Ÿ</h3><p>Redisä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæœ‰æ—¶å€™ä¼šå‡ºç°å¤§keyçš„æƒ…å†µï¼Œ æ¯”å¦‚ï¼š</p><ul><li>å•ä¸ªç®€å•çš„keyå­˜å‚¨çš„valueå¾ˆå¤§ï¼Œsizeè¶…è¿‡10KB</li><li>hashï¼Œ setï¼Œzsetï¼Œlist ä¸­å­˜å‚¨è¿‡å¤šçš„å…ƒç´ ï¼ˆä»¥ä¸‡ä¸ºå•ä½ï¼‰</li></ul><blockquote><p><strong>å¤§keyä¼šé€ æˆä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ</strong></p></blockquote><ul><li>å®¢æˆ·ç«¯è€—æ—¶å¢åŠ ï¼Œç”šè‡³è¶…æ—¶</li><li>å¯¹å¤§keyè¿›è¡ŒIOæ“ä½œæ—¶ï¼Œä¼šä¸¥é‡å ç”¨å¸¦å®½å’ŒCPU</li><li>é€ æˆRedisé›†ç¾¤ä¸­æ•°æ®å€¾æ–œ</li><li>ä¸»åŠ¨åˆ é™¤ã€è¢«åŠ¨åˆ ç­‰ï¼Œå¯èƒ½ä¼šå¯¼è‡´é˜»å¡</li></ul><blockquote><p><strong>å¦‚ä½•æ‰¾åˆ°å¤§key?</strong></p></blockquote><ul><li>bigkeyså‘½ä»¤ï¼šä½¿ç”¨bigkeyså‘½ä»¤ä»¥éå†çš„æ–¹å¼åˆ†æRediså®ä¾‹ä¸­çš„æ‰€æœ‰Keyï¼Œå¹¶è¿”å›æ•´ä½“ç»Ÿè®¡ä¿¡æ¯ä¸æ¯ä¸ªæ•°æ®ç±»å‹ä¸­Top1çš„å¤§Key</li><li>redis-rdb-toolsï¼šredis-rdb-toolsæ˜¯ç”±Pythonå†™çš„ç”¨æ¥åˆ†æRedisçš„rdbå¿«ç…§æ–‡ä»¶ç”¨çš„å·¥å…·ï¼Œå®ƒå¯ä»¥æŠŠrdbå¿«ç…§æ–‡ä»¶ç”Ÿæˆjsonæ–‡ä»¶æˆ–è€…ç”ŸæˆæŠ¥è¡¨ç”¨æ¥åˆ†æRedisçš„ä½¿ç”¨è¯¦æƒ…ã€‚</li></ul><blockquote><p><strong>å¦‚ä½•å¤„ç†å¤§key?</strong></p></blockquote><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-e4aaafda-fce1-47f0-8b2b-7261d47b720b.png" alt="å¤§keyå¤„ç†"></p><ul><li><p><strong>åˆ é™¤å¤§key</strong></p><ul><li>å½“Redisç‰ˆæœ¬å¤§äº4.0æ—¶ï¼Œå¯ä½¿ç”¨UNLINKå‘½ä»¤å®‰å…¨åœ°åˆ é™¤å¤§Keyï¼Œè¯¥å‘½ä»¤èƒ½å¤Ÿä»¥éé˜»å¡çš„æ–¹å¼ï¼Œé€æ­¥åœ°æ¸…ç†ä¼ å…¥çš„Keyã€‚</li><li>å½“Redisç‰ˆæœ¬å°äº4.0æ—¶ï¼Œé¿å…ä½¿ç”¨é˜»å¡å¼å‘½ä»¤KEYSï¼Œè€Œæ˜¯å»ºè®®é€šè¿‡SCANå‘½ä»¤æ‰§è¡Œå¢é‡è¿­ä»£æ‰«ækeyï¼Œç„¶ååˆ¤æ–­è¿›è¡Œåˆ é™¤ã€‚</li></ul></li><li><p><strong>å‹ç¼©å’Œæ‹†åˆ†key</strong></p><ul><li>å½“vauleæ˜¯stringæ—¶ï¼Œæ¯”è¾ƒéš¾æ‹†åˆ†ï¼Œåˆ™ä½¿ç”¨åºåˆ—åŒ–ã€å‹ç¼©ç®—æ³•å°†keyçš„å¤§å°æ§åˆ¶åœ¨åˆç†èŒƒå›´å†…ï¼Œä½†æ˜¯åºåˆ—åŒ–å’Œååºåˆ—åŒ–éƒ½ä¼šå¸¦æ¥æ›´å¤šæ—¶é—´ä¸Šçš„æ¶ˆè€—ã€‚</li><li>å½“valueæ˜¯stringï¼Œå‹ç¼©ä¹‹åä»ç„¶æ˜¯å¤§keyï¼Œåˆ™éœ€è¦è¿›è¡Œæ‹†åˆ†ï¼Œä¸€ä¸ªå¤§keyåˆ†ä¸ºä¸åŒçš„éƒ¨åˆ†ï¼Œè®°å½•æ¯ä¸ªéƒ¨åˆ†çš„keyï¼Œä½¿ç”¨multigetç­‰æ“ä½œå®ç°äº‹åŠ¡è¯»å–ã€‚</li><li>å½“valueæ˜¯list/setç­‰é›†åˆç±»å‹æ—¶ï¼Œæ ¹æ®é¢„ä¼°çš„æ•°æ®è§„æ¨¡æ¥è¿›è¡Œåˆ†ç‰‡ï¼Œä¸åŒçš„å…ƒç´ è®¡ç®—ååˆ†åˆ°ä¸åŒçš„ç‰‡ã€‚</li></ul></li></ul><h3 id="_39-rediså¸¸è§æ€§èƒ½é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#_39-rediså¸¸è§æ€§èƒ½é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ" aria-hidden="true">#</a> 39.Rediså¸¸è§æ€§èƒ½é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Ÿ</h3><ol><li>Master æœ€å¥½ä¸è¦åšä»»ä½•æŒä¹…åŒ–å·¥ä½œï¼ŒåŒ…æ‹¬å†…å­˜å¿«ç…§å’Œ AOF æ—¥å¿—æ–‡ä»¶ï¼Œç‰¹åˆ«æ˜¯ä¸è¦å¯ç”¨å†…å­˜å¿«ç…§åšæŒä¹…åŒ–ã€‚</li><li>å¦‚æœæ•°æ®æ¯”è¾ƒå…³é”®ï¼ŒæŸä¸ª Slave å¼€å¯ AOF å¤‡ä»½æ•°æ®ï¼Œç­–ç•¥ä¸ºæ¯ç§’åŒæ­¥ä¸€æ¬¡ã€‚</li><li>ä¸ºäº†ä¸»ä»å¤åˆ¶çš„é€Ÿåº¦å’Œè¿æ¥çš„ç¨³å®šæ€§ï¼ŒSlave å’Œ Master æœ€å¥½åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…ã€‚</li><li>å°½é‡é¿å…åœ¨å‹åŠ›è¾ƒå¤§çš„ä¸»åº“ä¸Šå¢åŠ ä»åº“ã€‚</li><li>Master è°ƒç”¨ BGREWRITEAOF é‡å†™ AOF æ–‡ä»¶ï¼ŒAOF åœ¨é‡å†™çš„æ—¶å€™ä¼šå å¤§é‡çš„ CPU å’Œå†…å­˜èµ„æºï¼Œå¯¼è‡´æœåŠ¡ load è¿‡é«˜ï¼Œå‡ºç°çŸ­æš‚æœåŠ¡æš‚åœç°è±¡ã€‚</li><li>ä¸ºäº† Master çš„ç¨³å®šæ€§ï¼Œä¸»ä»å¤åˆ¶ä¸è¦ç”¨å›¾çŠ¶ç»“æ„ï¼Œç”¨å•å‘é“¾è¡¨ç»“æ„æ›´ç¨³å®šï¼Œå³ä¸»ä»å…³ä¸ºï¼šMaster&lt;â€“Slave1&lt;â€“Slave2&lt;â€“Slave3â€¦ï¼Œè¿™æ ·çš„ç»“æ„ä¹Ÿæ–¹ä¾¿è§£å†³å•ç‚¹æ•…éšœé—®é¢˜ï¼Œå®ç° Slave å¯¹ Master çš„æ›¿æ¢ï¼Œä¹Ÿå³ï¼Œå¦‚æœ Master æŒ‚äº†ï¼Œå¯ä»¥ç«‹é©¬å¯ç”¨ Slave1 åš Masterï¼Œå…¶ä»–ä¸å˜ã€‚</li></ol><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/xingbiaogongzhonghao.png" alt=""></p><h2 id="redisåº”ç”¨" tabindex="-1"><a class="header-anchor" href="#redisåº”ç”¨" aria-hidden="true">#</a> Redisåº”ç”¨</h2><h3 id="_40-ä½¿ç”¨redis-å¦‚ä½•å®ç°å¼‚æ­¥é˜Ÿåˆ—" tabindex="-1"><a class="header-anchor" href="#_40-ä½¿ç”¨redis-å¦‚ä½•å®ç°å¼‚æ­¥é˜Ÿåˆ—" aria-hidden="true">#</a> 40.ä½¿ç”¨Redis å¦‚ä½•å®ç°å¼‚æ­¥é˜Ÿåˆ—ï¼Ÿ</h3><p>æˆ‘ä»¬çŸ¥é“redisæ”¯æŒå¾ˆå¤šç§ç»“æ„çš„æ•°æ®ï¼Œé‚£ä¹ˆå¦‚ä½•ä½¿ç”¨redisä½œä¸ºå¼‚æ­¥é˜Ÿåˆ—ä½¿ç”¨å‘¢ï¼Ÿ ä¸€èˆ¬æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š</p><ul><li><strong>ä½¿ç”¨listä½œä¸ºé˜Ÿåˆ—ï¼Œlpushç”Ÿäº§æ¶ˆæ¯ï¼Œrpopæ¶ˆè´¹æ¶ˆæ¯</strong></li></ul><p>è¿™ç§æ–¹å¼ï¼Œæ¶ˆè´¹è€…æ­»å¾ªç¯rpopä»é˜Ÿåˆ—ä¸­æ¶ˆè´¹æ¶ˆæ¯ã€‚ä½†æ˜¯è¿™æ ·ï¼Œå³ä½¿é˜Ÿåˆ—é‡Œæ²¡æœ‰æ¶ˆæ¯ï¼Œä¹Ÿä¼šè¿›è¡Œrpopï¼Œä¼šå¯¼è‡´Redis CPUçš„æ¶ˆè€—ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-e4b192a1-3ba7-4f4e-98de-e93f437cff7c.png" alt="listä½œä¸ºé˜Ÿåˆ—"> å¯ä»¥é€šè¿‡è®©æ¶ˆè´¹è€…ä¼‘çœ çš„æ–¹å¼çš„æ–¹å¼æ¥å¤„ç†ï¼Œä½†æ˜¯è¿™æ ·åˆä¼šåˆæ¶ˆæ¯çš„å»¶è¿Ÿé—®é¢˜ã€‚</p><p>-<strong>ä½¿ç”¨listä½œä¸ºé˜Ÿåˆ—ï¼Œlpushç”Ÿäº§æ¶ˆæ¯ï¼Œbrpopæ¶ˆè´¹æ¶ˆæ¯</strong></p><p>brpopæ˜¯rpopçš„é˜»å¡ç‰ˆæœ¬ï¼Œlistä¸ºç©ºçš„æ—¶å€™ï¼Œå®ƒä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°listä¸­æœ‰å€¼æˆ–è€…è¶…æ—¶ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-e9581e51-ffc8-4326-9af4-07816743dc88.png" alt="listä½œä¸ºé˜Ÿåˆ—ï¼Œbrpop"></p><p>è¿™ç§æ–¹å¼åªèƒ½å®ç°ä¸€å¯¹ä¸€çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p><ul><li><strong>ä½¿ç”¨Redisçš„pub/subæ¥è¿›è¡Œæ¶ˆæ¯çš„å‘å¸ƒ/è®¢é˜…</strong></li></ul><p>å‘å¸ƒ/è®¢é˜…æ¨¡å¼å¯ä»¥1ï¼šNçš„æ¶ˆæ¯å‘å¸ƒ/è®¢é˜…ã€‚å‘å¸ƒè€…å°†æ¶ˆæ¯å‘å¸ƒåˆ°æŒ‡å®šçš„é¢‘é“é¢‘é“ï¼ˆchannelï¼‰ï¼Œè®¢é˜…ç›¸åº”é¢‘é“çš„å®¢æˆ·ç«¯éƒ½èƒ½æ”¶åˆ°æ¶ˆæ¯ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-bc6d05be-3701-4e23-b4ca-6330c949f020.png" alt="pub/sub"> ä½†æ˜¯è¿™ç§æ–¹å¼ä¸æ˜¯å¯é çš„ï¼Œå®ƒä¸ä¿è¯è®¢é˜…è€…ä¸€å®šèƒ½æ”¶åˆ°æ¶ˆæ¯ï¼Œä¹Ÿä¸è¿›è¡Œæ¶ˆæ¯çš„å­˜å‚¨ã€‚</p><p>æ‰€ä»¥ï¼Œä¸€èˆ¬çš„å¼‚æ­¥é˜Ÿåˆ—çš„å®ç°è¿˜æ˜¯äº¤ç»™ä¸“ä¸šçš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p><h3 id="_41-redis-å¦‚ä½•å®ç°å»¶æ—¶é˜Ÿåˆ—" tabindex="-1"><a class="header-anchor" href="#_41-redis-å¦‚ä½•å®ç°å»¶æ—¶é˜Ÿåˆ—" aria-hidden="true">#</a> 41.Redis å¦‚ä½•å®ç°å»¶æ—¶é˜Ÿåˆ—?</h3><ul><li><strong>ä½¿ç”¨zsetï¼Œåˆ©ç”¨æ’åºå®ç°</strong></li></ul><p>å¯ä»¥ä½¿ç”¨ zsetè¿™ä¸ªç»“æ„ï¼Œç”¨è®¾ç½®å¥½çš„æ—¶é—´æˆ³ä½œä¸ºscoreè¿›è¡Œæ’åºï¼Œä½¿ç”¨ zadd score1 value1 ....å‘½ä»¤å°±å¯ä»¥ä¸€ç›´å¾€å†…å­˜ä¸­ç”Ÿäº§æ¶ˆæ¯ã€‚å†åˆ©ç”¨ zrangebysocre æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰å¾…å¤„ç†çš„ä»»åŠ¡ï¼Œé€šè¿‡å¾ªç¯æ‰§è¡Œé˜Ÿåˆ—ä»»åŠ¡å³å¯ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-54bbcc36-0b00-4142-a6eb-bf2ef48c2213.png" alt="zsetå®ç°å»¶æ—¶é˜Ÿåˆ—"></p><h3 id="_42-redis-æ”¯æŒäº‹åŠ¡å—" tabindex="-1"><a class="header-anchor" href="#_42-redis-æ”¯æŒäº‹åŠ¡å—" aria-hidden="true">#</a> 42.Redis æ”¯æŒäº‹åŠ¡å—ï¼Ÿ</h3><p>Redisæä¾›äº†ç®€å•çš„äº‹åŠ¡ï¼Œä½†å®ƒå¯¹äº‹åŠ¡ACIDçš„æ”¯æŒå¹¶ä¸å®Œå¤‡ã€‚</p><p>multiå‘½ä»¤ä»£è¡¨äº‹åŠ¡å¼€å§‹ï¼Œexecå‘½ä»¤ä»£è¡¨äº‹åŠ¡ç»“æŸï¼Œå®ƒä»¬ä¹‹é—´çš„å‘½ä»¤æ˜¯åŸå­é¡ºåºæ‰§è¡Œçš„ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> multi 
OK
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> sadd user<span class="token operator">:</span>a<span class="token operator">:</span>follow user<span class="token operator">:</span>b 
QUEUED 
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> sadd user<span class="token operator">:</span>b<span class="token operator">:</span>fans user<span class="token operator">:</span>a 
QUEUED
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> sismember user<span class="token operator">:</span>a<span class="token operator">:</span>follow user<span class="token operator">:</span>b 
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> exec <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Redisäº‹åŠ¡çš„åŸç†ï¼Œæ˜¯æ‰€æœ‰çš„æŒ‡ä»¤åœ¨ exec ä¹‹å‰ä¸æ‰§è¡Œï¼Œè€Œæ˜¯ç¼“å­˜åœ¨ æœåŠ¡å™¨çš„ä¸€ä¸ªäº‹åŠ¡é˜Ÿåˆ—ä¸­ï¼ŒæœåŠ¡å™¨ä¸€æ—¦æ”¶åˆ° exec æŒ‡ä»¤ï¼Œæ‰å¼€æ‰§è¡Œæ•´ä¸ªäº‹åŠ¡é˜Ÿåˆ—ï¼Œæ‰§è¡Œå®Œæ¯•åä¸€æ¬¡æ€§è¿”å›æ‰€æœ‰æŒ‡ä»¤çš„è¿è¡Œç»“æœã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-2ed7ae21-16a6-4716-ac89-117a8c76d3db.png" alt="Redisäº‹åŠ¡"></p><p>å› ä¸ºRedisæ‰§è¡Œå‘½ä»¤æ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥è¿™ç»„å‘½ä»¤é¡ºåºæ‰§è¡Œï¼Œè€Œä¸”ä¸ä¼šè¢«å…¶å®ƒçº¿ç¨‹æ‰“æ–­ã€‚</p><p><strong>Redisäº‹åŠ¡çš„æ³¨æ„ç‚¹æœ‰å“ªäº›ï¼Ÿ</strong></p><p>éœ€è¦æ³¨æ„çš„ç‚¹æœ‰ï¼š</p><ul><li><p>Redis äº‹åŠ¡æ˜¯ä¸æ”¯æŒå›æ»šçš„ï¼Œä¸åƒ MySQL çš„äº‹åŠ¡ä¸€æ ·ï¼Œè¦ä¹ˆéƒ½æ‰§è¡Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œï¼›</p></li><li><p>Redis æœåŠ¡ç«¯åœ¨æ‰§è¡Œäº‹åŠ¡çš„è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘é€æ¥çš„å‘½ä»¤è¯·æ±‚æ‰“æ–­ã€‚ç›´åˆ°äº‹åŠ¡å‘½ä»¤å…¨éƒ¨æ‰§è¡Œå®Œæ¯•æ‰ä¼šæ‰§è¡Œå…¶ä»–å®¢æˆ·ç«¯çš„å‘½ä»¤ã€‚</p></li></ul><p><strong>Redis äº‹åŠ¡ä¸ºä»€ä¹ˆä¸æ”¯æŒå›æ»šï¼Ÿ</strong></p><p>Redis çš„äº‹åŠ¡ä¸æ”¯æŒå›æ»šã€‚</p><p>å¦‚æœæ‰§è¡Œçš„å‘½ä»¤æœ‰è¯­æ³•é”™è¯¯ï¼ŒRedis ä¼šæ‰§è¡Œå¤±è´¥ï¼Œè¿™äº›é—®é¢˜å¯ä»¥ä»ç¨‹åºå±‚é¢æ•è·å¹¶è§£å†³ã€‚ä½†æ˜¯å¦‚æœå‡ºç°å…¶ä»–é—®é¢˜ï¼Œåˆ™ä¾ç„¶ä¼šç»§ç»­æ‰§è¡Œä½™ä¸‹çš„å‘½ä»¤ã€‚</p><p>è¿™æ ·åšçš„åŸå› æ˜¯å› ä¸ºå›æ»šéœ€è¦å¢åŠ å¾ˆå¤šå·¥ä½œï¼Œè€Œä¸æ”¯æŒå›æ»šåˆ™å¯ä»¥<strong>ä¿æŒç®€å•ã€å¿«é€Ÿçš„ç‰¹æ€§</strong>ã€‚</p><h3 id="_43-rediså’Œluaè„šæœ¬çš„ä½¿ç”¨äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#_43-rediså’Œluaè„šæœ¬çš„ä½¿ç”¨äº†è§£å—" aria-hidden="true">#</a> 43.Rediså’ŒLuaè„šæœ¬çš„ä½¿ç”¨äº†è§£å—ï¼Ÿ</h3><p>Redisçš„äº‹åŠ¡åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œå¹³æ—¶çš„å¼€å‘ä¸­ï¼Œå¯ä»¥åˆ©ç”¨Luaè„šæœ¬æ¥å¢å¼ºRedisçš„å‘½ä»¤ã€‚</p><p>Luaè„šæœ¬èƒ½ç»™å¼€å‘äººå‘˜å¸¦æ¥è¿™äº›å¥½å¤„ï¼š</p><ul><li>Luaè„šæœ¬åœ¨Redisä¸­æ˜¯åŸå­æ‰§è¡Œçš„ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­é—´ä¸ä¼šæ’å…¥å…¶ä»–å‘½ä»¤ã€‚</li><li>Luaè„šæœ¬å¯ä»¥å¸®åŠ©å¼€å‘å’Œè¿ç»´äººå‘˜åˆ›é€ å‡ºè‡ªå·±å®šåˆ¶çš„å‘½ä»¤ï¼Œå¹¶å¯ä»¥å°†è¿™ äº›å‘½ä»¤å¸¸é©»åœ¨Rediså†…å­˜ä¸­ï¼Œå®ç°å¤ç”¨çš„æ•ˆæœã€‚</li><li>Luaè„šæœ¬å¯ä»¥å°†å¤šæ¡å‘½ä»¤ä¸€æ¬¡æ€§æ‰“åŒ…ï¼Œæœ‰æ•ˆåœ°å‡å°‘ç½‘ç»œå¼€é”€ã€‚</li></ul><p>æ¯”å¦‚è¿™ä¸€æ®µå¾ˆï¼ˆçƒ‚ï¼‰ç»ï¼ˆå¤§ï¼‰å…¸ï¼ˆè¡—ï¼‰çš„ç§’æ€ç³»ç»Ÿåˆ©ç”¨luaæ‰£å‡Redisåº“å­˜çš„è„šæœ¬ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>   <span class="token operator">--</span> åº“å­˜æœªé¢„çƒ­
   <span class="token keyword">if</span> <span class="token punctuation">(</span>redis<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token char">&#39;exists&#39;</span><span class="token punctuation">,</span> KEYS<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> then
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">;</span>
    end<span class="token punctuation">;</span>
    <span class="token operator">--</span> ç§’æ€å•†å“åº“å­˜å­˜åœ¨
    <span class="token keyword">if</span> <span class="token punctuation">(</span>redis<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token char">&#39;exists&#39;</span><span class="token punctuation">,</span> KEYS<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> then
        local stock <span class="token operator">=</span> <span class="token function">tonumber</span><span class="token punctuation">(</span>redis<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token char">&#39;get&#39;</span><span class="token punctuation">,</span> KEYS<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        local num <span class="token operator">=</span> <span class="token function">tonumber</span><span class="token punctuation">(</span>ARGV<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">--</span> å‰©ä½™åº“å­˜å°‘äºè¯·æ±‚æ•°é‡
        <span class="token keyword">if</span> <span class="token punctuation">(</span>stock <span class="token operator">&lt;</span> num<span class="token punctuation">)</span> then
            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">3</span>
        end<span class="token punctuation">;</span>
        <span class="token operator">--</span> æ‰£å‡åº“å­˜
        <span class="token keyword">if</span> <span class="token punctuation">(</span>stock <span class="token operator">&gt;=</span> num<span class="token punctuation">)</span> then
            redis<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token char">&#39;incrby&#39;</span><span class="token punctuation">,</span> KEYS<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token operator">-</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">--</span> æ‰£å‡æˆåŠŸ
            <span class="token keyword">return</span> <span class="token number">1</span>
        end<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>
    end<span class="token punctuation">;</span>
    <span class="token operator">--</span> ç§’æ€å•†å“åº“å­˜ä¸å­˜åœ¨
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_44-redisçš„ç®¡é“äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#_44-redisçš„ç®¡é“äº†è§£å—" aria-hidden="true">#</a> 44.Redisçš„ç®¡é“äº†è§£å—ï¼Ÿ</h3><p>Redis æä¾›ä¸‰ç§å°†å®¢æˆ·ç«¯å¤šæ¡å‘½ä»¤æ‰“åŒ…å‘é€ç»™æœåŠ¡ç«¯æ‰§è¡Œçš„æ–¹å¼ï¼š</p><p>Pipelining(ç®¡é“) ã€ Transactions(äº‹åŠ¡) å’Œ Lua Scripts(Lua è„šæœ¬) ã€‚</p><p><strong>Pipelining</strong>ï¼ˆç®¡é“ï¼‰</p><p>Redis ç®¡é“æ˜¯ä¸‰è€…ä¹‹ä¸­æœ€ç®€å•çš„ï¼Œå½“å®¢æˆ·ç«¯éœ€è¦æ‰§è¡Œå¤šæ¡ redis å‘½ä»¤æ—¶ï¼Œå¯ä»¥é€šè¿‡ç®¡é“ä¸€æ¬¡æ€§å°†è¦æ‰§è¡Œçš„å¤šæ¡å‘½ä»¤å‘é€ç»™æœåŠ¡ç«¯ï¼Œå…¶ä½œç”¨æ˜¯ä¸ºäº†é™ä½ RTT(Round Trip Time) å¯¹æ€§èƒ½çš„å½±å“ï¼Œæ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨ nc å‘½ä»¤å°†ä¸¤æ¡æŒ‡ä»¤å‘é€ç»™ redis æœåŠ¡ç«¯ã€‚</p><p>Redis æœåŠ¡ç«¯æ¥æ”¶åˆ°ç®¡é“å‘é€è¿‡æ¥çš„å¤šæ¡å‘½ä»¤åï¼Œä¼šä¸€ç›´æ‰§å‘½ä»¤ï¼Œå¹¶å°†å‘½ä»¤çš„æ‰§è¡Œç»“æœè¿›è¡Œç¼“å­˜ï¼Œç›´åˆ°æœ€åä¸€æ¡å‘½ä»¤æ‰§è¡Œå®Œæˆï¼Œå†æ‰€æœ‰å‘½ä»¤çš„æ‰§è¡Œç»“æœä¸€æ¬¡æ€§è¿”å›ç»™å®¢æˆ·ç«¯ ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-38aee4c1-efd2-495e-8a6d-164d21a129b1.png" alt="Pipeliningç¤ºæ„å›¾`"></p><p><strong>Pipeliningçš„ä¼˜åŠ¿</strong></p><p>åœ¨æ€§èƒ½æ–¹é¢ï¼Œ Pipelining æœ‰ä¸‹é¢ä¸¤ä¸ªä¼˜åŠ¿ï¼š</p><ul><li><strong>èŠ‚çœäº†RTT</strong>ï¼šå°†å¤šæ¡å‘½ä»¤æ‰“åŒ…ä¸€æ¬¡æ€§å‘é€ç»™æœåŠ¡ç«¯ï¼Œå‡å°‘äº†å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´çš„ç½‘ç»œè°ƒç”¨æ¬¡æ•°</li><li><strong>å‡å°‘äº†ä¸Šä¸‹æ–‡åˆ‡æ¢</strong>ï¼šå½“å®¢æˆ·ç«¯/æœåŠ¡ç«¯éœ€è¦ä»ç½‘ç»œä¸­è¯»å†™æ•°æ®æ—¶ï¼Œéƒ½ä¼šäº§ç”Ÿä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨ï¼Œç³»ç»Ÿè°ƒç”¨æ˜¯éå¸¸è€—æ—¶çš„æ“ä½œï¼Œå…¶ä¸­è®¾è®¡åˆ°ç¨‹åºç”±ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ï¼Œå†ä»å†…æ ¸æ€åˆ‡æ¢å›ç”¨æˆ·æ€çš„è¿‡ç¨‹ã€‚å½“æˆ‘ä»¬æ‰§è¡Œ 10 æ¡ redis å‘½ä»¤çš„æ—¶å€™ï¼Œå°±ä¼šå‘ç”Ÿ 10 æ¬¡ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä½†å¦‚æœæˆ‘ä»¬ä½¿ç”¨ Pipeining å°†å¤šæ¡å‘½ä»¤æ‰“åŒ…æˆä¸€æ¡ä¸€æ¬¡æ€§å‘é€ç»™æœåŠ¡ç«¯ï¼Œå°±åªä¼šäº§ç”Ÿä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</li></ul><h3 id="_45-rediså®ç°åˆ†å¸ƒå¼é”äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#_45-rediså®ç°åˆ†å¸ƒå¼é”äº†è§£å—" aria-hidden="true">#</a> 45.Rediså®ç°åˆ†å¸ƒå¼é”äº†è§£å—ï¼Ÿ</h3><p>Redisæ˜¯åˆ†å¸ƒå¼é”æœ¬è´¨ä¸Šè¦å®ç°çš„ç›®æ ‡å°±æ˜¯åœ¨ Redis é‡Œé¢å ä¸€ä¸ªâ€œèŒ…å‘â€ï¼Œå½“åˆ«çš„è¿›ç¨‹ä¹Ÿè¦æ¥å æ—¶ï¼Œå‘ç°å·²ç»æœ‰äººè¹²åœ¨é‚£é‡Œäº†ï¼Œå°±åªå¥½æ”¾å¼ƒæˆ–è€…ç¨åå†è¯•ã€‚</p><ul><li><strong>V1ï¼šsetnxå‘½ä»¤</strong></li></ul><p>å å‘ä¸€èˆ¬æ˜¯ä½¿ç”¨ setnx(set if not exists) æŒ‡ä»¤ï¼Œåªå…è®¸è¢«ä¸€ä¸ªå®¢æˆ·ç«¯å å‘ã€‚å…ˆæ¥å…ˆå ï¼Œ ç”¨å®Œäº†ï¼Œå†è°ƒç”¨ del æŒ‡ä»¤é‡Šæ”¾èŒ…å‘ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-a5bddceb-66f6-4965-9f16-05d7179697fc.png" alt="setnx(set if not exists)"></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token operator">&gt;</span> setnx lock<span class="token operator">:</span>fighter <span class="token boolean">true</span>
OK
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">do</span> something critical <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">&gt;</span> del lock<span class="token operator">:</span>fighter
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½†æ˜¯æœ‰ä¸ªé—®é¢˜ï¼Œå¦‚æœé€»è¾‘æ‰§è¡Œåˆ°ä¸­é—´å‡ºç°å¼‚å¸¸äº†ï¼Œå¯èƒ½ä¼šå¯¼è‡´ del æŒ‡ä»¤æ²¡æœ‰è¢«è°ƒç”¨ï¼Œè¿™æ ·å°±ä¼šé™·å…¥æ­»é”ï¼Œé”æ°¸è¿œå¾—ä¸åˆ°é‡Šæ”¾ã€‚</p><ul><li><strong>V2:é”è¶…æ—¶é‡Šæ”¾</strong></li></ul><p>æ‰€ä»¥åœ¨æ‹¿åˆ°é”ä¹‹åï¼Œå†ç»™é”åŠ ä¸Šä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œæ¯”å¦‚ 5sï¼Œè¿™æ ·å³ä½¿ä¸­é—´å‡ºç°å¼‚å¸¸ä¹Ÿå¯ä»¥ä¿è¯ 5 ç§’ä¹‹åé”ä¼šè‡ªåŠ¨é‡Šæ”¾ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-2d3de973-c910-4efe-93e9-cfd50f84c91a.png" alt="é”è¶…æ—¶é‡Šæ”¾"></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token operator">&gt;</span> setnx lock<span class="token operator">:</span>fighter <span class="token boolean">true</span>
OK
<span class="token operator">&gt;</span> expire lock<span class="token operator">:</span>fighter <span class="token number">5</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">do</span> something critical <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">&gt;</span> del lock<span class="token operator">:</span>fighter
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½†æ˜¯ä»¥ä¸Šé€»è¾‘è¿˜æœ‰é—®é¢˜ã€‚å¦‚æœåœ¨ setnx å’Œ expire ä¹‹é—´æœåŠ¡å™¨è¿›ç¨‹çªç„¶æŒ‚æ‰äº†ï¼Œå¯èƒ½æ˜¯å› ä¸ºæœºå™¨æ‰ç”µæˆ–è€…æ˜¯è¢«äººä¸ºæ€æ‰çš„ï¼Œå°±ä¼šå¯¼è‡´ expire å¾—ä¸åˆ°æ‰§è¡Œï¼Œä¹Ÿä¼šé€ æˆæ­»é”ã€‚</p><p>è¿™ç§é—®é¢˜çš„æ ¹æºå°±åœ¨äº setnx å’Œ expire æ˜¯ä¸¤æ¡æŒ‡ä»¤è€Œä¸æ˜¯åŸå­æŒ‡ä»¤ã€‚å¦‚æœè¿™ä¸¤æ¡æŒ‡ä»¤å¯ä»¥ä¸€èµ·æ‰§è¡Œå°±ä¸ä¼šå‡ºç°é—®é¢˜ã€‚</p><ul><li><strong>V3:setæŒ‡ä»¤</strong></li></ul><p>è¿™ä¸ªé—®é¢˜åœ¨Redis 2.8 ç‰ˆæœ¬ä¸­å¾—åˆ°äº†è§£å†³ï¼Œè¿™ä¸ªç‰ˆæœ¬åŠ å…¥äº† set æŒ‡ä»¤çš„æ‰©å±•å‚æ•°ï¼Œä½¿å¾— setnx å’Œexpire æŒ‡ä»¤å¯ä»¥ä¸€èµ·æ‰§è¡Œã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-710cdd19-98ea-4e96-b579-ff1ebb0d5de9.png" alt="setåŸå­æŒ‡ä»¤"></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>set lock<span class="token operator">:</span>fighter3 <span class="token boolean">true</span> ex <span class="token number">5</span> nx OK <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">do</span> something critical <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">&gt;</span> del lock<span class="token operator">:</span>codehole
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¸Šé¢è¿™ä¸ªæŒ‡ä»¤å°±æ˜¯ setnx å’Œ expire ç»„åˆåœ¨ä¸€èµ·çš„åŸå­æŒ‡ä»¤ï¼Œè¿™ä¸ªå°±ç®—æ˜¯æ¯”è¾ƒå®Œå–„çš„åˆ†å¸ƒå¼é”äº†ã€‚</p><p>å½“ç„¶å®é™…çš„å¼€å‘ï¼Œæ²¡äººä¼šå»è‡ªå·±å†™åˆ†å¸ƒå¼é”çš„å‘½ä»¤ï¼Œå› ä¸ºæœ‰ä¸“ä¸šçš„è½®å­â€”â€”<strong>Redisson</strong>ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/xingbiaogongzhonghao.png" alt=""></p><h2 id="åº•å±‚ç»“æ„" tabindex="-1"><a class="header-anchor" href="#åº•å±‚ç»“æ„" aria-hidden="true">#</a> åº•å±‚ç»“æ„</h2><p>è¿™ä¸€éƒ¨åˆ†å°±æ¯”è¾ƒæ·±äº†ï¼Œå¦‚æœä¸æ˜¯ç®€å†ä¸Šå†™äº†ç²¾é€šRedisï¼Œåº”è¯¥ä¸ä¼šæ€ä¹ˆé—®ã€‚</p><h3 id="_46-è¯´è¯´redisåº•å±‚æ•°æ®ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_46-è¯´è¯´redisåº•å±‚æ•°æ®ç»“æ„" aria-hidden="true">#</a> 46.è¯´è¯´Redisåº•å±‚æ•°æ®ç»“æ„ï¼Ÿ</h3><p>Redisæœ‰<strong>åŠ¨æ€å­—ç¬¦ä¸²(sds)</strong>ã€<strong>é“¾è¡¨(list)</strong>ã€<strong>å­—å…¸(ht)</strong>ã€<strong>è·³è·ƒè¡¨(skiplist)</strong>ã€<strong>æ•´æ•°é›†åˆ(intset)</strong>ã€<strong>å‹ç¼©åˆ—è¡¨(ziplist)</strong> ç­‰åº•å±‚æ•°æ®ç»“æ„ã€‚</p><p>Rediså¹¶æ²¡æœ‰ä½¿ç”¨è¿™äº›æ•°æ®ç»“æ„æ¥ç›´æ¥å®ç°é”®å€¼å¯¹æ•°æ®åº“ï¼Œè€Œæ˜¯åŸºäºè¿™äº›æ•°æ®ç»“æ„åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ç³»ç»Ÿï¼Œæ¥è¡¨ç¤ºæ‰€æœ‰çš„key-valueã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-a1b2d2f9-6895-4749-9bda-9314f08bca68.png" alt="redisObjectå¯¹åº”çš„æ˜ å°„"> æˆ‘ä»¬å¸¸ç”¨çš„æ•°æ®ç±»å‹å’Œç¼–ç å¯¹åº”çš„æ˜ å°„å…³ç³»ï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-7cf91aa9-8db5-4abe-803e-a9e8f3bcb9e4.png" alt="ç±»å‹-ç¼–ç -ç»“æ„"> ç®€å•çœ‹ä¸€ä¸‹åº•å±‚æ•°æ®ç»“æ„ï¼Œå¦‚æœå¯¹æ•°æ®ç»“æ„æŒæ¡ä¸é”™çš„è¯ï¼Œç†è§£è¿™äº›ç»“æ„åº”è¯¥ä¸æ˜¯ç‰¹åˆ«éš¾ï¼š</p><ol><li><p><strong>å­—ç¬¦ä¸²</strong>ï¼šredisæ²¡æœ‰ç›´æ¥ä½¿â½¤Cè¯­â¾”ä¼ ç»Ÿçš„å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œâ½½æ˜¯â¾ƒâ¼°å®ç°çš„å«åšç®€å•åŠ¨æ€å­—ç¬¦ä¸²SDSçš„æŠ½è±¡ç±»å‹ã€‚</p><p>Cè¯­â¾”çš„å­—ç¬¦ä¸²ä¸è®°å½•â¾ƒèº«çš„â»“åº¦ä¿¡æ¯ï¼Œâ½½SDSåˆ™ä¿å­˜äº†â»“åº¦ä¿¡æ¯ï¼Œè¿™æ ·å°†è·å–å­—ç¬¦ä¸²â»“åº¦çš„æ—¶é—´ç”±O(N)é™ä½åˆ°äº†O(1)ï¼ŒåŒæ—¶å¯ä»¥é¿å…ç¼“å†²åŒºæº¢å‡ºå’Œå‡å°‘ä¿®æ”¹å­—ç¬¦ä¸²â»“åº¦æ—¶æ‰€éœ€çš„å†…å­˜é‡åˆ†é…æ¬¡æ•°ã€‚</p></li></ol><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-7c038f2c-b5ee-4229-9449-713fab3b1855.png" alt="SDS"></p><ol start="2"><li><strong>é“¾è¡¨linkedlist</strong>ï¼šredisé“¾è¡¨æ˜¯â¼€ä¸ªåŒå‘â½†ç¯é“¾è¡¨ç»“æ„ï¼Œå¾ˆå¤šå‘å¸ƒè®¢é˜…ã€æ…¢æŸ¥è¯¢ã€ç›‘è§†å™¨åŠŸèƒ½éƒ½æ˜¯ä½¿â½¤åˆ°äº†é“¾è¡¨æ¥å®ç°ï¼Œæ¯ä¸ªé“¾è¡¨çš„èŠ‚ç‚¹ç”±â¼€ä¸ªlistNodeç»“æ„æ¥è¡¨ç¤ºï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰æŒ‡å‘å‰ç½®èŠ‚ç‚¹å’Œåç½®èŠ‚ç‚¹çš„æŒ‡é’ˆï¼ŒåŒæ—¶è¡¨å¤´èŠ‚ç‚¹çš„å‰ç½®å’Œåç½®èŠ‚ç‚¹éƒ½æŒ‡å‘NULLã€‚</li></ol><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-1adef9c0-8feb-4836-8997-84bda96e2498.png" alt="é“¾è¡¨linkedlist"></p><ol start="3"><li><p><strong>å­—å…¸dict</strong>ï¼šâ½¤äºä¿å­˜é”®å€¼å¯¹çš„æŠ½è±¡æ•°æ®ç»“æ„ã€‚Redisä½¿â½¤hashè¡¨ä½œä¸ºåº•å±‚å®ç°ï¼Œä¸€ä¸ªå“ˆå¸Œè¡¨é‡Œå¯ä»¥æœ‰å¤šä¸ªå“ˆå¸Œè¡¨èŠ‚ç‚¹ï¼Œè€Œæ¯ä¸ªå“ˆå¸Œè¡¨èŠ‚ç‚¹å°±ä¿å­˜äº†å­—å…¸é‡Œä¸­çš„ä¸€ä¸ªé”®å€¼å¯¹ã€‚ æ¯ä¸ªå­—å…¸å¸¦æœ‰ä¸¤ä¸ªhashè¡¨ï¼Œä¾›å¹³æ—¶ä½¿â½¤å’Œrehashæ—¶ä½¿â½¤ï¼Œhashè¡¨ä½¿â½¤é“¾åœ°å€æ³•æ¥è§£å†³é”®å†²çªï¼Œè¢«åˆ†é…åˆ°åŒâ¼€ä¸ªç´¢å¼•ä½ç½®çš„å¤šä¸ªé”®å€¼å¯¹ä¼šå½¢æˆâ¼€ä¸ªå•å‘é“¾è¡¨ï¼Œåœ¨å¯¹hashè¡¨è¿›â¾æ‰©å®¹æˆ–è€…ç¼©å®¹çš„æ—¶å€™ï¼Œä¸ºäº†æœåŠ¡çš„å¯â½¤æ€§ï¼Œrehashçš„è¿‡ç¨‹ä¸æ˜¯â¼€æ¬¡æ€§å®Œæˆçš„ï¼Œâ½½æ˜¯æ¸è¿›å¼çš„ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-9934b4a2-c253-4d42-acf4-c6c940840779.png" alt="å­—å…¸"></p></li><li><p><strong>è·³è·ƒè¡¨skiplist</strong>ï¼šè·³è·ƒè¡¨æ˜¯æœ‰åºé›†åˆçš„åº•å±‚å®ç°ä¹‹â¼€ï¼ŒRedisä¸­åœ¨å®ç°æœ‰åºé›†åˆé”®å’Œé›†ç¾¤èŠ‚ç‚¹çš„å†…éƒ¨ç»“æ„ä¸­éƒ½æ˜¯â½¤åˆ°äº†è·³è·ƒè¡¨ã€‚Redisè·³è·ƒè¡¨ç”±zskiplistå’ŒzskiplistNodeç»„æˆï¼Œzskiplistâ½¤äºä¿å­˜è·³è·ƒè¡¨ä¿¡æ¯ï¼ˆè¡¨å¤´ã€è¡¨å°¾èŠ‚ç‚¹ã€â»“åº¦ç­‰ï¼‰ï¼ŒzskiplistNodeâ½¤äºè¡¨ç¤ºè¡¨è·³è·ƒèŠ‚ç‚¹ï¼Œæ¯ä¸ªè·³è·ƒè¡¨èŠ‚ç‚¹çš„å±‚â¾¼éƒ½æ˜¯1-32çš„éšæœºæ•°ï¼Œåœ¨åŒâ¼€ä¸ªè·³è·ƒè¡¨ä¸­ï¼Œå¤šä¸ªèŠ‚ç‚¹å¯ä»¥åŒ…å«ç›¸åŒçš„åˆ†å€¼ï¼Œä½†æ˜¯æ¯ä¸ªèŠ‚ç‚¹çš„æˆå‘˜å¯¹è±¡å¿…é¡»æ˜¯å”¯â¼€çš„ï¼ŒèŠ‚ç‚¹æŒ‰ç…§åˆ†å€¼â¼¤â¼©æ’åºï¼Œå¦‚æœåˆ†å€¼ç›¸åŒï¼Œåˆ™æŒ‰ç…§æˆå‘˜å¯¹è±¡çš„â¼¤â¼©æ’åºã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-886ee2a8-fb02-4908-bbba-d4ad2a211094.png" alt="è·³è·ƒè¡¨"></p></li><li><p><strong>æ•´æ•°é›†åˆintset</strong>ï¼šâ½¤äºä¿å­˜æ•´æ•°å€¼çš„é›†åˆæŠ½è±¡æ•°æ®ç»“æ„ï¼Œä¸ä¼šå‡ºç°é‡å¤å…ƒç´ ï¼Œåº•å±‚å®ç°ä¸ºæ•°ç»„ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-833dbfb2-7c79-4e7b-a143-8a4a2936cdd8.png" alt="æ•´æ•°é›†åˆintset"></p></li><li><p><strong>å‹ç¼©åˆ—è¡¨ziplist</strong>ï¼šå‹ç¼©åˆ—è¡¨æ˜¯ä¸ºèŠ‚çº¦å†…å­˜â½½å¼€å‘çš„é¡ºåºæ€§æ•°æ®ç»“æ„ï¼Œå®ƒå¯ä»¥åŒ…å«ä»»æ„å¤šä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥ä¿å­˜â¼€ä¸ªå­—èŠ‚æ•°ç»„æˆ–è€…æ•´æ•°å€¼ã€‚</p></li></ol><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-99bcbe82-1d91-41bf-8900-a240856071f5.png" alt="å‹ç¼©åˆ—è¡¨ç»„æˆ"></p><h3 id="_47-redis-çš„-sds-å’Œ-c-ä¸­å­—ç¬¦ä¸²ç›¸æ¯”æœ‰ä»€ä¹ˆä¼˜åŠ¿" tabindex="-1"><a class="header-anchor" href="#_47-redis-çš„-sds-å’Œ-c-ä¸­å­—ç¬¦ä¸²ç›¸æ¯”æœ‰ä»€ä¹ˆä¼˜åŠ¿" aria-hidden="true">#</a> 47.Redis çš„ SDS å’Œ C ä¸­å­—ç¬¦ä¸²ç›¸æ¯”æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ</h3><p>C è¯­è¨€ä½¿ç”¨äº†ä¸€ä¸ªé•¿åº¦ä¸º <code>N+1</code> çš„å­—ç¬¦æ•°ç»„æ¥è¡¨ç¤ºé•¿åº¦ä¸º <code>N</code> çš„å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”å­—ç¬¦æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ æ€»æ˜¯ <code>\0</code>ï¼Œè¿™ç§ç®€å•çš„å­—ç¬¦ä¸²è¡¨ç¤ºæ–¹å¼ ä¸ç¬¦åˆ Redis å¯¹å­—ç¬¦ä¸²åœ¨å®‰å…¨æ€§ã€æ•ˆç‡ä»¥åŠåŠŸèƒ½æ–¹é¢çš„è¦æ±‚ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-2541fd26-4e84-467d-8d8c-c731154a85d7.png" alt="Cè¯­è¨€çš„å­—ç¬¦ä¸²"></p><blockquote><p><strong>Cè¯­è¨€çš„å­—ç¬¦ä¸²å¯èƒ½æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ</strong></p></blockquote><p>è¿™æ ·ç®€å•çš„æ•°æ®ç»“æ„å¯èƒ½ä¼šé€ æˆä»¥ä¸‹ä¸€äº›é—®é¢˜ï¼š</p><ul><li><strong>è·å–å­—ç¬¦ä¸²é•¿åº¦å¤æ‚åº¦é«˜</strong> ï¼šå› ä¸º C ä¸ä¿å­˜æ•°ç»„çš„é•¿åº¦ï¼Œæ¯æ¬¡éƒ½éœ€è¦éå†ä¸€éæ•´ä¸ªæ•°ç»„ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼›</li><li>ä¸èƒ½æœç» <strong>ç¼“å†²åŒºæº¢å‡º/å†…å­˜æ³„æ¼</strong> çš„é—®é¢˜ : Cå­—ç¬¦ä¸²ä¸è®°å½•è‡ªèº«é•¿åº¦å¸¦æ¥çš„å¦å¤–ä¸€ä¸ªé—®é¢˜æ˜¯å®¹æ˜“é€ æˆç¼“å­˜åŒºæº¢å‡ºï¼ˆbuffer overflowï¼‰ï¼Œä¾‹å¦‚åœ¨å­—ç¬¦ä¸²æ‹¼æ¥çš„æ—¶å€™ï¼Œæ–°çš„</li><li>C å­—ç¬¦ä¸² <strong>åªèƒ½ä¿å­˜æ–‡æœ¬æ•°æ®</strong> â†’ å› ä¸º C è¯­è¨€ä¸­çš„å­—ç¬¦ä¸²å¿…é¡»ç¬¦åˆæŸç§ç¼–ç ï¼ˆæ¯”å¦‚ ASCIIï¼‰ï¼Œä¾‹å¦‚ä¸­é—´å‡ºç°çš„ <code>&#39;\0&#39;</code> å¯èƒ½ä¼šè¢«åˆ¤å®šä¸ºæå‰ç»“æŸçš„å­—ç¬¦ä¸²è€Œè¯†åˆ«ä¸äº†ï¼›</li></ul><blockquote><p><strong>Rediså¦‚ä½•è§£å†³ï¼Ÿä¼˜åŠ¿ï¼Ÿ</strong></p></blockquote><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-fc26a4e7-1c8d-4e82-b7f8-1f6b43d16d38.png" alt="Redis sds"></p><p>ç®€å•æ¥è¯´ä¸€ä¸‹ Redis å¦‚ä½•è§£å†³çš„ï¼š</p><ol><li><strong>å¤šå¢åŠ  len è¡¨ç¤ºå½“å‰å­—ç¬¦ä¸²çš„é•¿åº¦</strong>ï¼šè¿™æ ·å°±å¯ä»¥ç›´æ¥è·å–é•¿åº¦äº†ï¼Œå¤æ‚åº¦ O(1)ï¼›</li><li><strong>è‡ªåŠ¨æ‰©å±•ç©ºé—´</strong>ï¼šå½“ SDS éœ€è¦å¯¹å­—ç¬¦ä¸²è¿›è¡Œä¿®æ”¹æ—¶ï¼Œé¦–å…ˆå€ŸåŠ©äº <code>len</code> å’Œ <code>alloc</code> æ£€æŸ¥ç©ºé—´æ˜¯å¦æ»¡è¶³ä¿®æ”¹æ‰€éœ€çš„è¦æ±‚ï¼Œå¦‚æœç©ºé—´ä¸å¤Ÿçš„è¯ï¼ŒSDS ä¼šè‡ªåŠ¨æ‰©å±•ç©ºé—´ï¼Œé¿å…äº†åƒ C å­—ç¬¦ä¸²æ“ä½œä¸­çš„æº¢å‡ºæƒ…å†µï¼›</li><li><strong>æœ‰æ•ˆé™ä½å†…å­˜åˆ†é…æ¬¡æ•°</strong>ï¼šC å­—ç¬¦ä¸²åœ¨æ¶‰åŠå¢åŠ æˆ–è€…æ¸…é™¤æ“ä½œæ—¶ä¼šæ”¹å˜åº•å±‚æ•°ç»„çš„å¤§å°é€ æˆé‡æ–°åˆ†é…ï¼ŒSDS ä½¿ç”¨äº† <strong>ç©ºé—´é¢„åˆ†é…</strong> å’Œ <strong>æƒ°æ€§ç©ºé—´é‡Šæ”¾</strong> æœºåˆ¶ï¼Œç®€å•ç†è§£å°±æ˜¯æ¯æ¬¡åœ¨æ‰©å±•æ—¶æ˜¯æˆå€çš„å¤šåˆ†é…çš„ï¼Œåœ¨ç¼©å®¹æ˜¯ä¹Ÿæ˜¯å…ˆç•™ç€å¹¶ä¸æ­£å¼å½’è¿˜ç»™ OSï¼›</li><li><strong>äºŒè¿›åˆ¶å®‰å…¨</strong>ï¼šC è¯­è¨€å­—ç¬¦ä¸²åªèƒ½ä¿å­˜ <code>ascii</code> ç ï¼Œå¯¹äºå›¾ç‰‡ã€éŸ³é¢‘ç­‰ä¿¡æ¯æ— æ³•ä¿å­˜ï¼ŒSDS æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ï¼Œå†™å…¥ä»€ä¹ˆè¯»å–å°±æ˜¯ä»€ä¹ˆï¼Œä¸åšä»»ä½•è¿‡æ»¤å’Œé™åˆ¶ï¼›</li></ol><h3 id="_48-å­—å…¸æ˜¯å¦‚ä½•å®ç°çš„-rehash-äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#_48-å­—å…¸æ˜¯å¦‚ä½•å®ç°çš„-rehash-äº†è§£å—" aria-hidden="true">#</a> 48.å­—å…¸æ˜¯å¦‚ä½•å®ç°çš„ï¼ŸRehash äº†è§£å—ï¼Ÿ</h3><p>å­—å…¸æ˜¯ Redis æœåŠ¡å™¨ä¸­å‡ºç°æœ€ä¸ºé¢‘ç¹çš„å¤åˆå‹æ•°æ®ç»“æ„ã€‚é™¤äº† <strong>hash</strong> ç»“æ„çš„æ•°æ®ä¼šç”¨åˆ°å­—å…¸å¤–ï¼Œæ•´ä¸ª Redis æ•°æ®åº“çš„æ‰€æœ‰ <code>key</code> å’Œ <code>value</code> ä¹Ÿç»„æˆäº†ä¸€ä¸ª <strong>å…¨å±€å­—å…¸</strong>ï¼Œè¿˜æœ‰å¸¦è¿‡æœŸæ—¶é—´çš„ <code>key</code> ä¹Ÿæ˜¯ä¸€ä¸ªå­—å…¸ã€‚<em>(å­˜å‚¨åœ¨ RedisDb æ•°æ®ç»“æ„ä¸­)</em></p><blockquote><p><strong>å­—å…¸ç»“æ„æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿ</strong></p></blockquote><p><strong>Redis</strong> ä¸­çš„å­—å…¸ç›¸å½“äº Java ä¸­çš„ <strong>HashMap</strong>ï¼Œå†…éƒ¨å®ç°ä¹Ÿå·®ä¸å¤šç±»ä¼¼ï¼Œé‡‡ç”¨å“ˆå¸Œä¸è¿ç®—è®¡ç®—ä¸‹æ ‡ä½ç½®ï¼›é€šè¿‡ <strong>&quot;æ•°ç»„ + é“¾è¡¨&quot; <strong>çš„</strong>é“¾åœ°å€æ³•</strong> æ¥è§£å†³å“ˆå¸Œå†²çªï¼ŒåŒæ—¶è¿™æ ·çš„ç»“æ„ä¹Ÿå¸æ”¶äº†ä¸¤ç§ä¸åŒæ•°æ®ç»“æ„çš„ä¼˜ç‚¹ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-e08347a6-efd5-47c0-9adb-23baff82dbbd.png" alt="Rediså­—å…¸ç»“æ„"></p><blockquote><p><strong>å­—å…¸æ˜¯æ€ä¹ˆæ‰©å®¹çš„ï¼Ÿ</strong></p></blockquote><p>å­—å…¸ç»“æ„å†…éƒ¨åŒ…å« <strong>ä¸¤ä¸ª hashtable</strong>ï¼Œé€šå¸¸æƒ…å†µä¸‹åªæœ‰ä¸€ä¸ªå“ˆå¸Œè¡¨ ht[0] æœ‰å€¼ï¼Œåœ¨æ‰©å®¹çš„æ—¶å€™ï¼ŒæŠŠht[0]é‡Œçš„å€¼rehashåˆ°ht[1]ï¼Œç„¶åè¿›è¡Œ <strong>æ¸è¿›å¼rehash</strong> â€”â€”æ‰€è°“æ¸è¿›å¼rehashï¼ŒæŒ‡çš„æ˜¯è¿™ä¸ªrehashçš„åŠ¨ä½œå¹¶ä¸æ˜¯ä¸€æ¬¡æ€§ã€é›†ä¸­å¼åœ°å®Œæˆçš„ï¼Œè€Œæ˜¯åˆ†å¤šæ¬¡ã€æ¸è¿›å¼åœ°å®Œæˆçš„ã€‚</p><p>å¾…æ¬è¿ç»“æŸåï¼Œh[1]å°±å–ä»£h[0]å­˜å‚¨å­—å…¸çš„å…ƒç´ ã€‚</p><h3 id="_49-è·³è·ƒè¡¨æ˜¯å¦‚ä½•å®ç°çš„-åŸç†" tabindex="-1"><a class="header-anchor" href="#_49-è·³è·ƒè¡¨æ˜¯å¦‚ä½•å®ç°çš„-åŸç†" aria-hidden="true">#</a> 49.è·³è·ƒè¡¨æ˜¯å¦‚ä½•å®ç°çš„ï¼ŸåŸç†ï¼Ÿ</h3><p>PS:è·³è·ƒè¡¨æ˜¯æ¯”è¾ƒå¸¸é—®çš„ä¸€ç§ç»“æ„ã€‚</p><p>è·³è·ƒè¡¨ï¼ˆskiplistï¼‰æ˜¯ä¸€ç§æœ‰åºæ•°æ®ç»“æ„ï¼Œå®ƒé€šè¿‡åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸­ç»´æŒå¤šä¸ªæŒ‡å‘å…¶å®ƒèŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œä»è€Œè¾¾åˆ°å¿«é€Ÿè®¿é—®èŠ‚ç‚¹çš„ç›®çš„ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-08391728-5ba8-42a0-a287-9284451e0ee7.png" alt="è·³è·ƒè¡¨"></p><blockquote><p><strong>ä¸ºä»€ä¹ˆä½¿ç”¨è·³è·ƒè¡¨?</strong></p></blockquote><p>é¦–å…ˆï¼Œå› ä¸º zset è¦æ”¯æŒéšæœºçš„æ’å…¥å’Œåˆ é™¤ï¼Œæ‰€ä»¥å®ƒ <strong>ä¸å®œä½¿ç”¨æ•°ç»„æ¥å®ç°</strong>ï¼Œå…³äºæ’åºé—®é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿå¾ˆå®¹æ˜“å°±æƒ³åˆ° <strong>çº¢é»‘æ ‘/ å¹³è¡¡æ ‘</strong> è¿™æ ·çš„æ ‘å½¢ç»“æ„ï¼Œä¸ºä»€ä¹ˆ Redis ä¸ä½¿ç”¨è¿™æ ·ä¸€äº›ç»“æ„å‘¢ï¼Ÿ</p><ol><li><strong>æ€§èƒ½è€ƒè™‘ï¼š</strong> åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œæ ‘å½¢ç»“æ„éœ€è¦æ‰§è¡Œä¸€äº›ç±»ä¼¼äº rebalance è¿™æ ·çš„å¯èƒ½æ¶‰åŠæ•´æ£µæ ‘çš„æ“ä½œï¼Œç›¸å¯¹æ¥è¯´è·³è·ƒè¡¨çš„å˜åŒ–åªæ¶‰åŠå±€éƒ¨ï¼›</li><li><strong>å®ç°è€ƒè™‘ï¼š</strong> åœ¨å¤æ‚åº¦ä¸çº¢é»‘æ ‘ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œè·³è·ƒè¡¨å®ç°èµ·æ¥æ›´ç®€å•ï¼Œçœ‹èµ·æ¥ä¹Ÿæ›´åŠ ç›´è§‚ï¼›</li></ol><p>åŸºäºä»¥ä¸Šçš„ä¸€äº›è€ƒè™‘ï¼ŒRedis åŸºäº <strong>William Pugh</strong> çš„è®ºæ–‡åšå‡ºä¸€äº›æ”¹è¿›åé‡‡ç”¨äº† <strong>è·³è·ƒè¡¨</strong> è¿™æ ·çš„ç»“æ„ã€‚</p><p>æœ¬è´¨æ˜¯è§£å†³æŸ¥æ‰¾é—®é¢˜ã€‚</p><blockquote><p><strong>è·³è·ƒè¡¨æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</strong></p></blockquote><p>è·³è·ƒè¡¨çš„èŠ‚ç‚¹é‡Œæœ‰è¿™äº›å…ƒç´ ï¼š</p><ul><li><p><strong>å±‚</strong> è·³è·ƒè¡¨èŠ‚ç‚¹çš„levelæ•°ç»„å¯ä»¥åŒ…å«å¤šä¸ªå…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘å…¶å®ƒèŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œç¨‹åºå¯ä»¥é€šè¿‡è¿™äº›å±‚æ¥åŠ å¿«è®¿é—®å…¶å®ƒèŠ‚ç‚¹çš„é€Ÿåº¦ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå±‚çš„æ•°é‡æœˆå¤šï¼Œè®¿é—®å…¶å®ƒèŠ‚ç‚¹çš„é€Ÿåº¦å°±è¶Šå¿«ã€‚</p><p>æ¯æ¬¡åˆ›å»ºä¸€ä¸ªæ–°çš„è·³è·ƒè¡¨èŠ‚ç‚¹çš„æ—¶å€™ï¼Œç¨‹åºéƒ½æ ¹æ®å¹‚æ¬¡å®šå¾‹ï¼Œéšæœºç”Ÿæˆä¸€ä¸ªä»‹äº1å’Œ32ä¹‹é—´çš„å€¼ä½œä¸ºlevelæ•°ç»„çš„å¤§å°ï¼Œè¿™ä¸ªå¤§å°å°±æ˜¯å±‚çš„â€œé«˜åº¦â€</p></li><li><p><strong>å‰è¿›æŒ‡é’ˆ</strong> æ¯ä¸ªå±‚éƒ½æœ‰ä¸€ä¸ªæŒ‡å‘è¡¨å°¾çš„å‰è¿›æŒ‡é’ˆï¼ˆlevel[i].forwardå±æ€§ï¼‰ï¼Œç”¨äºä»è¡¨å¤´å‘è¡¨å°¾æ–¹å‘è®¿é—®èŠ‚ç‚¹ã€‚</p><p>æˆ‘ä»¬çœ‹ä¸€ä¸‹è·³è·ƒè¡¨ä»è¡¨å¤´åˆ°è¡¨å°¾ï¼Œéå†æ‰€æœ‰èŠ‚ç‚¹çš„è·¯å¾„ï¼š <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-b153f782-e2e5-4f98-b251-04f06e16c073.png" alt="é€šè¿‡å‰è¿›æŒ‡é’ˆéå†"></p></li><li><p><strong>è·¨åº¦</strong> å±‚çš„è·¨åº¦ç”¨äºè®°å½•ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è·ç¦»ã€‚è·¨åº¦æ˜¯ç”¨æ¥è®¡ç®—æ’ä½ï¼ˆrankï¼‰çš„ï¼šåœ¨æŸ¥æ‰¾æŸä¸ªèŠ‚ç‚¹çš„è¿‡ç¨‹ä¸­ï¼Œå°†æ²¿é€”è®¿é—®è¿‡çš„æ‰€æœ‰å±‚çš„è·¨åº¦ç´¯è®¡èµ·æ¥ï¼Œå¾—åˆ°çš„ç»“æœå°±æ˜¯ç›®æ ‡èŠ‚ç‚¹åœ¨è·³è·ƒè¡¨ä¸­çš„æ’ä½ã€‚</p><p>ä¾‹å¦‚æŸ¥æ‰¾ï¼Œåˆ†å€¼ä¸º3.0ã€æˆå‘˜å¯¹è±¡ä¸ºo3çš„èŠ‚ç‚¹æ—¶ï¼Œæ²¿é€”ç»å†çš„å±‚ï¼šæŸ¥æ‰¾çš„è¿‡ç¨‹åªç»è¿‡äº†ä¸€ä¸ªå±‚ï¼Œå¹¶ä¸”å±‚çš„è·¨åº¦ä¸º3ï¼Œæ‰€ä»¥ç›®æ ‡èŠ‚ç‚¹åœ¨è·³è·ƒè¡¨ä¸­çš„æ’ä½ä¸º3ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-d2395b7e-2f31-4ca8-b06d-2cb47afaeb74.png" alt="è®¡ç®—èŠ‚ç‚¹çš„æ’ä½"></p></li><li><p><strong>åˆ†å€¼å’Œæˆå‘˜</strong> èŠ‚ç‚¹çš„åˆ†å€¼ï¼ˆscoreå±æ€§ï¼‰æ˜¯ä¸€ä¸ªdoubleç±»å‹çš„æµ®ç‚¹æ•°ï¼Œè·³è·ƒè¡¨ä¸­æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½æŒ‰åˆ†å€¼ä»å°åˆ°å¤§æ¥æ’åºã€‚</p><p>èŠ‚ç‚¹çš„æˆå‘˜å¯¹è±¡ï¼ˆobjå±æ€§ï¼‰æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒæŒ‡å‘ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Œè€Œå­—ç¬¦ä¸²å¯¹è±¡åˆ™ä¿å­˜è¿™ä¸€ä¸ªSDSå€¼ã€‚</p></li></ul><h3 id="_50-å‹ç¼©åˆ—è¡¨äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#_50-å‹ç¼©åˆ—è¡¨äº†è§£å—" aria-hidden="true">#</a> 50.å‹ç¼©åˆ—è¡¨äº†è§£å—ï¼Ÿ</h3><p>å‹ç¼©åˆ—è¡¨æ˜¯ Redis <strong>ä¸ºäº†èŠ‚çº¦å†…å­˜</strong> è€Œä½¿ç”¨çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œæ˜¯ç”±ä¸€ç³»åˆ—ç‰¹æ®Šç¼–ç çš„è¿ç»­å†…å­˜å¿«ç»„æˆçš„é¡ºåºå‹æ•°æ®ç»“æ„ã€‚</p><p>ä¸€ä¸ªå‹ç¼©åˆ—è¡¨å¯ä»¥åŒ…å«ä»»æ„å¤šä¸ªèŠ‚ç‚¹ï¼ˆentryï¼‰ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥ä¿å­˜ä¸€ä¸ªå­—èŠ‚æ•°ç»„æˆ–è€…ä¸€ä¸ªæ•´æ•°å€¼ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-6be492f7-9f92-4607-a4c4-81a612a3d7bd.png" alt="å‹ç¼©åˆ—è¡¨ç»„æˆéƒ¨åˆ†">å‹ç¼©åˆ—è¡¨ç”±è¿™ä¹ˆå‡ éƒ¨åˆ†ç»„æˆï¼š</p><ul><li><strong>zlbyttes</strong>:è®°å½•æ•´ä¸ªå‹ç¼©åˆ—è¡¨å ç”¨çš„å†…å­˜å­—èŠ‚æ•°</li><li><strong>zltail</strong>:è®°å½•å‹ç¼©åˆ—è¡¨è¡¨å°¾èŠ‚ç‚¹è·ç¦»å‹ç¼©åˆ—è¡¨çš„èµ·å§‹åœ°å€æœ‰å¤šå°‘å­—èŠ‚</li><li><strong>zllen</strong>:è®°å½•å‹ç¼©åˆ—è¡¨åŒ…å«çš„èŠ‚ç‚¹æ•°é‡</li><li><strong>entryX</strong>:åˆ—è¡¨èŠ‚ç‚¹</li><li><strong>zlend</strong>:ç”¨äºæ ‡è®°å‹ç¼©åˆ—è¡¨çš„æœ«ç«¯</li></ul><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-b5d224c2-53ee-40a3-9efc-2feb7dd3d7a8.png" alt="å‹ç¼©åˆ—è¡¨ç¤ºä¾‹"></p><h3 id="_51-å¿«é€Ÿåˆ—è¡¨-quicklist-äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#_51-å¿«é€Ÿåˆ—è¡¨-quicklist-äº†è§£å—" aria-hidden="true">#</a> 51.å¿«é€Ÿåˆ—è¡¨ quicklist äº†è§£å—ï¼Ÿ</h3><p>Redis æ—©æœŸç‰ˆæœ¬å­˜å‚¨ list åˆ—è¡¨æ•°æ®ç»“æ„ä½¿ç”¨çš„æ˜¯å‹ç¼©åˆ—è¡¨ ziplist å’Œæ™®é€šçš„åŒå‘é“¾è¡¨ linkedlistï¼Œä¹Ÿå°±æ˜¯è¯´å½“å…ƒç´ å°‘æ—¶ä½¿ç”¨ ziplistï¼Œå½“å…ƒç´ å¤šæ—¶ç”¨ linkedlistã€‚</p><p>ä½†è€ƒè™‘åˆ°é“¾è¡¨çš„é™„åŠ ç©ºé—´ç›¸å¯¹è¾ƒé«˜ï¼Œ<code>prev</code> å’Œ <code>next</code> æŒ‡é’ˆå°±è¦å å» <code>16</code> ä¸ªå­—èŠ‚ï¼ˆ64 ä½æ“ä½œç³»ç»Ÿå ç”¨ <code>8</code> ä¸ªå­—èŠ‚ï¼‰ï¼Œå¦å¤–æ¯ä¸ªèŠ‚ç‚¹çš„å†…å­˜éƒ½æ˜¯å•ç‹¬åˆ†é…ï¼Œä¼šå®¶å…·å†…å­˜çš„ç¢ç‰‡åŒ–ï¼Œå½±å“å†…å­˜ç®¡ç†æ•ˆç‡ã€‚</p><p>åæ¥ Redis æ–°ç‰ˆæœ¬ï¼ˆ3.2ï¼‰å¯¹åˆ—è¡¨æ•°æ®ç»“æ„è¿›è¡Œäº†æ”¹é€ ï¼Œä½¿ç”¨ <code>quicklist</code> ä»£æ›¿äº† <code>ziplist</code> å’Œ <code>linkedlist</code>ï¼Œquicklistæ˜¯ç»¼åˆè€ƒè™‘äº†æ—¶é—´æ•ˆç‡ä¸ç©ºé—´æ•ˆç‡å¼•å…¥çš„æ–°å‹æ•°æ®ç»“æ„ã€‚</p><p>quicklistç”±listå’Œziplistç»“åˆè€Œæˆï¼Œå®ƒæ˜¯ä¸€ä¸ªç”±ziplistå……å½“èŠ‚ç‚¹çš„åŒå‘é“¾è¡¨ã€‚ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/redis-3b9785b0-6573-4c2d-8b7d-d5d1be799e26.png" alt="quicklist"></p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/xingbiaogongzhonghao.png" alt=""></p><h2 id="å…¶ä»–é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#å…¶ä»–é—®é¢˜" aria-hidden="true">#</a> å…¶ä»–é—®é¢˜</h2><h3 id="_52-å‡å¦‚redisé‡Œé¢æœ‰1äº¿ä¸ªkey-å…¶ä¸­æœ‰10wä¸ªkeyæ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„-å¦‚ä½•å°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥" tabindex="-1"><a class="header-anchor" href="#_52-å‡å¦‚redisé‡Œé¢æœ‰1äº¿ä¸ªkey-å…¶ä¸­æœ‰10wä¸ªkeyæ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„-å¦‚ä½•å°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥" aria-hidden="true">#</a> 52.å‡å¦‚Redisé‡Œé¢æœ‰1äº¿ä¸ªkeyï¼Œå…¶ä¸­æœ‰10wä¸ªkeyæ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„ï¼Œå¦‚ä½•å°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥ï¼Ÿ</h3><p>ä½¿ç”¨ <code>keys</code> æŒ‡ä»¤å¯ä»¥æ‰«å‡ºæŒ‡å®šæ¨¡å¼çš„ key åˆ—è¡¨ã€‚ä½†æ˜¯è¦æ³¨æ„ keys æŒ‡ä»¤ä¼šå¯¼è‡´çº¿ç¨‹é˜»å¡ä¸€æ®µæ—¶é—´ï¼Œçº¿ä¸ŠæœåŠ¡ä¼šåœé¡¿ï¼Œç›´åˆ°æŒ‡ä»¤æ‰§è¡Œå®Œæ¯•ï¼ŒæœåŠ¡æ‰èƒ½æ¢å¤ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨ <code>scan</code> æŒ‡ä»¤ï¼Œ<code>scan</code> æŒ‡ä»¤å¯ä»¥æ— é˜»å¡çš„æå–å‡ºæŒ‡å®šæ¨¡å¼çš„ <code>key</code> åˆ—è¡¨ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€å®šçš„é‡å¤æ¦‚ç‡ï¼Œåœ¨å®¢æˆ·ç«¯åšä¸€æ¬¡å»é‡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯æ•´ä½“æ‰€èŠ±è´¹çš„æ—¶é—´ä¼šæ¯”ç›´æ¥ç”¨ <code>keys</code> æŒ‡ä»¤é•¿ã€‚</p><hr><blockquote><p>å›¾æ–‡è¯¦è§£ 53 é“Redisé¢è¯•é«˜é¢‘é¢˜ï¼Œè¿™æ¬¡åŠæ‰“é¢è¯•å®˜ï¼Œæˆ‘è§‰å¾—ç¨³äº†ï¼ˆæ‰‹åŠ¨ dogï¼‰ã€‚æ•´ç†ï¼šæ²‰é»˜ç‹äºŒï¼Œæˆ³<a href="https://mp.weixin.qq.com/s/19u34NXALB1nOlBCE6Eg-Q" target="_blank" rel="noopener noreferrer">è½¬è½½é“¾æ¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œä½œè€…ï¼šä¸‰åˆ†æ¶ï¼Œæˆ³<a href="https://mp.weixin.qq.com/s/iJtNJYgirRugNBnzxkbB4Q" target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚</p></blockquote></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/itwanger/toBeBetterJavaer/edit/master/docs/sidebar/sanfene/redis.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="info">2022/5/9 ä¸‹åˆ2:49:16</span></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: www.qing_gee@163.com">itwanger</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/sidebar/sanfene/spring.html" class="nav-link prev" aria-label="Spring"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Spring</div></a><a href="/sidebar/sanfene/mybatis.html" class="nav-link next" aria-label="MyBatis"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">MyBatis<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"><a href="https://beian.miit.gov.cn/" target="_blank">è±«ICPå¤‡2021038026å·-1</a><img src="https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/beian.png" height="15px" width="15px" /><a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41030502000411"><span>è±«å…¬ç½‘å®‰å¤‡ 41030502000411å·</span></a></div><div class="copyright">Copyright Â© 2022 æ²‰é»˜ç‹äºŒ</div></footer><!--]--></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app.df242bb6.js" defer></script>
  </body>
</html>
