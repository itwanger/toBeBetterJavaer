import{_ as s}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as r,c as l,a as e,d as n,b as a,e as t,r as d}from"./app.99eb8281.js";const c={},o=t(`<p>Java åç«¯é¢è¯•çš„æ—¶å€™ï¼Œé¢è¯•å®˜ç»å¸¸ä¼šé—®åˆ° @Transactional çš„åŸç†ï¼Œä»¥åŠå®¹æ˜“è¸©çš„å‘ï¼Œä¹‹å‰ä¸€é¢ç™¾åº¦ï¼Œå°±é‡åˆ°è¿‡ï¼Œä»Šå¤©å°±å¸¦å¤§å®¶æŠŠè¿™å‡ å—çŸ¥è¯†åƒé€ã€‚</p><p>è¿™ç¯‡æ–‡ç« ï¼Œ<strong>ä¼šå…ˆè®²è¿° @Transactional çš„ 4 ç§ä¸ç”Ÿæ•ˆçš„ Caseï¼Œç„¶åå†é€šè¿‡æºç è§£è¯»ï¼Œåˆ†æ @Transactional çš„æ‰§è¡ŒåŸç†ï¼Œä»¥åŠéƒ¨åˆ† Case ä¸ç”Ÿæ•ˆçš„çœŸæ­£åŸå› ã€‚</strong></p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-912703df-775a-48b9-abbb-0e951d9da1bf.jpg" alt="" loading="lazy"></p><h2 id="é¡¹ç›®å‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®å‡†å¤‡" aria-hidden="true">#</a> é¡¹ç›®å‡†å¤‡</h2><p>ä¸‹é¢æ˜¯ DB æ•°æ®å’Œ DB æ“ä½œæ¥å£ï¼š</p><table><thead><tr><th>uid</th><th>uname</th><th>usex</th></tr></thead><tbody><tr><td>1</td><td>å¼ ä¸‰</td><td>å¥³</td></tr><tr><td>2</td><td>é™ˆæ’</td><td>ç”·</td></tr><tr><td>3</td><td>æ¥¼ä»”</td><td>ç”·</td></tr></tbody></table><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>// æä¾›çš„æ¥å£
public interface UserDao {
    // select * from user_test where uid = &quot;#{uid}&quot;
    public MyUser selectUserById(Integer uid);
    // update user_test set uname =#{uname},usex = #{usex} where uid = #{uid}
    public int updateUser(MyUser user);
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŸºç¡€æµ‹è¯•ä»£ç ï¼ŒtestSuccess() æ˜¯äº‹åŠ¡ç”Ÿæ•ˆçš„æƒ…å†µï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>@Service
public class UserController {
    @Autowired
    private UserDao userDao;

    public void update(Integer id) {
        MyUser user = new MyUser();
        user.setUid(id);
        user.setUname(&quot;å¼ ä¸‰-testing&quot;);
        user.setUsex(&quot;å¥³&quot;);
        userDao.updateUser(user);
    }

    public MyUser query(Integer id) {
        MyUser user = userDao.selectUserById(id);
        return user;
    }

    // æ­£å¸¸æƒ…å†µ
    @Transactional(rollbackFor = Exception.class)

    public void testSuccess() throws Exception {
        Integer id = 1;
        MyUser user = query(id);
        System.out.println(&quot;åŸè®°å½•:&quot; + user);
        update(id);
        throw new Exception(&quot;äº‹åŠ¡ç”Ÿæ•ˆ&quot;);
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="äº‹åŠ¡ä¸ç”Ÿæ•ˆçš„å‡ ç§-case" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡ä¸ç”Ÿæ•ˆçš„å‡ ç§-case" aria-hidden="true">#</a> äº‹åŠ¡ä¸ç”Ÿæ•ˆçš„å‡ ç§ Case</h2><p>ä¸»è¦è®²è§£ 4 ç§äº‹åŠ¡ä¸ç”Ÿæ•ˆçš„ Caseï¼š</p><ul><li><strong>ç±»å†…éƒ¨è®¿é—®</strong>ï¼šA ç±»çš„ a1 æ–¹æ³•æ²¡æœ‰æ ‡æ³¨ @Transactionalï¼Œa2 æ–¹æ³•æ ‡æ³¨ @Transactionalï¼Œåœ¨ a1 é‡Œé¢è°ƒç”¨ a2ï¼›</li><li><strong>ç§æœ‰æ–¹æ³•</strong>ï¼šå°† @Transactional æ³¨è§£æ ‡æ³¨åœ¨é public æ–¹æ³•ä¸Šï¼›</li><li><strong>å¼‚å¸¸ä¸åŒ¹é…</strong>ï¼š@Transactional æœªè®¾ç½® rollbackFor å±æ€§ï¼Œæ–¹æ³•è¿”å› Exception ç­‰å¼‚å¸¸ï¼›</li><li><strong>å¤šçº¿ç¨‹</strong>ï¼šä¸»çº¿ç¨‹å’Œå­çº¿ç¨‹çš„è°ƒç”¨ï¼Œçº¿ç¨‹æŠ›å‡ºå¼‚å¸¸ã€‚</li></ul><h3 id="case-1-ç±»å†…éƒ¨è®¿é—®" tabindex="-1"><a class="header-anchor" href="#case-1-ç±»å†…éƒ¨è®¿é—®" aria-hidden="true">#</a> Case 1: ç±»å†…éƒ¨è®¿é—®</h3><p>æˆ‘ä»¬åœ¨ç±» UserController ä¸­æ–°å¢ä¸€ä¸ªæ–¹æ³• testInteralCall()ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>public void testInteralCall() throws Exception {
    testSuccess();
    throw new Exception(&quot;äº‹åŠ¡ä¸ç”Ÿæ•ˆï¼šç±»å†…éƒ¨è®¿é—®&quot;);
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œ testInteralCall() æ²¡æœ‰æ ‡æ³¨ @Transactionalï¼Œæˆ‘ä»¬å†çœ‹ä¸€ä¸‹æµ‹è¯•ç”¨ä¾‹ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>public static void main(String[] args) throws Exception {
    ApplicationContext applicationContext = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);
    UserController uc = (UserController) applicationContext.getBean(&quot;userController&quot;);
    try {
        uc.testSuccess();
    } finally {
        MyUser user =  uc.query(1);
        System.out.println(&quot;ä¿®æ”¹åçš„è®°å½•:&quot; + user);
    }
}
// è¾“å‡ºï¼š
// åŸè®°å½•:MyUser(uid=1, uname=å¼ ä¸‰, usex=å¥³)
// ä¿®æ”¹åçš„è®°å½•:MyUser(uid=1, uname=å¼ ä¸‰-testing, usex=å¥³)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»ä¸Šé¢çš„è¾“å‡ºå¯ä»¥çœ‹åˆ°ï¼Œäº‹åŠ¡å¹¶æ²¡æœ‰å›æ»šï¼Œè¿™ä¸ªæ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿ</p><p>å› ä¸º @Transactional çš„å·¥ä½œæœºåˆ¶æ˜¯åŸºäº AOP å®ç°ï¼ŒAOP æ˜¯ä½¿ç”¨åŠ¨æ€ä»£ç†å®ç°çš„ï¼Œå¦‚æœé€šè¿‡ä»£ç†ç›´æ¥è°ƒç”¨ testSuccess()ï¼Œé€šè¿‡ AOP ä¼šå‰åè¿›è¡Œå¢å¼ºï¼Œå¢å¼ºçš„é€»è¾‘å…¶å®å°±æ˜¯åœ¨ testSuccess() çš„å‰ååˆ†åˆ«åŠ ä¸Šå¼€å¯ã€æäº¤äº‹åŠ¡çš„é€»è¾‘ï¼Œåé¢çš„æºç ä¼šè¿›è¡Œå‰–æã€‚</p><p>ç°åœ¨æ˜¯é€šè¿‡ testInteralCall() å»è°ƒç”¨ testSuccess()ï¼ŒtestSuccess() å‰åä¸ä¼šè¿›è¡Œä»»ä½•å¢å¼ºæ“ä½œï¼Œä¹Ÿå°±æ˜¯<strong>ç±»å†…éƒ¨è°ƒç”¨ï¼Œä¸ä¼šé€šè¿‡ä»£ç†æ–¹å¼è®¿é—®ã€‚</strong></p>`,20),u={href:"https://blog.csdn.net/Ahuuua/article/details/123877835",target:"_blank",rel:"noopener noreferrer"},b=t(`<h3 id="case-2-ç§æœ‰æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#case-2-ç§æœ‰æ–¹æ³•" aria-hidden="true">#</a> Case 2: ç§æœ‰æ–¹æ³•</h3><p>åœ¨ç§æœ‰æ–¹æ³•ä¸Šï¼Œæ·»åŠ  @Transactional æ³¨è§£ä¹Ÿä¸ä¼šç”Ÿæ•ˆï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>@Transactional(rollbackFor = Exception.class)

private void testPirvateMethod() throws Exception {
    Integer id = 1;
    MyUser user = query(id);
    System.out.println(&quot;åŸè®°å½•:&quot; + user);
    update(id);
    throw new Exception(&quot;æµ‹è¯•äº‹åŠ¡ç”Ÿæ•ˆ&quot;);
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç›´æ¥ä½¿ç”¨æ—¶ï¼Œä¸‹é¢è¿™ç§åœºæ™¯ä¸å¤ªå®¹æ˜“å‡ºç°ï¼Œå› ä¸º IDEA ä¼šæœ‰æé†’ï¼Œæ–‡æ¡ˆä¸º: Methods annotated with &#39;@Transactional&#39; must be overridableï¼Œ<strong>è‡³äºæ·±å±‚æ¬¡çš„åŸç†ï¼Œæºç éƒ¨åˆ†ä¼šç»™ä½ è§£è¯»ã€‚</strong></p><h3 id="case-3-å¼‚å¸¸ä¸åŒ¹é…" tabindex="-1"><a class="header-anchor" href="#case-3-å¼‚å¸¸ä¸åŒ¹é…" aria-hidden="true">#</a> Case 3: å¼‚å¸¸ä¸åŒ¹é…</h3><p>è¿™é‡Œçš„ @Transactional æ²¡æœ‰è®¾ç½® rollbackFor = Exception.class å±æ€§ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>@Transactional
public void testExceptionNotMatch() throws Exception {
    Integer id = 1;
    MyUser user = query(id);
    System.out.println(&quot;åŸè®°å½•:&quot; + user);
    update(id);
    throw new Exception(&quot;äº‹åŠ¡ä¸ç”Ÿæ•ˆï¼šå¼‚å¸¸ä¸åŒ¹é…&quot;);
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>æµ‹è¯•æ–¹æ³•ï¼šåŒ Case1

// è¾“å‡ºï¼š
// åŸè®°å½•:User[uid=1,uname=å¼ ä¸‰,usex=å¥³]
// ä¿®æ”¹åçš„è®°å½•:User[uid=1,uname=å¼ ä¸‰-test,usex=å¥³]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>@Transactional æ³¨è§£é»˜è®¤å¤„ç†è¿è¡Œæ—¶å¼‚å¸¸ï¼Œå³åªæœ‰æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸æ—¶ï¼Œæ‰ä¼šè§¦å‘äº‹åŠ¡å›æ»šï¼Œå¦åˆ™å¹¶ä¸ä¼šå›æ»šï¼Œ<strong>è‡³äºæ·±å±‚æ¬¡çš„åŸç†ï¼Œæºç éƒ¨åˆ†ä¼šç»™ä½ è§£è¯»ã€‚</strong></p><h3 id="case-4-å¤šçº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#case-4-å¤šçº¿ç¨‹" aria-hidden="true">#</a> Case 4: å¤šçº¿ç¨‹</h3><p>ä¸‹é¢ç»™å‡ºä¸¤ä¸ªä¸åŒçš„å§¿åŠ¿ï¼Œä¸€ä¸ªæ˜¯å­çº¿ç¨‹æŠ›å¼‚å¸¸ï¼Œä¸»çº¿ç¨‹ okï¼›ä¸€ä¸ªæ˜¯å­çº¿ç¨‹ okï¼Œä¸»çº¿ç¨‹æŠ›å¼‚å¸¸ã€‚</p><h4 id="çˆ¶çº¿ç¨‹æŠ›å‡ºå¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#çˆ¶çº¿ç¨‹æŠ›å‡ºå¼‚å¸¸" aria-hidden="true">#</a> çˆ¶çº¿ç¨‹æŠ›å‡ºå¼‚å¸¸</h4><p>çˆ¶çº¿ç¨‹æŠ›å‡ºå¼‚å¸¸ï¼Œå­çº¿ç¨‹ä¸æŠ›å‡ºå¼‚å¸¸ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>public void testSuccess() throws Exception {
    Integer id = 1;
    MyUser user = query(id);
    System.out.println(&quot;åŸè®°å½•:&quot; + user);
    update(id);
}
@Transactional(rollbackFor = Exception.class)

public void testMultThread() throws Exception {
    new Thread(new Runnable() {
        @SneakyThrows
        @Override
        public void run() {
            testSuccess();
        }
    }).start();
    throw new Exception(&quot;æµ‹è¯•äº‹åŠ¡ä¸ç”Ÿæ•ˆ&quot;);
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>çˆ¶çº¿ç¨‹æŠ›å‡ºçº¿ç¨‹ï¼Œäº‹åŠ¡å›æ»šï¼Œå› ä¸ºå­çº¿ç¨‹æ˜¯ç‹¬ç«‹å­˜åœ¨ï¼Œå’Œçˆ¶çº¿ç¨‹ä¸åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œæ‰€ä»¥å­çº¿ç¨‹çš„ä¿®æ”¹å¹¶ä¸ä¼šè¢«å›æ»šï¼Œ</p><h4 id="å­çº¿ç¨‹æŠ›å‡ºå¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#å­çº¿ç¨‹æŠ›å‡ºå¼‚å¸¸" aria-hidden="true">#</a> å­çº¿ç¨‹æŠ›å‡ºå¼‚å¸¸</h4><p>çˆ¶çº¿ç¨‹ä¸æŠ›å‡ºå¼‚å¸¸ï¼Œå­çº¿ç¨‹æŠ›å‡ºå¼‚å¸¸ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>public void testSuccess() throws Exception {
    Integer id = 1;
    MyUser user = query(id);
    System.out.println(&quot;åŸè®°å½•:&quot; + user);
    update(id);
    throw new Exception(&quot;æµ‹è¯•äº‹åŠ¡ä¸ç”Ÿæ•ˆ&quot;);
}
@Transactional(rollbackFor = Exception.class)

public void testMultThread() throws Exception {
    new Thread(new Runnable() {
        @SneakyThrows
        @Override
        public void run() {
            testSuccess();
        }
    }).start();
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”±äºå­çº¿ç¨‹çš„å¼‚å¸¸ä¸ä¼šè¢«å¤–éƒ¨çš„çº¿ç¨‹æ•è·ï¼Œæ‰€ä»¥çˆ¶çº¿ç¨‹ä¸æŠ›å¼‚å¸¸ï¼Œäº‹åŠ¡å›æ»šæ²¡æœ‰ç”Ÿæ•ˆã€‚</p><h2 id="æºç è§£è¯»" tabindex="-1"><a class="header-anchor" href="#æºç è§£è¯»" aria-hidden="true">#</a> æºç è§£è¯»</h2><p><strong>ä¸‹é¢æˆ‘ä»¬ä»æºç çš„è§’åº¦ï¼Œå¯¹ @Transactional çš„æ‰§è¡Œæœºåˆ¶å’Œäº‹åŠ¡ä¸ç”Ÿæ•ˆçš„åŸå› è¿›è¡Œè§£è¯»ã€‚</strong></p><h3 id="transactional-æ‰§è¡Œæœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#transactional-æ‰§è¡Œæœºåˆ¶" aria-hidden="true">#</a> @Transactional æ‰§è¡Œæœºåˆ¶</h3><p>æˆ‘ä»¬åªçœ‹æœ€æ ¸å¿ƒçš„é€»è¾‘ï¼Œä»£ç ä¸­çš„ interceptorOrInterceptionAdvice å°±æ˜¯ TransactionInterceptor çš„å®ä¾‹ï¼Œå…¥å‚æ˜¯ this å¯¹è±¡ã€‚</p><blockquote><p>çº¢è‰²æ–¹æ¡†æœ‰ä¸€æ®µæ³¨é‡Šï¼Œå¤§è‡´ç¿»è¯‘ä¸º â€œå®ƒæ˜¯ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è°ƒç”¨å³å¯ï¼šåœ¨æ„é€ æ­¤å¯¹è±¡ä¹‹å‰ï¼Œå°†é™æ€åœ°è®¡ç®—åˆ‡å…¥ç‚¹ã€‚â€</p></blockquote><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-3995e575-2cd3-4f62-80d9-c0fbba3c99b9.jpg" alt="" loading="lazy"></p><p>this æ˜¯ ReflectiveMethodInvocation å¯¹è±¡ï¼Œæˆå‘˜å¯¹è±¡åŒ…å« UserController ç±»ã€testSuccess() æ–¹æ³•ã€å…¥å‚å’Œä»£ç†å¯¹è±¡ç­‰ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-47edf894-16e1-423b-a59a-cbb1bf1f5fba.jpg" alt="" loading="lazy"></p><p>è¿›å…¥ invoke() æ–¹æ³•åï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-a4464977-3c8f-4800-8ffd-c4e458828b0e.jpg" alt="" loading="lazy"></p><p><strong>å‰æ–¹é«˜èƒ½ï¼ï¼ï¼è¿™é‡Œå°±æ˜¯äº‹åŠ¡çš„æ ¸å¿ƒé€»è¾‘ï¼ŒåŒ…æ‹¬åˆ¤æ–­äº‹åŠ¡æ˜¯å¦å¼€å¯ã€ç›®æ ‡æ–¹æ³•æ‰§è¡Œã€äº‹åŠ¡å›æ»šã€äº‹åŠ¡æäº¤ã€‚</strong></p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-4b46998f-2c1a-4e7c-abc7-e34113ea33f3.jpg" alt="" loading="lazy"></p><h3 id="private-å¯¼è‡´äº‹åŠ¡ä¸ç”Ÿæ•ˆåŸå› " tabindex="-1"><a class="header-anchor" href="#private-å¯¼è‡´äº‹åŠ¡ä¸ç”Ÿæ•ˆåŸå› " aria-hidden="true">#</a> private å¯¼è‡´äº‹åŠ¡ä¸ç”Ÿæ•ˆåŸå› </h3><p>åœ¨ä¸Šé¢è¿™å¹…å›¾ä¸­ï¼Œç¬¬ä¸€ä¸ªçº¢æ¡†åŒºåŸŸè°ƒç”¨äº†æ–¹æ³• getTransactionAttribute()ï¼Œä¸»è¦æ˜¯ä¸ºäº†è·å– txAttr å˜é‡ï¼Œå®ƒæ˜¯ç”¨äºè¯»å– @Transactional çš„é…ç½®ï¼Œå¦‚æœè¿™ä¸ª txAttr = nullï¼Œåé¢å°±ä¸ä¼šèµ°äº‹åŠ¡é€»è¾‘ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªå˜é‡çš„å«ä¹‰ï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-d87a548a-cdf7-4027-8a8c-6e37a2cb908f.jpg" alt="" loading="lazy"></p><p>æˆ‘ä»¬ç›´æ¥è¿›å…¥ getTransactionAttribute()ï¼Œé‡ç‚¹å…³æ³¨è·å–äº‹åŠ¡é…ç½®çš„æ–¹æ³•ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-d5397df4-4a66-4187-92fe-6b7f991aff1a.jpg" alt="" loading="lazy"></p><p><strong>å‰æ–¹é«˜èƒ½ï¼ï¼ï¼è¿™é‡Œå°±æ˜¯ private å¯¼è‡´äº‹åŠ¡ä¸ç”Ÿæ•ˆçš„åŸå› æ‰€åœ¨</strong>ï¼ŒallowPublicMethodsOnly() ä¸€ç›´è¿”å› falseï¼Œæ‰€ä»¥é‡ç‚¹åªå…³æ³¨ isPublic() æ–¹æ³•ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-be1475dd-5e66-4685-9009-34c2bc1eed00.jpg" alt="" loading="lazy"></p><p>ä¸‹é¢é€šè¿‡ä½ä¸è®¡ç®—ï¼Œåˆ¤æ–­æ˜¯å¦ä¸º Publicï¼Œå¯¹åº”çš„å‡ ç±»ä¿®é¥°ç¬¦å¦‚ä¸‹ï¼š</p><ul><li>PUBLIC: 1</li><li>PRIVATE: 2</li><li>PROTECTED: 4</li></ul><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-5b4f2786-0507-4c14-af2b-79a492317bb0.jpg" alt="" loading="lazy"></p><p>çœ‹åˆ°è¿™é‡Œï¼Œæ˜¯ä¸æ˜¯è±ç„¶å¼€æœ—äº†ï¼Œæœ‰æ²¡æœ‰è§‰å¾—å¾ˆæœ‰æ„æ€å‘¢~~</p><h3 id="å¼‚å¸¸ä¸åŒ¹é…åŸå› " tabindex="-1"><a class="header-anchor" href="#å¼‚å¸¸ä¸åŒ¹é…åŸå› " aria-hidden="true">#</a> å¼‚å¸¸ä¸åŒ¹é…åŸå› </h3><p>æˆ‘ä»¬ç»§ç»­å›åˆ°äº‹åŠ¡çš„æ ¸å¿ƒé€»è¾‘ï¼Œå› ä¸ºä¸»æ–¹æ³•æŠ›å‡º Exception() å¼‚å¸¸ï¼Œè¿›å…¥äº‹åŠ¡å›æ»šçš„é€»è¾‘ï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-244514a1-f700-4781-aebe-cc6617c682e2.jpg" alt="" loading="lazy"></p><p>è¿›å…¥ rollbackOn() æ–¹æ³•ï¼Œåˆ¤æ–­è¯¥å¼‚å¸¸æ˜¯å¦èƒ½è¿›è¡Œå›æ»šï¼Œè¿™ä¸ªéœ€è¦åˆ¤æ–­ä¸»æ–¹æ³•æŠ›å‡ºçš„ Exception() å¼‚å¸¸ï¼Œæ˜¯å¦åœ¨ @Transactional çš„é…ç½®ä¸­ï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-32c3759b-7673-4a0a-8e6d-d9e4b0d5cd7d.jpg" alt="" loading="lazy"></p><p>æˆ‘ä»¬è¿›å…¥ getDepth() çœ‹ä¸€ä¸‹å¼‚å¸¸è§„åˆ™åŒ¹é…é€»è¾‘ï¼Œå› ä¸ºæˆ‘ä»¬å¯¹ @Transactional é…ç½®äº† rollbackFor = Exception.classï¼Œæ‰€ä»¥èƒ½åŒ¹é…æˆåŠŸï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-d4e16c96-45b4-49b6-bd5e-8061469b7aab.jpg" alt="" loading="lazy"></p><p>ç¤ºä¾‹ä¸­çš„ winner ä¸ä¸º nullï¼Œæ‰€ä»¥ä¼šè·³è¿‡ä¸‹é¢çš„ç¯èŠ‚ã€‚ä½†æ˜¯å½“ winner = null æ—¶ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰è®¾ç½® rollbackFor å±æ€§æ—¶ï¼Œä¼šèµ°é»˜è®¤çš„å¼‚å¸¸æ•è·æ–¹å¼ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-f08272b5-7365-47c1-a0a1-72307200c08a.jpg" alt="" loading="lazy"></p><p><strong>å‰æ–¹é«˜èƒ½ï¼ï¼ï¼è¿™é‡Œå°±æ˜¯å¼‚å¸¸ä¸åŒ¹é…åŸå› çš„åŸå› æ‰€åœ¨</strong>ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹é»˜è®¤çš„å¼‚å¸¸æ•è·æ–¹å¼ï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-5cc091e2-bcd6-4d81-92ba-ee04509990b7.jpg" alt="" loading="lazy"></p><p>æ˜¯ä¸æ˜¯è±ç„¶å¼€æœ—ï¼Œ<strong>å½“æ²¡æœ‰è®¾ç½® rollbackFor å±æ€§æ—¶ï¼Œé»˜è®¤åªå¯¹ RuntimeException å’Œ Error çš„å¼‚å¸¸æ‰§è¡Œå›æ»šã€‚</strong></p><hr>`,55),v={href:"https://mp.weixin.qq.com/s/e5Q4aJCX9xccTzBBGepx4g",target:"_blank",rel:"noopener noreferrer"},p=e("p",null,[e("img",{src:"http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-3ad64454-3033-40f1-840a-8bd90880b065.png",alt:"",loading:"lazy"})],-1),m=e("p",null,[e("img",{src:"http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-853616ff-76bd-40f6-9261-5e45285d3d56.png",alt:"",loading:"lazy"})],-1),g=e("p",null,[e("img",{src:"http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-976002e6-741c-4948-a4a4-a32ec44a903a.png",alt:"",loading:"lazy"})],-1),h=e("strong",null,"670 å¤šå",-1),x={href:"https://mp.weixin.qq.com/s/e5Q4aJCX9xccTzBBGepx4g",target:"_blank",rel:"noopener noreferrer"},y={href:"https://mp.weixin.qq.com/s/e5Q4aJCX9xccTzBBGepx4g",target:"_blank",rel:"noopener noreferrer"},w=e("p",null,[e("img",{src:"http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-6938df3e-6bd3-423e-879a-2b4dafa86bee.png",alt:"",loading:"lazy"})],-1),q=e("p",null,[e("img",{src:"http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/nice-article/weixin-gongsxlygtsbtransactionalswzxyydlhcq-3e6e49be-d833-4c4d-9e23-5d54f4132a9a.png",alt:"",loading:"lazy"})],-1),f=e("hr",null,null,-1),_=e("p",null,"æ²¡æœ‰ä»€ä¹ˆä½¿æˆ‘åœç•™â€”â€”é™¤äº†ç›®çš„ï¼Œçºµç„¶å²¸æ—æœ‰ç«ç‘°ã€æœ‰ç»¿è«ã€æœ‰å®é™çš„æ¸¯æ¹¾ï¼Œæˆ‘æ˜¯ä¸ç³»ä¹‹èˆŸã€‚",-1),j=e("p",null,[e("strong",null,"æ¨èé˜…è¯»"),n("ï¼š")],-1),z={href:"https://mp.weixin.qq.com/s/ja_fEGFBBWM3TLhdT0aeMw",target:"_blank",rel:"noopener noreferrer"},T={href:"https://mp.weixin.qq.com/s/yH42DxmRBSjrr0SW9N3MFg",target:"_blank",rel:"noopener noreferrer"},E={href:"https://mp.weixin.qq.com/s/miOagyv4x3HrqVaU38uh4w",target:"_blank",rel:"noopener noreferrer"},k={href:"https://mp.weixin.qq.com/s/s7KwW0cw2ZPR60SPFc6K0Q",target:"_blank",rel:"noopener noreferrer"},U={href:"https://mp.weixin.qq.com/s/iETW0dCfxxTTiRt1-WmeNw",target:"_blank",rel:"noopener noreferrer"},C={href:"https://mp.weixin.qq.com/s/9Naa2r7Xkf9D4d9tqEdgVQ",target:"_blank",rel:"noopener noreferrer"},S={href:"https://mp.weixin.qq.com/s/2IUe50xBhuEWKDzARVd51A",target:"_blank",rel:"noopener noreferrer"},I={href:"https://mp.weixin.qq.com/s/3lqp4x1B5LI1hNjWAi6v1g",target:"_blank",rel:"noopener noreferrer"},M={href:"https://mp.weixin.qq.com/s/APhxZ7ddmU8d9SEOr4w-iQ",target:"_blank",rel:"noopener noreferrer"};function A(B,P){const i=d("ExternalLinkIcon");return r(),l("div",null,[o,e("blockquote",null,[e("p",null,[n("å¦‚æœè¿˜æ˜¯ä¸å¤ªæ¸…æ¥šï¼Œæ¨èå†çœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼Œé‡Œé¢æœ‰å®Œæ•´ç¤ºä¾‹ï¼Œéå¸¸å®Œç¾è¯ é‡Šâ€œç±»å†…éƒ¨è®¿é—®â€ä¸èƒ½å‰åå¢å¼ºçš„åŸå› ï¼š"),e("a",u,[n("https://blog.csdn.net/Ahuuua/article/details/123877835"),a(i)])])]),b,e("p",null,[n("ä¸€ä¸ªäººå¯ä»¥èµ°å¾—å¾ˆå¿«ï¼Œä½†ä¸€ç¾¤äººæ‰èƒ½èµ°å¾—æ›´è¿œã€‚æ¬¢è¿åŠ å…¥"),e("a",v,[n("äºŒå“¥çš„ç¼–ç¨‹æ˜Ÿçƒ"),a(i)]),n("ï¼Œé‡Œé¢çš„æ¯ä¸ªçƒå‹éƒ½éå¸¸çš„å‹å–„ï¼Œé™¤äº†é¼“åŠ±ä½ ï¼Œè¿˜ä¼šç»™ä½ æå‡ºåˆç†çš„å»ºè®®ã€‚æ˜Ÿçƒæä¾›çš„ä¸‰ä»½ä¸“å±ä¸“æ ã€ŠJava é¢è¯•æŒ‡å—ã€‹ã€ã€Šç¼–ç¨‹å–µ ğŸ±ï¼ˆSpring Boot+Vue å‰åç«¯åˆ†ç¦»ï¼‰å®æˆ˜é¡¹ç›®ç¬”è®°ã€‹ã€ã€ŠJava ç‰ˆ LeetCode åˆ·é¢˜ç¬”è®°ã€‹ï¼Œå¹²è´§æ»¡æ»¡ï¼Œä»·å€¼è¿åŸã€‚")]),p,m,g,e("p",null,[n("å·²ç»æœ‰ "),h,n(" å°ä¼™ä¼´åŠ å…¥"),e("a",x,[n("äºŒå“¥çš„ç¼–ç¨‹æ˜Ÿçƒ"),a(i)]),n("äº†ï¼Œå¦‚æœä½ ä¹Ÿéœ€è¦ä¸€ä¸ªè‰¯å¥½çš„å­¦ä¹ æ°›å›´ï¼Œ"),e("a",y,[n("æˆ³é“¾æ¥"),a(i)]),n("åŠ å…¥æˆ‘ä»¬çš„å¤§å®¶åº­å§ï¼è¿™æ˜¯ä¸€ä¸ª Java å­¦ä¹ æŒ‡å— + ç¼–ç¨‹å®æˆ˜ + LeetCode åˆ·é¢˜çš„ç§å¯†åœˆå­ï¼Œä½ å¯ä»¥å‘äºŒå“¥æé—®ã€å¸®ä½ åˆ¶å®šå­¦ä¹ è®¡åˆ’ã€è·Ÿç€äºŒå“¥ä¸€èµ·åšå®æˆ˜é¡¹ç›®ï¼Œå†²å†²å†²ã€‚")]),w,q,f,_,j,e("ul",null,[e("li",null,[e("a",z,[n("ä»Šå¹´è¿™æƒ…å†µï¼ŒçœŸæœ‰ç‚¹æƒ³è¯»ç ”äº†"),a(i)])]),e("li",null,[e("a",T,[n("ä¸“å‡æœ¬ä¸Šå²¸çš„ç§˜è¯€"),a(i)])]),e("li",null,[e("a",E,[n("æ„¤æ€’ï¼Œä¸€ä¸ªç ´åŸ¹è®­ç­è¦ä»· 28 ä¸‡"),a(i)])]),e("li",null,[e("a",k,[n("å…¬å¸ä¸å¡å­¦å†ï¼Œå´æ‹…å¿ƒè‡ªå·±å®åŠ›ä¸å¤Ÿ"),a(i)])]),e("li",null,[e("a",U,[n("ä»Šå¹´é¢è¯•æœ‰ç‚¹å°éš¾ï¼Œè¿˜æ˜¯è¦å†²"),a(i)])]),e("li",null,[e("a",C,[n("äººç”Ÿå½“ä¸­æŒ£åˆ°çš„ç¬¬ä¸€ä¸ª 1 ä¸‡å…ƒ"),a(i)])]),e("li",null,[e("a",S,[n("æ–°ä¸€ä»£å¼€æºå…è´¹çš„ç»ˆç«¯å·¥å…·ï¼Œå¤ªé…·äº†"),a(i)])]),e("li",null,[e("a",I,[n("Java åç«¯å››ä»¶å¥—å­¦ä¹ èµ„æ–™"),a(i)])])]),e("blockquote",null,[e("p",null,[n("å‚è€ƒé“¾æ¥ï¼š"),e("a",M,[n("https://mp.weixin.qq.com/s/APhxZ7ddmU8d9SEOr4w-iQ"),a(i)]),n("ï¼Œå‡ºå¤„ï¼šmacrozhengï¼Œæ•´ç†ï¼šæ²‰é»˜ç‹äºŒ")])])])}const O=s(c,[["render",A],["__file","gongsxlygtsbtransactionalswzxyydlhcq.html.vue"]]);export{O as default};
